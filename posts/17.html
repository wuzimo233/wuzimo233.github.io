<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>微信小程序商城项目 | zimo</title><meta name="keywords" content="项目,小程序"><meta name="author" content="Zimo"><meta name="copyright" content="Zimo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="准备工具篇 下载 HBuilder https:&#x2F;&#x2F;www.dcloud.io&#x2F;index.html 安装所有插件   下载微信开发者工具 https:&#x2F;&#x2F;developers.weixin.qq.com&#x2F;miniprogram&#x2F;dev&#x2F;devtools&#x2F;download.html 注册并登录微信公众平台：https:&#x2F;&#x2F;mp.weixin.qq.com&#x2F;   获取 AppID(小程序ID)">
<meta property="og:type" content="article">
<meta property="og:title" content="微信小程序商城项目">
<meta property="og:url" content="https://wuzimo233.github.io/posts/17.html">
<meta property="og:site_name" content="zimo">
<meta property="og:description" content="准备工具篇 下载 HBuilder https:&#x2F;&#x2F;www.dcloud.io&#x2F;index.html 安装所有插件   下载微信开发者工具 https:&#x2F;&#x2F;developers.weixin.qq.com&#x2F;miniprogram&#x2F;dev&#x2F;devtools&#x2F;download.html 注册并登录微信公众平台：https:&#x2F;&#x2F;mp.weixin.qq.com&#x2F;   获取 AppID(小程序ID)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://images8.alphacoders.com/120/1206602.png">
<meta property="article:published_time" content="2022-07-25T07:30:00.000Z">
<meta property="article:modified_time" content="2022-07-25T07:27:40.191Z">
<meta property="article:author" content="Zimo">
<meta property="article:tag" content="项目">
<meta property="article:tag" content="小程序">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images8.alphacoders.com/120/1206602.png"><link rel="shortcut icon" href="https://s1.ax1x.com/2022/04/13/LQEmP1.jpg"><link rel="canonical" href="https://wuzimo233.github.io/posts/17"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":30,"position":"top","messagePrev":"该文章创建于","messageNext":"天前，请以最新文章为准"},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Zimo","link":"链接: ","source":"来源: zimo","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '微信小程序商城项目',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-07-25 15:27:40'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><link defer rel="stylesheet" href="/css/customm.css" ><link defer rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/css/icon.css"><link defer rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"><link defer rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/css/background.css"><link defer rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/css/index_ee.css"><meta name="generator" content="Hexo 5.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="zimo" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s1.ax1x.com/2022/04/13/LQEmP1.jpg" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">21</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">16</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-archive"></i><span> 归档</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-book"></i><span> 说说</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/List/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/List/gallery/"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></li><li><a class="site-page child" href="/List/videos/"><i class="fa-fw fas fa-video"></i><span> 视频</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fa fa-suitcase"></i><span> 百宝箱</span></a></div><div class="menus_item"><a class="site-page" href="/Windows/"><i class="fa-fw fa fa-desktop"></i><span> Windows</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://images8.alphacoders.com/120/1206602.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">zimo</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-archive"></i><span> 归档</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-book"></i><span> 说说</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/List/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/List/gallery/"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></li><li><a class="site-page child" href="/List/videos/"><i class="fa-fw fas fa-video"></i><span> 视频</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fa fa-suitcase"></i><span> 百宝箱</span></a></div><div class="menus_item"><a class="site-page" href="/Windows/"><i class="fa-fw fa fa-desktop"></i><span> Windows</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">微信小程序商城项目</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-25T07:30:00.000Z" title="发表于 2022-07-25 15:30:00">2022-07-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-25T07:27:40.191Z" title="更新于 2022-07-25 15:27:40">2022-07-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">47.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>218分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="微信小程序商城项目"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><h3 id="工具篇"><a href="#工具篇" class="headerlink" title="工具篇"></a><strong>工具</strong>篇</h3><ul>
<li>下载 HBuilder <a target="_blank" rel="noopener" href="https://www.dcloud.io/index.html">https://www.dcloud.io/index.html</a><ul>
<li>安装所有插件</li>
</ul>
</li>
<li>下载微信开发者工具 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html">https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html</a></li>
<li>注册并登录微信公众平台：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/">https://mp.weixin.qq.com/</a>  <ul>
<li>获取 <strong>AppID(小程序ID)</strong></li>
</ul>
</li>
</ul>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><strong>生成小程序以及要跳过的坑</strong></p>
<ul>
<li>生成小程序时不能用ID选择器，用class</li>
<li>uniapp没有router路由 </li>
<li>小程序生命周期函数（比如onload）不能用在子组件里面，而是用在父组件里面</li>
<li>小程序没有 window对象，包括没有 document… 等节点操作 （例如：document.getElementById() 。。。）</li>
</ul>
<h2 id="搭建项目"><a href="#搭建项目" class="headerlink" title="搭建项目"></a>搭建项目</h2><h3 id="主界面配置"><a href="#主界面配置" class="headerlink" title="主界面配置"></a>主界面配置</h3><p>HBuilder新建默认模板项目，运行到小程序模拟器微信开发者工具，同时打开微信开发者工具的设置-安全设置-开启服务端口。</p>
<p><strong>配置主界面下方四个tab栏：</strong></p>
<ul>
<li><p>将准备好的素材文件夹 <strong>static</strong> 覆盖到项目根目录，</p>
</li>
<li><p>在<strong>pages</strong>下新建 <strong>sort</strong>（分类）、<strong>shopping</strong>（购物车）、<strong>my</strong>（我的）三个文件夹，并都在内部创建子vue文件，</p>
</li>
<li><p>接着在pages.json文件配置底部导航栏，代码如下：</p>
</li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">{</span>
	<span class="token string">"pages"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">//pages数组中第一项表示应用启动页，参考：https://uniapp.dcloud.io/collocation/pages</span>
		<span class="token punctuation">{</span>
			<span class="token comment">// 展示用户初次进入的页面</span>
			<span class="token string">"path"</span><span class="token operator">:</span> <span class="token string">"pages/index/index"</span><span class="token punctuation">,</span>
			<span class="token string">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"首页"</span><span class="token punctuation">,</span>
				<span class="token string">"navigationBarBackgroundColor"</span><span class="token operator">:</span><span class="token string">"#fe0024"</span><span class="token punctuation">,</span>
				<span class="token string">"navigationBarTextStyle"</span><span class="token operator">:</span><span class="token string">"white"</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			<span class="token string">"path"</span><span class="token operator">:</span> <span class="token string">"pages/search/search"</span><span class="token punctuation">,</span>
			<span class="token string">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"搜索"</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			<span class="token string">"path"</span><span class="token operator">:</span> <span class="token string">"pages/sort/sort"</span><span class="token punctuation">,</span>
			<span class="token string">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"分类"</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			<span class="token string">"path"</span><span class="token operator">:</span> <span class="token string">"pages/shopping/shopping"</span><span class="token punctuation">,</span>
			<span class="token string">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"购物车"</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			<span class="token string">"path"</span><span class="token operator">:</span> <span class="token string">"pages/my/my"</span><span class="token punctuation">,</span>
			<span class="token string">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"个人中心"</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token comment">// globalStyle 用于设置应用的状态栏、导航条、标题、窗口背景色等。</span>
	<span class="token string">"globalStyle"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token string">"navigationBarTextStyle"</span><span class="token operator">:</span> <span class="token string">"black"</span><span class="token punctuation">,</span>
		<span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"uni-app"</span><span class="token punctuation">,</span>
		<span class="token string">"navigationBarBackgroundColor"</span><span class="token operator">:</span> <span class="token string">"#F8F8F8"</span><span class="token punctuation">,</span>
		<span class="token string">"backgroundColor"</span><span class="token operator">:</span> <span class="token string">"#F8F8F8"</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 如果应用是一个多 tab 应用，可以通过 tabBar 配置项指定一级导航栏，</span>
	<span class="token comment">// 以及 tab 切换时显示的对应页</span>
	<span class="token string">"tabBar"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token string">"color"</span><span class="token operator">:</span> <span class="token string">"#333333"</span><span class="token punctuation">,</span>
		<span class="token string">"selectedColor"</span><span class="token operator">:</span> <span class="token string">"#8fc0ff"</span><span class="token punctuation">,</span>
		<span class="token string">"backgroundColor"</span><span class="token operator">:</span> <span class="token string">"#ffffff"</span><span class="token punctuation">,</span>
		<span class="token string">"borderStyle"</span><span class="token operator">:</span> <span class="token string">"black"</span><span class="token punctuation">,</span>
		<span class="token string">"list"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
			<span class="token string">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/index/index"</span><span class="token punctuation">,</span>
			<span class="token string">"text"</span><span class="token operator">:</span> <span class="token string">"首页"</span><span class="token punctuation">,</span>
			<span class="token string">"iconPath"</span><span class="token operator">:</span> <span class="token string">"./static/tab/tab-a.png"</span><span class="token punctuation">,</span>
			<span class="token string">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"./static/tab/tab-b.png"</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			<span class="token string">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/sort/sort"</span><span class="token punctuation">,</span>
			<span class="token string">"text"</span><span class="token operator">:</span> <span class="token string">"分类"</span><span class="token punctuation">,</span>
			<span class="token string">"iconPath"</span><span class="token operator">:</span> <span class="token string">"./static/tab/tab-c.png"</span><span class="token punctuation">,</span>
			<span class="token string">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"./static/tab/tab-d.png"</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			<span class="token string">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/shopping/shopping"</span><span class="token punctuation">,</span>
			<span class="token string">"text"</span><span class="token operator">:</span> <span class="token string">"购物车"</span><span class="token punctuation">,</span>
			<span class="token string">"iconPath"</span><span class="token operator">:</span> <span class="token string">"./static/tab/tab-e.png"</span><span class="token punctuation">,</span>
			<span class="token string">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"./static/tab/tab-f.png"</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			<span class="token string">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/my/my"</span><span class="token punctuation">,</span>
			<span class="token string">"text"</span><span class="token operator">:</span> <span class="token string">"我的"</span><span class="token punctuation">,</span>
			<span class="token string">"iconPath"</span><span class="token operator">:</span> <span class="token string">"./static/tab/tab-g.png"</span><span class="token punctuation">,</span>
			<span class="token string">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"./static/tab/tab-h.png"</span>
			
		<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="首页组件拆分"><a href="#首页组件拆分" class="headerlink" title="首页组件拆分"></a>首页组件拆分</h3><p>在pages/index下新建文件夹‘sonzjijian’ ，依次新建 search.vue、swipers.vue、purchase.vue、list.vue等文件，首页下方是动态的加载效果所以考虑引用公共组件 ，即在pages下新建comonents文件夹，内部新建card.vue</p>
<pre><code>// 引入组件 （首页从上至下排序）
搜索                      search.vue
轮播                      swipers.vue
抢购                        purchase.vue
天猫榜单                      list.vue
引入公用组件 --懒加载卡片       card.vue</code></pre>
<p>在<strong>pages/index/index.vue</strong>里引入所有子组件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 搜索 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Search<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Search<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 轮播图 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Swipers<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Swipers<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 抢购 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Purchase <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Purchase<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 榜单 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>List <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 卡片流 懒加载卡片<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Card <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Card<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
。。。

<span class="token comment">// 引入组件</span>
<span class="token comment">// 搜索</span>
<span class="token keyword">import</span> Search <span class="token keyword">from</span> <span class="token string">'./sonzhujian/search.vue'</span>
<span class="token comment">// 轮播</span>
<span class="token keyword">import</span> Swipers <span class="token keyword">from</span> <span class="token string">'./sonzhujian/swipers.vue'</span>
<span class="token comment">// 抢购</span>
<span class="token keyword">import</span> Purchase <span class="token keyword">from</span> <span class="token string">'./sonzhujian/purchase.vue'</span>
<span class="token comment">// 天猫榜单</span>
<span class="token keyword">import</span> List <span class="token keyword">from</span> <span class="token string">'./sonzhujian/list.vue'</span>
<span class="token comment">// 引入公用的组件 --懒加载卡片</span>
<span class="token keyword">import</span> Card <span class="token keyword">from</span> <span class="token string">'../commponents/card.vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	components<span class="token operator">:</span><span class="token punctuation">{</span>
		Search<span class="token punctuation">,</span>Swipers<span class="token punctuation">,</span>Purchase<span class="token punctuation">,</span>List<span class="token punctuation">,</span>Card
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="完成搜索组件展示"><a href="#完成搜索组件展示" class="headerlink" title="完成搜索组件展示"></a>完成搜索组件展示</h4><p>关于upx单位：</p>
<p>uni-app 使用 upx 作为默认尺寸单位， upx 是相对于基准宽度的单位，可以根据<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%B1%8F%E5%B9%95/3750314">屏幕</a>宽度进行自适应。uni-app 规定屏幕基准宽度750upx。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 首页搜索区域 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-men"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> uniapp 不需要。。<span class="token operator">/</span> 可以直接输入文件夹名字查找<span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/search/logo.png"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-ing"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/search/sousuo.png"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> placeholder<span class="token operator">=</span><span class="token string">"搜索喜欢的内容"</span> disabled <span class="token operator">/</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-saoma"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/search/saoma.png"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token comment">/* scoped  css样式仅在当前文件生效*/</span>
<span class="token punctuation">.</span>search<span class="token operator">-</span>view <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #fe001d<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>search<span class="token operator">-</span>view image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>search<span class="token operator">-</span>ing <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>direction<span class="token operator">:</span> row<span class="token punctuation">;</span>
	flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
	position<span class="token operator">:</span> relative<span class="token punctuation">;</span>
	margin<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>search<span class="token operator">-</span>ing input <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #b2b2b2<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">80</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>search<span class="token operator">-</span>ing image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">35</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">35</span>upx<span class="token punctuation">;</span>
	position<span class="token operator">:</span> absolute<span class="token punctuation">;</span>
	left<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	align<span class="token operator">-</span>self<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
	
<span class="token punctuation">.</span>search<span class="token operator">-</span>saoma <span class="token punctuation">{</span>
	margin<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>search<span class="token operator">-</span>men <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="自定义轮播展示与请求轮播数据"><a href="#自定义轮播展示与请求轮播数据" class="headerlink" title="自定义轮播展示与请求轮播数据"></a>自定义轮播展示与请求轮播数据</h4><p>使用 swiper 组件 请求轮播数据完成数据渲染</p>
<p>打开项目接口文档拿到 首页轮播的接口地址</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"swiper-top"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> @change  事件<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>swiper <span class="token operator">:</span>autoplay<span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">:</span>circular<span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">:</span>interval<span class="token operator">=</span><span class="token string">"2000"</span> <span class="token operator">:</span>duration<span class="token operator">=</span><span class="token string">"1000"</span> @change<span class="token operator">=</span><span class="token string">"swiperFun()"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 每个swiper<span class="token operator">-</span>item 都是独立的会滑动板块 是需要要遍历的整体 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in bannerdata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>swiper<span class="token operator">-</span>item<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"swiper-item"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> mode 图片裁剪、缩放的模式  <span class="token operator">--</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>img <span class="token operator">:</span>src<span class="token operator">=</span>item<span class="token punctuation">.</span>image mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>swiper<span class="token operator">-</span>item<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>swiper<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 指示点 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"instruct-view"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in bannerdata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 
					小方块颜色动态的跟随背景图变化而变化  num默认<span class="token number">0</span>，即让下标为<span class="token number">0</span>的第一个方块套上了该<span class="token keyword">class</span>属性，
					activee选择器生效的前提是value值为真 
					想让方块颜色跟随背景图变化需要找到滑动事件：
					current <span class="token operator">--</span>当前所在滑块的index
					@change <span class="token operator">--</span>current改变时会触发 change 事件，
				<span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"instruct"</span> <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{active:index == num}"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			<span class="token comment">// 指示方块的下标值等于num</span>
			num<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
            bannerdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">banner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            uni<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                url<span class="token operator">:</span><span class="token string">'https://meituan.thexxdd.cn/api/getbanner'</span><span class="token punctuation">,</span>
                methods<span class="token operator">:</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>bannerdata <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">fail</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
		<span class="token comment">// 使用swiper自带的@change事件 --滑块滑动时的触发事件   它接收一个参数  每次滑动后current值会增加 而ecurrent的值和index的值是相等的 </span>
		<span class="token function">swiperFun</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// console.log(e.detail.current);</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>current
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>swiper<span class="token operator">-</span>top <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">250</span>upx<span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">20</span>upx <span class="token number">10</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
	position<span class="token operator">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
swiper <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">250</span>upx <span class="token operator">!</span>important<span class="token punctuation">;</span>
	background<span class="token operator">:</span> yellow<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
	overflow<span class="token operator">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>swiper<span class="token operator">-</span>item <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">250</span>upx <span class="token operator">!</span>important<span class="token punctuation">;</span>
	overflow<span class="token operator">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>swiper<span class="token operator">-</span>item image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">250</span>upx <span class="token operator">!</span>important<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 指示点 */</span>
<span class="token punctuation">.</span>instruct<span class="token operator">-</span>view <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
	position<span class="token operator">:</span> absolute<span class="token punctuation">;</span>
	bottom<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
	left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>instruct <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #<span class="token number">4e90</span>a6<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">40</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>active <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #ffffff <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="class封装request请求"><a href="#class封装request请求" class="headerlink" title="class封装request请求"></a>class封装request请求</h4><p>原因：很多页面都需要发起请求，即需要使用uni.request（），那么就比较麻烦。</p>
<pre><code>uni.request({
      url:'',
      methods:'',
      success:(res)=&gt;{
            console.log(res)
      },
      fail:(err)=&gt;{
            console.log(err)
      }
})</code></pre>
<p>如果将其抽出封装成公用的方法或者类就很方便了。</p>
<p>项目根目录下新建api文件夹，其下再建立api.js、request.js</p>
<h5 id="封装请求接口"><a href="#封装请求接口" class="headerlink" title="封装请求接口"></a>封装请求接口</h5><p><strong>在request.js里放置所有的请求接口，</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//  该文件用于写请求地址</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">'https://meituan.thexxdd.cn/api/'</span>

<span class="token comment">// 使用面向对象class方法创造 urls类</span>
<span class="token keyword">const</span>  urls <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token punctuation">{</span>
	<span class="token comment">//constructor 构造方法 --可以从别的页面传值过来 接收值</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		
	<span class="token punctuation">}</span>
	<span class="token comment">// static：静态方法 --直接使用类来调用（即 urls.m() 就可以调用），不是静态方法的话需要实例化类 也就是new</span>
	<span class="token comment">// 存放所有的方法</span>
	<span class="token keyword">static</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 首页轮播图 --使用es6的模板字符串方法拼接</span>
		<span class="token keyword">let</span> bannerget <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">getbanner</span><span class="token template-punctuation string">`</span></span>	
		<span class="token comment">// 导出对象</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			bannerget<span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>	
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> urls<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="封装请求方式"><a href="#封装请求方式" class="headerlink" title="封装请求方式"></a>封装请求方式</h5><p><strong>在api.js中作request请求</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// request 该文件用于 写请求方法</span>

<span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token punctuation">{</span>
	
	<span class="token comment">// 参数url是request.js暴露出的url </span>
	<span class="token comment">// 参数data是post请求传递的值</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span>arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>arg <span class="token operator">=</span> arg<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 封装 post请求</span>
	<span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			uni<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				url<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">,</span>
				method<span class="token operator">:</span><span class="token string">'POST'</span><span class="token punctuation">,</span>
				data<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>arg<span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				<span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'出错了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 封装 get请求</span>
	<span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			uni<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				url<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">,</span>
				method<span class="token operator">:</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				<span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'出错了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> request<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>在swiper组件此时可以这样使用</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> urls <span class="token keyword">from</span> <span class="token string">'../../../api/request.js'</span>
<span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">'../../../api/api.js'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			<span class="token comment">// 指示方块的下标值等于num</span>
			num<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
            bannerdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span> <span class="token punctuation">{</span>
		 <span class="token function">banner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             <span class="token comment">//返回新的promise实例对象</span>
             <span class="token keyword">new</span> <span class="token class-name">request</span><span class="token punctuation">(</span>urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bannerget<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                 <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                 	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
                 	<span class="token keyword">this</span><span class="token punctuation">.</span>bannerdata <span class="token operator">=</span> res<span class="token punctuation">.</span>data
             	<span class="token punctuation">}</span><span class="token punctuation">)</span>
             	<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                 	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
             	<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">swiperFun</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>current
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token comment">//加载完后直接调用banner方法   </span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">banner</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>还能使用try catch 方法</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">methods<span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token keyword">async</span> <span class="token function">banner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//返回新的promise实例对象用await接收到结果(记得方法前加上axync) 当返回错误的时候会进入 catch里</span>
            <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">request</span><span class="token punctuation">(</span>urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bannerget<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>bannerdata <span class="token operator">=</span> data<span class="token punctuation">.</span>data
        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>因为每个页面几乎都有请求发送，每次引入api和request就很麻烦，所以<strong>挂载到全局</strong> <strong>main.js</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//main.js中引入api和request</span>
<span class="token comment">// 引入请求地址</span>
<span class="token keyword">import</span> urls <span class="token keyword">from</span> <span class="token string">'./api/request.js'</span> 
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>Urls <span class="token operator">=</span> urls

<span class="token comment">// 引入请求方法</span>
<span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">'./api/api.js'</span> 
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>Request <span class="token operator">=</span> request

<span class="token comment">//此时的swiper组件中就这样发送请求了</span>
methods<span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token keyword">async</span> <span class="token function">banner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//返回新的promise实例对象用await接收到结果(记得方法前加上axync) 当返回错误的时候会进入 catch里</span>
            <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bannerget<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>bannerdata <span class="token operator">=</span> data<span class="token punctuation">.</span>data
        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="统一请求接口到父组件"><a href="#统一请求接口到父组件" class="headerlink" title="统一请求接口到父组件"></a>统一请求接口到父组件</h5><p>每个页面都再调用请求也很麻烦，所以<strong>将所有请求放到父组件统一发送</strong>，父组件将接口响应的数据传递给子组件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 搜索 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Search<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Search<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 轮播图 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Swipers <span class="token operator">:</span>bannerdata<span class="token operator">=</span><span class="token string">"bannerdata"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Swipers<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 抢购 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Purchase<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Purchase<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 榜单 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>List<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 卡片流 懒加载卡片<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Card<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Card<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token comment">// 引入组件</span>
	<span class="token comment">// 搜索</span>
	<span class="token keyword">import</span> Search <span class="token keyword">from</span> <span class="token string">'./sonzhujian/search.vue'</span>
	<span class="token comment">// 轮播</span>
	<span class="token keyword">import</span> Swipers <span class="token keyword">from</span> <span class="token string">'./sonzhujian/swipers.vue'</span>
	<span class="token comment">// 抢购</span>
	<span class="token keyword">import</span> Purchase <span class="token keyword">from</span> <span class="token string">'./sonzhujian/purchase.vue'</span>
	<span class="token comment">// 天猫榜单</span>
	<span class="token keyword">import</span> List <span class="token keyword">from</span> <span class="token string">'./sonzhujian/list.vue'</span>
	<span class="token comment">// 引入公用的组件 --懒加载卡片</span>
	<span class="token keyword">import</span> Card <span class="token keyword">from</span> <span class="token string">'../commponents/card.vue'</span>
	
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		components<span class="token operator">:</span><span class="token punctuation">{</span>
			Search<span class="token punctuation">,</span>Swipers<span class="token punctuation">,</span>Purchase<span class="token punctuation">,</span>List<span class="token punctuation">,</span>Card
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				bannerdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
				recomdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
				billdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
				commdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
				pageid<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token comment">// 把请求统一放到父组件</span>
			<span class="token keyword">async</span> <span class="token function">indexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 轮播</span>
				<span class="token keyword">let</span> banner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bannerget<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token keyword">try</span> <span class="token punctuation">{</span>
					<span class="token comment">// 同时并发请求：Promise.all([]) 里边的所有请求全部得到结果后才会返回</span>
					<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>banner<span class="token punctuation">]</span><span class="token punctuation">)</span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 轮播</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>bannerdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// 上拉加载所得数据</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">indexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
<span class="token comment">/* 全局背景色 */</span>
page <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #f4f4f4<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>子组件 <strong>swiper.vue</strong> 通过<strong>props</strong>接收父组件传递来的数据</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token comment">// bannerdata是父组件 通过ref传递进来的数据 类型是Array</span>
	props<span class="token operator">:</span><span class="token punctuation">{</span>
		bannerdata<span class="token operator">:</span>Array<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="完成推荐抢购商品组件数据"><a href="#完成推荐抢购商品组件数据" class="headerlink" title="完成推荐抢购商品组件数据"></a>完成推荐抢购商品组件数据</h4><p>在request.js中添加抢购商品接口 </p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//  该文件用于写请求地址</span>
<span class="token comment">// static：静态方法 --直接使用类来调用（即 urls.m() 就可以调用），不是静态方法的话需要实例化类 也就是new</span>
<span class="token comment">// 存放所有的方法</span>
	<span class="token keyword">static</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 首页轮播图 --使用es6的模板字符串方法拼接</span>
		<span class="token keyword">let</span> bannerget <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">getbanner</span><span class="token template-punctuation string">`</span></span>
		<span class="token comment">// 推荐抢购商品 </span>
		<span class="token keyword">let</span> getrecommurl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">recom</span><span class="token template-punctuation string">`</span></span>
		<span class="token comment">// 导出对象</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			bannerget<span class="token punctuation">,</span>
			getrecommurl<span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>在index/index.vue中使用</strong>，并将<strong>recomdata</strong>数据通过ref传递到子组件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 把请求统一放到父组件</span>
			<span class="token keyword">async</span> <span class="token function">indexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 轮播</span>
				<span class="token keyword">let</span> banner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bannerget<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token comment">// 推荐抢购商品 </span>
				<span class="token keyword">let</span> recomm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getrecommurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token keyword">try</span> <span class="token punctuation">{</span>
					<span class="token comment">// 同时并发请求：Promise.all([])</span>
					<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>banner<span class="token punctuation">,</span>recomm<span class="token punctuation">]</span><span class="token punctuation">)</span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 轮播</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>bannerdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
					<span class="token comment">// 快抢购</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>recomdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data		
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">indexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>子组件purchase.vue代码如下：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 抢购组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Purchase-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pur-flex"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 左边 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pur-left widthing"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pur-top"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>recomdata<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>recomdata<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lable<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span> 
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pur-img"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in recomdata[0].image"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">&lt;</span>img <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.img"</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 右边 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pur-right widthing"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 上 <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pur-right-top"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pur-top two"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>recomdata<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>recomdata<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lable<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pur-right-img"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in recomdata[1].image"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">&lt;</span>img <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.img"</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 下 <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pur-top three"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>recomdata<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>recomdata<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lable<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pur-right-img"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in recomdata[2].image"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">&lt;</span>img <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.img"</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	props<span class="token operator">:</span> <span class="token punctuation">{</span> 
		recomdata<span class="token operator">:</span> Array<span class="token punctuation">,</span>
	 <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>Purchase<span class="token operator">-</span>view <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>top <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">9</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>top text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>top text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">24</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> red<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 图片 */</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>img <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>img view <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">150</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>img image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">120</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">120</span>upx <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>img view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter">n <span class="token operator">+</span> <span class="token number">3</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	padding<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>right<span class="token operator">-</span>img <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>right<span class="token operator">-</span>img image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">120</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">120</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>right<span class="token operator">-</span>img view <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">150</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>right <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>right view <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>flex <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>widthing <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
	box<span class="token operator">-</span>sizing<span class="token operator">:</span> border<span class="token operator">-</span>box<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>left <span class="token punctuation">{</span>
	border<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">1</span>rpx solid #f1f1f1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>pur<span class="token operator">-</span>right<span class="token operator">-</span>top <span class="token punctuation">{</span>
	border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">1</span>rpx solid #f1f1f1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>two text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	color<span class="token operator">:</span> #ff7594 <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>three text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	color<span class="token operator">:</span> #<span class="token number">96</span>b06f <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="完成天猫榜单组件数据"><a href="#完成天猫榜单组件数据" class="headerlink" title="完成天猫榜单组件数据"></a>完成天猫榜单组件数据</h4><p>在request.js中添加抢购商品接口 </p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 存放所有的方法</span>
	<span class="token keyword">static</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 首页轮播图 --使用es6的模板字符串方法拼接</span>
		<span class="token keyword">let</span> bannerget <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">getbanner</span><span class="token template-punctuation string">`</span></span>
		<span class="token comment">// 推荐抢购商品 </span>
		<span class="token keyword">let</span> getrecommurl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">recom</span><span class="token template-punctuation string">`</span></span>
        <span class="token comment">// 天猫榜单</span>
		<span class="token keyword">let</span> billboardurl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">billboard</span><span class="token template-punctuation string">`</span></span>
		<span class="token comment">// 导出对象</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			bannerget<span class="token punctuation">,</span>
			getrecommurl<span class="token punctuation">,</span>
            billboardurl<span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>在index/index.vue中使用</strong>，并将<strong>billdata</strong>数据通过ref传递到子组件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 把请求统一放到父组件</span>
			<span class="token keyword">async</span> <span class="token function">indexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 轮播</span>
				<span class="token keyword">let</span> banner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bannerget<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token comment">// 推荐抢购商品 </span>
				<span class="token keyword">let</span> recomm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getrecommurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// 天猫榜单</span>
				<span class="token keyword">let</span> billboard <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>billboardurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token keyword">try</span> <span class="token punctuation">{</span>
					<span class="token comment">// 同时并发请求：Promise.all([])</span>
					<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>banner<span class="token punctuation">,</span>recomm<span class="token punctuation">,</span>billboard<span class="token punctuation">]</span><span class="token punctuation">)</span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 轮播</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>bannerdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
					<span class="token comment">// 快抢购</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>recomdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
                    <span class="token comment">// 天猫榜单</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>billdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">indexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>子组件list.vue代码如下:</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"list-top"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"list-text"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>天猫榜单<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>闭着眼睛跟榜买<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"list-view"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item, index) in billdata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"menb"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>title <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>want <span class="token punctuation">}</span><span class="token punctuation">}</span>人想要<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	props<span class="token operator">:</span> <span class="token punctuation">{</span> billdata<span class="token operator">:</span> Array <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token comment">/* /less */</span>
<span class="token punctuation">.</span>list<span class="token operator">-</span>top <span class="token punctuation">{</span>
	margin<span class="token operator">:</span> <span class="token number">20</span>upx <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>list<span class="token operator">-</span>text <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">70</span>rpx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>list<span class="token operator">-</span>text text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #<span class="token number">2</span>c405a<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">35</span>upx<span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>list<span class="token operator">-</span>text text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">5</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>list<span class="token operator">-</span>text text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">3</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">24</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">999999</span><span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>list<span class="token operator">-</span>view <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">400</span>rpx<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">9</span>rpx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>menb text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>menb text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">3</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">20</span>rpx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #fe0024<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>menb image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">80</span>rpx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">100</span>rpx <span class="token operator">!</span>important<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">4</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>menb <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">33.333</span><span class="token operator">%</span><span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">2</span>rpx<span class="token punctuation">;</span>
	box<span class="token operator">-</span>sizing<span class="token operator">:</span> border<span class="token operator">-</span>box<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>list<span class="token operator">-</span>view view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">-</span>n <span class="token operator">+</span> <span class="token number">3</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">1</span>rpx solid #f1f1f1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>list<span class="token operator">-</span>view view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	border<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">1</span>rpx solid #f1f1f1<span class="token punctuation">;</span>
	border<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">1</span>rpx solid #f1f1f1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>list<span class="token operator">-</span>view view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">5</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	border<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">1</span>rpx solid #f1f1f1<span class="token punctuation">;</span>
	border<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">1</span>rpx solid #f1f1f1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="封装并请求卡片流商品组件"><a href="#封装并请求卡片流商品组件" class="headerlink" title="封装并请求卡片流商品组件"></a>封装并请求卡片流商品组件</h4><p>因为该组件的（流动布局）功能在其他页面也会用到，所以封装到公共组件文件夹去，即在<strong>pages下新建comonents文件夹</strong>，再新建<strong>card.vue</strong>文件</p>
<p>在<strong>request.js</strong>中添加<strong>卡片商品流以及上拉加载接口</strong> </p>
<p>由于接口文档显示get请求需要携带?query参数，</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 存放所有的方法</span>
<span class="token keyword">static</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 首页轮播图 --使用es6的模板字符串方法拼接</span>
		<span class="token keyword">let</span> bannerget <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">getbanner</span><span class="token template-punctuation string">`</span></span>
		<span class="token comment">// 推荐抢购商品 </span>
		<span class="token keyword">let</span> getrecommurl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">recom</span><span class="token template-punctuation string">`</span></span>
		<span class="token comment">// 天猫榜单</span>
		<span class="token keyword">let</span> billboardurl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">billboard</span><span class="token template-punctuation string">`</span></span>
		<span class="token comment">// 卡片商品流以及上拉加载</span>
		<span class="token keyword">let</span> commodcradurl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">commodcrad</span><span class="token template-punctuation string">`</span></span>	
		<span class="token comment">// 导出对象</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			bannerget<span class="token punctuation">,</span>
			getrecommurl<span class="token punctuation">,</span>
			billboardurl<span class="token punctuation">,</span>
			commodcradurl<span class="token punctuation">,</span>
			searchurl<span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>在index/index.vue中使用</strong>，并将<strong>recomdata</strong>数据通过ref传递到子组件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">。。。。。。

<span class="token comment">// 引入公用的组件 --懒加载卡片</span>
<span class="token keyword">import</span> Card <span class="token keyword">from</span> <span class="token string">'../commponents/card.vue'</span>

<span class="token comment">// 把请求统一放到父组件</span>
menthods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token keyword">async</span> <span class="token function">indexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 轮播</span>
				<span class="token keyword">let</span> banner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bannerget<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token comment">// 推荐抢购商品 </span>
				<span class="token keyword">let</span> recomm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getrecommurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token comment">// 天猫榜单</span>
				<span class="token keyword">let</span> billboard <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>billboardurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token comment">// 卡片商品流以及上拉加载 （！！注意需要携带参数）</span>
				<span class="token keyword">let</span> commodcrad <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>commodcradurl <span class="token operator">+</span> <span class="token string">'?page='</span> <span class="token operator">+</span> 					                      <span class="token keyword">this</span><span class="token punctuation">.</span>pageid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token keyword">try</span> <span class="token punctuation">{</span>
					<span class="token comment">// 同时并发请求：Promise.all([])</span>
					<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>banner<span class="token punctuation">,</span>recomm<span class="token punctuation">,</span>billboard<span class="token punctuation">,</span>commodcrad<span class="token punctuation">]</span><span class="token punctuation">)</span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 轮播</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>bannerdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
					<span class="token comment">// 快抢购</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>recomdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
					<span class="token comment">// 天猫榜单</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>billdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
					<span class="token comment">// 卡片商品流</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
					
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
                
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> 
<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">indexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>          <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>公用组件Card.vue代码如下:</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comm-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in commdata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comm-card"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comm-img"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comm-title"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comm-left"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>freight<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>预计<span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>Duration<span class="token punctuation">}</span><span class="token punctuation">}</span>h发货<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comm-right"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>Price<span class="token punctuation">}</span><span class="token punctuation">}</span>￥<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token comment">// props接收父组件传递的数组对象</span>
	props<span class="token operator">:</span><span class="token punctuation">{</span>commdata<span class="token operator">:</span>Array<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>comm<span class="token operator">-</span>img <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">450</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comm<span class="token operator">-</span>img image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">450</span>rpx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>top<span class="token operator">-</span>left<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>top<span class="token operator">-</span>right<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comm<span class="token operator">-</span>card <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token operator">%</span> <span class="token operator">-</span> <span class="token number">5</span>rpx <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">5</span>rpx<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comm<span class="token operator">-</span>title <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>rpx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">100</span>rpx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">50</span>rpx<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span>
	overflow<span class="token operator">:</span> hidden<span class="token punctuation">;</span>
	text<span class="token operator">-</span>overflow<span class="token operator">:</span> ellipsis<span class="token punctuation">;</span>
	display<span class="token operator">:</span> <span class="token operator">-</span>webkit<span class="token operator">-</span>box<span class="token punctuation">;</span>
	<span class="token operator">-</span>webkit<span class="token operator">-</span>line<span class="token operator">-</span>clamp<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// 控制多行的行数</span>
	<span class="token operator">-</span>webkit<span class="token operator">-</span>box<span class="token operator">-</span>orient<span class="token operator">:</span> vertical<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comm<span class="token operator">-</span>left <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">20</span>rpx<span class="token punctuation">;</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comm<span class="token operator">-</span>left text <span class="token punctuation">{</span>
	padding<span class="token operator">:</span> <span class="token number">3</span>rpx <span class="token number">4</span>rpx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comm<span class="token operator">-</span>left text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	border<span class="token operator">:</span> <span class="token number">2</span>rpx solid #<span class="token number">1183e6</span><span class="token punctuation">;</span>
	margin<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">1183e6</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comm<span class="token operator">-</span>left text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	border<span class="token operator">:</span> <span class="token number">2</span>rpx solid red<span class="token punctuation">;</span>
	color<span class="token operator">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comm<span class="token operator">-</span>right <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>rpx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #f3022f<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>rpx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">50</span>rpx<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comm<span class="token operator">-</span>view <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">5</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="完成上拉加载"><a href="#完成上拉加载" class="headerlink" title="完成上拉加载"></a>完成上拉加载</h5><p>上拉加载时，一般会加载全部服务器返回的数据，一般用户不会看完那么多的数据，体验感不好，因此一般是仅显示前几条数据，其他数据下拉屏幕获取</p>
<p>首先先封装上拉加载时执行的函数 **pullup()**，</p>
<p>使用uni-app 生命周期 <strong>onReachBottom</strong> 函数来操作 – 页面滚动到底部的事件（不是scroll-view滚到底），常用于下拉下一页数据。</p>
<p>在<strong>index.vue</strong>中添加如下代码</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 上拉加载所得数据</span>
methods<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token keyword">async</span> <span class="token function">pullup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 卡片流商品</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token keyword">let</span> commodcrad <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>commodcradurl <span class="token operator">+</span> <span class="token string">'?page='</span> <span class="token operator">+</span>                           	      <span class="token keyword">this</span><span class="token punctuation">.</span>pageid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>commodcrad<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 把之前得到的数据和上拉得到的数据作数组合并 !    ES6的数组合并方法</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>commdata<span class="token punctuation">,</span><span class="token operator">...</span>commodcrad<span class="token punctuation">.</span>data<span class="token punctuation">]</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>	
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// 页面处理事件--上拉加载更多</span>
<span class="token function">onReachBottom</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>pageid <span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pullup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="封装上拉提示"><a href="#封装上拉提示" class="headerlink" title="封装上拉提示"></a><strong>封装上拉提示</strong></h5><p>用户在上拉的时候，应该给出一个提示比如：正在加载中…   或者到底了…</p>
<p>因为该功能属于公共的，所以考虑封装到公共commponents文件夹里 新建<strong>loading-men.vue</strong>文件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 上拉加载组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 默认是隐藏的该组件，当上拉加载时，父组件传递的对象参数 <span class="token function">到loAD</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 中，解构后让 v<span class="token operator">-</span><span class="token keyword">if</span>为真 组件显示<span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"loading-men"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"loading"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 没数据后图片会隐藏 控制图片的代码是写在index<span class="token punctuation">.</span><span class="token function">vue的pullup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法里 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/loadtmall.gif"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"picture"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>tips<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			loading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
			picture<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
			tips<span class="token operator">:</span> <span class="token string">'玩命加载中'</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token function">loAd</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 接收父组件传递过来的 whether 数据  其他俩值是默认值</span>
			<span class="token keyword">let</span> <span class="token punctuation">{</span> whether <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> picture <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> tips <span class="token operator">=</span> <span class="token string">'玩命加载中'</span><span class="token punctuation">}</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token comment">// 下方数据的数据会自动获取上边的解构的对象值，如果父组件没有传递，就取默认值</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> whether<span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>picture <span class="token operator">=</span> picture<span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>tips <span class="token operator">=</span> tips<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>loading<span class="token operator">-</span>men <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">200</span>rpx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">20</span>rpx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #a7a7a7<span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">0</span> auto<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>loading<span class="token operator">-</span>men image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">60</span>rpx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">80</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>因为用到的地方较多，所以引入到<strong>main.js</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 引入上拉加载组件</span>
<span class="token keyword">import</span> loadn <span class="token keyword">from</span> <span class="token string">'pages/commponents/loading-men.vue'</span>
<span class="token comment">// 注册到组件</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'loader-on'</span><span class="token punctuation">,</span>loadn<span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>

<span class="token comment">// 然后在index.vue中引入组件loader-on组件</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 上拉加载 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>loader<span class="token operator">-</span>on ref<span class="token operator">=</span><span class="token string">"loadon"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>loader<span class="token operator">-</span>on<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>同时在index.vue中 <strong>pullup()</strong> <strong>方法</strong>和 <strong>onReachBottom()</strong> <strong>事件</strong>  代码修改如下：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 上拉加载所得数据</span>
<span class="token keyword">async</span> <span class="token function">pullup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 卡片流商品</span>
	<span class="token keyword">try</span> <span class="token punctuation">{</span>
		<span class="token comment">// 下拉后得到的数据（数组）</span>
		<span class="token keyword">let</span> commodcrad <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>commodcradurl <span class="token operator">+</span> <span class="token string">'?page='</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>commodcrad<span class="token punctuation">,</span><span class="token string">'上拉加载的数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>commodcrad<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 当没有数据时，通过ref，将下拉加载的图片隐藏 同时调整提示的文字</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loadon<span class="token punctuation">.</span><span class="token function">loAd</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  whether <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> picture <span class="token operator">:</span><span class="token boolean">false</span> <span class="token punctuation">,</span> tips <span class="token operator">:</span> <span class="token string">'我是有底线的！'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">// 需要把之前得到的数据和上拉得到的数据做数组合并 !!  。。。表示展开</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>commdata<span class="token punctuation">,</span><span class="token operator">...</span>commodcrad<span class="token punctuation">.</span>data<span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 页面处理事件--上拉加载更多</span>
<span class="token comment">// 给子组件传递数据，即让index.vue中调用子组件的方法，考虑使用ref（在组件上添加） --类似传统的document.getElementById()</span>
<span class="token function">onReachBottom</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loadon<span class="token punctuation">.</span><span class="token function">loAd</span><span class="token punctuation">(</span><span class="token punctuation">{</span> whether<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>pageid <span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pullup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="商品搜索页面"><a href="#商品搜索页面" class="headerlink" title="商品搜索页面"></a>商品搜索页面</h4><p>因为商品搜索并不是在 index.vue 组件上执行，而是跳转到搜索的功能组件里执行。</p>
<p>因此在 <strong>pages **文件夹 新建 **search / search.vue</strong></p>
<p>先在<strong>pages.json</strong>里配置路径</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">{</span>
	<span class="token string">"path"</span><span class="token operator">:</span> <span class="token string">"pages/search/search"</span><span class="token punctuation">,</span>
	<span class="token string">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"搜索"</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在 <strong>index / sonzhujian / search.vue</strong> 中设置<strong>点击input框区域的跳转功能</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-ing"</span> @click<span class="token operator">=</span><span class="token string">"searCh()"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/search/sousuo.png"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> placeholder<span class="token operator">=</span><span class="token string">"搜索喜欢的内容"</span> disabled <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// ...</span>

methods<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token function">searCh</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// uni.navigateTo 保留当前页面，跳转到目标页面</span>
		uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    
			url<span class="token operator">:</span> <span class="token string">'../search/search'</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>搜索页面布局</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 搜索页面组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 文本框 和 搜索按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-cont"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 使用v<span class="token operator">-</span>model 获取输入框的值 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> placeholder<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"inputclass"</span> confirm<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">"搜索"</span> focus<span class="token operator">=</span><span class="token string">"true"</span>
			 placeholder<span class="token operator">=</span><span class="token string">"请输入关键字"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">'searchdata'</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-code"</span> <span class="token operator">&gt;</span>搜索<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 搜索历史 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-history"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"ifhistory"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 最近搜索 和 删除icon<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-title"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>最近搜索<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token operator">&gt;</span><span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/search/searchend.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 历史关键词 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"menu-block"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>衣服<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>裤子<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>女装<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>search <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>direction<span class="token operator">:</span> row<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
	margin<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>search input <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">666666</span><span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>search<span class="token operator">-</span>cont <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">30</span>upx <span class="token number">0</span><span class="token punctuation">;</span>
	background<span class="token operator">:</span> #f8f8f8<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>search<span class="token operator">-</span>code <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">150</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>search<span class="token operator">-</span>history<span class="token punctuation">{</span>margin<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>search<span class="token operator">-</span>title<span class="token punctuation">{</span>font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span> font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
			display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
			justify<span class="token operator">-</span>content<span class="token operator">:</span>space<span class="token operator">-</span>between<span class="token punctuation">;</span>
			align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
			height<span class="token operator">:</span> <span class="token number">60</span>upx<span class="token punctuation">;</span>
			line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">60</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>search<span class="token operator">-</span>title image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">36</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">36</span>upx<span class="token punctuation">;</span> display<span class="token operator">:</span> block<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>menu<span class="token operator">-</span>block view <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #f7f8fa<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">6</span>upx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">27</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">292</span>c33<span class="token punctuation">;</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">20</span>upx <span class="token number">20</span>upx <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>menu<span class="token operator">-</span>block <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>direction<span class="token operator">:</span> row<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> flex<span class="token operator">-</span>start<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="历史搜索的功能实现"><a href="#历史搜索的功能实现" class="headerlink" title="历史搜索的功能实现"></a>历史搜索的功能实现</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 搜索页面组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 文本框 和 搜索按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-cont"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 使用v<span class="token operator">-</span>model 获取输入框的值   @confirm 点击键盘按钮触发事件<span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> placeholder<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"inputclass"</span> confirm<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">"搜索"</span> focus<span class="token operator">=</span><span class="token string">"true"</span>
			 placeholder<span class="token operator">=</span><span class="token string">"请输入关键字"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">'searchdata'</span> @confirm<span class="token operator">=</span><span class="token string">"onKeyInput"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 给点击搜索绑定点击事件 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-code"</span> @click<span class="token operator">=</span><span class="token string">"seArch()"</span> <span class="token operator">&gt;</span>搜索<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 搜索历史 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-history"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"ifhistory"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 最近搜索 和 删除icon<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-title"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>最近搜索<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/search/searchend.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 历史关键词 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"menu-block"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in Storagedata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view @click<span class="token operator">=</span><span class="token string">"menubtn(item)"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token comment">// 引入公用的组件 --懒加载卡片</span>
	<span class="token keyword">import</span> Card <span class="token keyword">from</span> <span class="token string">'../commponents/card.vue'</span>
	
	<span class="token comment">// 解构console.log()方便使用</span>
	<span class="token keyword">var</span> <span class="token punctuation">{</span>log<span class="token punctuation">}</span> <span class="token operator">=</span> console
	
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		components<span class="token operator">:</span><span class="token punctuation">{</span>Card<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				<span class="token comment">// 存放输入框的值</span>
				searchdata<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				<span class="token comment">// 是否有搜索历史</span>
				ifhistory<span class="token operator">:</span><span class="token string">'false'</span><span class="token punctuation">,</span>
				<span class="token comment">// 搜索历史数据</span>
				Storagedata<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				<span class="token comment">// 请求页数</span>
				pageid<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
				<span class="token comment">// 搜索的结果</span>
				commdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
				<span class="token comment">// 没有搜索结果</span>
				searchno<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
				<span class="token comment">// 最后一次搜索结果</span>
				searchkey<span class="token operator">:</span><span class="token string">''</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods <span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token comment">// 点击 搜索按钮 触发搜索功能</span>
			<span class="token function">seArch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>searchdata <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>ifhistory <span class="token operator">=</span> <span class="token boolean">false</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>pageid <span class="token operator">=</span> <span class="token number">0</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>searchdata<span class="token punctuation">)</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">searchData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>searchdata<span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// 键盘 回车键 触发搜索功能</span>
			<span class="token function">onKeyInput</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">let</span> searchkey <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
				<span class="token comment">// 当文本框不为空时</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>searchkey <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>ifhistory <span class="token operator">=</span> <span class="token boolean">false</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>pageid <span class="token operator">=</span> <span class="token number">0</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span>searchkey<span class="token punctuation">)</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">searchData</span><span class="token punctuation">(</span>searchkey<span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			
			<span class="token comment">// 在去请求接口之前，要把搜索结果先存到 本地缓存，然后放到最近搜索这里 （接收的参数是回车事件获取到的 value）</span>
			<span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token parameter">searchkey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 存之前先取之前用户搜索的历史 --key值随意取名  如果没有就取空数组表示本地缓存没有数据</span>
				<span class="token keyword">let</span> searcharray <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'search_key'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
				<span class="token comment">// 存到 searcharray 数组前面</span>
				searcharray<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>searchkey<span class="token punctuation">)</span>
				
				<span class="token comment">// 存  uni.setStorageSync(KEY,DATA) key是名称 DATA是内容</span>
				uni<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'search_key'</span><span class="token punctuation">,</span>searcharray<span class="token punctuation">)</span>
				
				<span class="token comment">// 取  uni.getStorageSync(KEY)</span>
				
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			
			<span class="token comment">// 取出本地缓存的搜索历史</span>
			<span class="token comment">// uni.setStorage(OBJECT) 将数据存储在本地缓存中指定的 key 中，会覆盖掉原来该 key 对应的内容，这是一个异步接口。</span>
			<span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">let</span> setdata <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'search_key'</span><span class="token punctuation">)</span>
				<span class="token comment">// 1.判断缓存里有没有重复的关键词   --有就 数组去重</span>
				<span class="token comment">// 使用的是ES6 Set方法</span>
				<span class="token keyword">let</span> setdataarr <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>setdata<span class="token punctuation">)</span><span class="token punctuation">)</span>
				
				<span class="token comment">// 2.判断缓存里有没有数据</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>setdataarr<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 隐藏搜索历史</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>ifhistory <span class="token operator">=</span> <span class="token boolean">false</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>Storagedata <span class="token operator">=</span>  setdataarr
					<span class="token keyword">this</span><span class="token punctuation">.</span>ifhistory <span class="token operator">=</span> <span class="token boolean">true</span>
				<span class="token punctuation">}</span>	
			<span class="token punctuation">}</span><span class="token punctuation">,</span>			
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
        
		<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token comment">//.....</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="商品搜索请求接口"><a href="#商品搜索请求接口" class="headerlink" title="商品搜索请求接口"></a>商品搜索请求接口</h5><p>先添加清除历史功能</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 最近搜索 和 删除icon<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-title"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>最近搜索<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 给图标添加点击事件 removeStorage <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view @click<span class="token operator">=</span><span class="token string">"removeStorage()"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/search/searchend.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 清空本地缓存 即清空搜索历史 </span>
<span class="token function">removeStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	uni<span class="token punctuation">.</span><span class="token function">removeStorageSync</span><span class="token punctuation">(</span><span class="token string">'search_key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 在调用一下setStorage方法，主要目的是将最近搜索给隐藏</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> <strong>公用的请求接口方法</strong> </p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 公用的请求接口方法  搜索商品</span>
<span class="token keyword">async</span> <span class="token function">searchData</span><span class="token punctuation">(</span>searchkey<span class="token punctuation">,</span>idn<span class="token operator">=</span><span class="token string">'001'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>searchkey <span class="token operator">=</span> searchkey
	<span class="token comment">// 请求的参数</span>
	<span class="token keyword">const</span> keys <span class="token operator">=</span> <span class="token string">'?keyword='</span> <span class="token operator">+</span> searchkey <span class="token operator">+</span> <span class="token string">'&amp;'</span> <span class="token operator">+</span> <span class="token string">'page='</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageid
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> searchdata <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>searchurl <span class="token operator">+</span> keys<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment">// 判断</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>idn <span class="token operator">==</span> <span class="token string">'002'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// 上拉加载</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>searchdata<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loadon<span class="token punctuation">.</span><span class="token function">loAd</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  whether <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> picture <span class="token operator">:</span><span class="token boolean">false</span> <span class="token punctuation">,</span> tips <span class="token operator">:</span> <span class="token string">'我是有底线的！'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>commdata<span class="token punctuation">,</span><span class="token operator">...</span>searchdata<span class="token punctuation">.</span>data<span class="token punctuation">]</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">// 隐藏</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loadon<span class="token punctuation">.</span><span class="token function">loAd</span><span class="token punctuation">(</span><span class="token punctuation">{</span>whether <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token comment">// 判断是否有数据 没有就展示提示</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>searchdata<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>searchno <span class="token operator">=</span> <span class="token boolean">true</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token comment">// 有数据的话就赋值给data里 不展示提示</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> searchdata<span class="token punctuation">.</span>data
				<span class="token keyword">this</span><span class="token punctuation">.</span>searchno <span class="token operator">=</span> <span class="token boolean">false</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>引入style文件夹里的公共样式 在 <strong>main.js</strong> </p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 提示框的css样式</span>
<span class="token keyword">import</span> <span class="token string">'./style/style.css'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>最终代码如下:</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 搜索页面组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 文本框 和 搜索按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-cont"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 使用v<span class="token operator">-</span>model 获取输入框的值   @confirm 点击键盘按钮触发事件<span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> placeholder<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"inputclass"</span> confirm<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">"搜索"</span> focus<span class="token operator">=</span><span class="token string">"true"</span>
			 placeholder<span class="token operator">=</span><span class="token string">"请输入关键字"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">'searchdata'</span> @confirm<span class="token operator">=</span><span class="token string">"onKeyInput"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 给点击搜索绑定点击事件 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-code"</span> @click<span class="token operator">=</span><span class="token string">"seArch()"</span> <span class="token operator">&gt;</span>搜索<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 搜索历史 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-history"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"ifhistory"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 最近搜索 和 删除icon<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-title"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>最近搜索<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view @click<span class="token operator">=</span><span class="token string">"removeStorage()"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/search/searchend.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 历史关键词 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"menu-block"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in Storagedata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view @click<span class="token operator">=</span><span class="token string">"menubtn(item)"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 展示搜索结果 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>Card <span class="token operator">:</span>commdata<span class="token operator">=</span><span class="token string">"commdata"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!searchno"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Card<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 没有搜索结果 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"empty-cart"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"searchno"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/search/sousuono.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>抱歉！暂无相关商品<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 上拉加载 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>loader<span class="token operator">-</span>on ref<span class="token operator">=</span><span class="token string">"loadon"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>loader<span class="token operator">-</span>on<span class="token operator">&gt;</span>
	
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token comment">// 引入公用的组件 --懒加载卡片</span>
	<span class="token keyword">import</span> Card <span class="token keyword">from</span> <span class="token string">'../commponents/card.vue'</span>
	
	<span class="token comment">// 解构console.log()方便使用</span>
	<span class="token keyword">var</span> <span class="token punctuation">{</span>log<span class="token punctuation">}</span> <span class="token operator">=</span> console
	
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		components<span class="token operator">:</span><span class="token punctuation">{</span>Card<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				<span class="token comment">// 存放输入框的值</span>
				searchdata<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				<span class="token comment">// 是否有搜索历史</span>
				ifhistory<span class="token operator">:</span><span class="token string">'false'</span><span class="token punctuation">,</span>
				<span class="token comment">// 搜索历史数据</span>
				Storagedata<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				<span class="token comment">// 请求页数</span>
				pageid<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
				<span class="token comment">// 搜索的结果</span>
				commdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
				<span class="token comment">// 没有搜索结果</span>
				searchno<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
				<span class="token comment">// 搜索值最后一次搜索结果</span>
				searchkey<span class="token operator">:</span><span class="token string">''</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods <span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token comment">// 点击 搜索按钮 触发搜索功能</span>
			<span class="token function">seArch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>searchdata <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>ifhistory <span class="token operator">=</span> <span class="token boolean">false</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>pageid <span class="token operator">=</span> <span class="token number">0</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>searchdata<span class="token punctuation">)</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">searchData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>searchdata<span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// 键盘 回车键 触发搜索功能</span>
			<span class="token function">onKeyInput</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">let</span> searchkey <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
				<span class="token comment">// 当文本框不为空时</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>searchkey <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>ifhistory <span class="token operator">=</span> <span class="token boolean">false</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>pageid <span class="token operator">=</span> <span class="token number">0</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span>searchkey<span class="token punctuation">)</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">searchData</span><span class="token punctuation">(</span>searchkey<span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			
			<span class="token comment">// 在去请求接口之前，要把搜索结果先存到 本地缓存，然后放到最近搜索这里 （接收的参数是回车事件获取到的 value）</span>
			<span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token parameter">searchkey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 存之前先取之前用户搜索的历史 --key值随意取名  如果没有就取空数组表示本地缓存没有数据</span>
				<span class="token keyword">let</span> searcharray <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'search_key'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
				<span class="token comment">// 存到 searcharray 数组前面</span>
				searcharray<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>searchkey<span class="token punctuation">)</span>
				
				<span class="token comment">// 存  uni.setStorageSync(KEY,DATA) key是名称 DATA是内容</span>
				uni<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'search_key'</span><span class="token punctuation">,</span>searcharray<span class="token punctuation">)</span>
				
				<span class="token comment">// 取  uni.getStorageSync(KEY)</span>
				
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			
			<span class="token comment">// 取出本地缓存的搜索历史</span>
			<span class="token comment">// uni.setStorage(OBJECT) 将数据存储在本地缓存中指定的 key 中，会覆盖掉原来该 key 对应的内容，这是一个异步接口。</span>
			<span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">let</span> setdata <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'search_key'</span><span class="token punctuation">)</span>
				<span class="token comment">// 1.判断缓存里有没有重复的关键词   --有就 数组去重</span>
				<span class="token comment">// 使用的是ES6 Set方法</span>
				<span class="token keyword">let</span> setdataarr <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>setdata<span class="token punctuation">)</span><span class="token punctuation">)</span>
				
				<span class="token comment">// 2.判断缓存里有没有数据</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>setdataarr<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 隐藏搜索历史</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>ifhistory <span class="token operator">=</span> <span class="token boolean">false</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>Storagedata <span class="token operator">=</span>  setdataarr
					<span class="token keyword">this</span><span class="token punctuation">.</span>ifhistory <span class="token operator">=</span> <span class="token boolean">true</span>
				<span class="token punctuation">}</span>
				
				
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			
			<span class="token comment">// 清空本地缓存的Storage即清空搜索历史</span>
			<span class="token function">removeStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				 uni<span class="token punctuation">.</span><span class="token function">removeStorageSync</span><span class="token punctuation">(</span><span class="token string">'search_key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				 <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			
			<span class="token comment">// 搜索历史</span>
			<span class="token function">menubtn</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 先隐藏搜索历史</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>ifhistory <span class="token operator">=</span> <span class="token boolean">false</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>pageid <span class="token operator">=</span> <span class="token number">0</span>
				<span class="token comment">// 再发起请求</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">searchData</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			
			<span class="token comment">// 公用的请求接口方法  搜索商品 给参数传一个值 idn 用于判断触发搜索</span>
			<span class="token keyword">async</span> <span class="token function">searchData</span><span class="token punctuation">(</span>searchkey<span class="token punctuation">,</span>idn<span class="token operator">=</span><span class="token string">'001'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>searchkey <span class="token operator">=</span> searchkey
				<span class="token comment">// 请求的参数</span>
				<span class="token keyword">const</span> keys <span class="token operator">=</span> <span class="token string">'?keyword='</span> <span class="token operator">+</span> searchkey <span class="token operator">+</span> <span class="token string">'&amp;'</span> <span class="token operator">+</span> <span class="token string">'page='</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageid
				<span class="token keyword">try</span><span class="token punctuation">{</span>
					<span class="token keyword">let</span> searchdata <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>searchurl <span class="token operator">+</span> keys<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					<span class="token comment">// 判断</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>idn <span class="token operator">==</span> <span class="token string">'002'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token comment">// 上拉加载</span>
						<span class="token keyword">if</span><span class="token punctuation">(</span>searchdata<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loadon<span class="token punctuation">.</span><span class="token function">loAd</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  whether <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> picture <span class="token operator">:</span><span class="token boolean">false</span> <span class="token punctuation">,</span> tips <span class="token operator">:</span> <span class="token string">'我是有底线的！'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
						<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>commdata<span class="token punctuation">,</span><span class="token operator">...</span>searchdata<span class="token punctuation">.</span>data<span class="token punctuation">]</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
						<span class="token comment">// 隐藏</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loadon<span class="token punctuation">.</span><span class="token function">loAd</span><span class="token punctuation">(</span><span class="token punctuation">{</span>whether <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
						<span class="token comment">// 判断是否有数据 没有就展示提示</span>
						<span class="token keyword">if</span><span class="token punctuation">(</span>searchdata<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>searchno <span class="token operator">=</span> <span class="token boolean">true</span>
						<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
							<span class="token comment">// 有数据的话就赋值给data里 不展示提示</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> searchdata<span class="token punctuation">.</span>data
							<span class="token keyword">this</span><span class="token punctuation">.</span>searchno <span class="token operator">=</span> <span class="token boolean">false</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token comment">//TODO handle the exception</span>
					
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 页面处理事件--上拉加载更多</span>
		<span class="token function">onReachBottom</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 显示提示 通过ref 操作dom</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loadon<span class="token punctuation">.</span><span class="token function">loAd</span><span class="token punctuation">(</span><span class="token punctuation">{</span> whether<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>pageid<span class="token operator">++</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">searchData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>searchkey<span class="token punctuation">,</span><span class="token string">'002'</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="商品详情页"><a href="#商品详情页" class="headerlink" title="商品详情页"></a>商品详情页</h3><h4 id="自定义顶部导航栏"><a href="#自定义顶部导航栏" class="headerlink" title="自定义顶部导航栏"></a>自定义顶部导航栏</h4><p>在<strong>pages</strong>文件夹下新建 <strong>details.vue</strong>文件</p>
<p>pages.json中写入地址</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">{</span>
	<span class="token comment">// 展示用户初次进入的页面</span>
	<span class="token string">"path"</span><span class="token operator">:</span> <span class="token string">"pages/details/details"</span><span class="token punctuation">,</span>
	<span class="token string">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"详情页"</span><span class="token punctuation">,</span>
		<span class="token string">"navigationStyle"</span><span class="token operator">:</span> <span class="token string">"custom"</span>  <span class="token comment">// 文字可以排列到顶部</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>获取右上角胶囊按钮的宽高和到边框的距离</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// getMenuButtonBoundingClientRect()  本API用于获取小程序下胶囊按钮的布局位置信息（宽高、边距等等），方便开发者布局顶部内容时避开该按钮坐标信息以屏幕左上角为原点。</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>下方的部分新建<strong>sonzujian文件夹下新建top.vue</strong>：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"navs-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"navs-image"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">" 'height:'+ tophight.height + 'px;' "</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/fanhuihei.png"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"navs"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in navalue"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 动态设置 高度 和 行高  与胶囊对齐 同时设置一个底部横线<span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"navs-nav"</span> <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{navactivetext:index == num}"</span>
				<span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">" 'height:'+ tophight.height + 'px;' + 'line-height:' + tophight.height + 'px;' "</span>
				@click<span class="token operator">=</span><span class="token string">"navbtn(index)"</span>
				<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view style<span class="token operator">=</span><span class="token string">"width: 20px; padding-right: 20rpx;"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
	props<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 接收父组件数据 子组件自定义高度</span>
		tophight<span class="token operator">:</span>Object
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			num<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
			navalue<span class="token operator">:</span> <span class="token punctuation">[</span>
					<span class="token punctuation">{</span>
						<span class="token string">'name'</span><span class="token operator">:</span><span class="token string">'商品'</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token punctuation">{</span>
						<span class="token string">'name'</span><span class="token operator">:</span><span class="token string">'评价'</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token punctuation">{</span>
						<span class="token string">'name'</span><span class="token operator">:</span><span class="token string">'详情'</span>
					<span class="token punctuation">}</span>
			<span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 控制短横线跳转位置</span>
		<span class="token function">navbtn</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> index
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>navs<span class="token operator">-</span>nav<span class="token punctuation">{</span>font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span> width<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
 text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span> color<span class="token operator">:</span> #<span class="token number">464230</span><span class="token punctuation">;</span>

 <span class="token punctuation">}</span>
 <span class="token punctuation">.</span>navs<span class="token operator">-</span>image image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span>
 <span class="token punctuation">.</span>navs<span class="token operator">-</span>image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span> display<span class="token operator">:</span> flex<span class="token punctuation">;</span> align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span> padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">20</span>rpx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>navs<span class="token punctuation">{</span>display<span class="token operator">:</span> flex<span class="token punctuation">;</span> justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span> align<span class="token operator">-</span>self<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>navactivetext<span class="token punctuation">{</span>border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">5</span>upx solid #<span class="token number">3</span>d3b32<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>navs<span class="token operator">-</span>view<span class="token punctuation">{</span>display<span class="token operator">:</span> flex<span class="token punctuation">;</span> align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span> justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>此时父组件details.vue是这样：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 返回按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"header-fixed backno"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"showAbs"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 箭头符号设置的动态的高 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"status_bar"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"'height: '+ tophight.top + 'px;'"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"navs-image"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"'height: '+ tophight.height + 'px;' "</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/fanhuibai.jpg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> tab <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>子组件 默认不显示出来<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"header-fixed backyes"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"!showAbs"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 放置一个div 撑开到顶部距离 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"status_bar"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"'height: '+ tophight.top + 'px;'"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 引用子组件   且给子组件传递 tophight 子组件里设置高度<span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>top <span class="token operator">:</span>tophight<span class="token operator">=</span><span class="token string">"tophight"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>top<span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>


<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">import</span> Top <span class="token keyword">from</span> <span class="token string">'./sonzhujian/top.vue'</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		components<span class="token operator">:</span><span class="token punctuation">{</span>
			Top<span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				tophight<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>	<span class="token comment">// 胶囊按钮的数据</span>
				showAbs<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> 	<span class="token comment">//控制箭头按钮显示/隐藏</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// 获取胶囊按钮的数据  m包含胶囊按钮的所有信息</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>tophight <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getMenuButtonBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
	
page<span class="token punctuation">{</span>background<span class="token operator">:</span> #f2f2f2<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>header<span class="token operator">-</span>fixed<span class="token punctuation">{</span>
position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>backyes<span class="token punctuation">{</span>background<span class="token operator">:</span> #f8f8f8<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>backno<span class="token punctuation">{</span>background<span class="token operator">:</span> none<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>status_bar <span class="token punctuation">{</span>
width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
<span class="token comment">/* background: #007AFF; */</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>navs<span class="token operator">-</span>image image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">28</span>px<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">28</span>px<span class="token punctuation">;</span>
border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>navs<span class="token operator">-</span>image<span class="token punctuation">{</span>display<span class="token operator">:</span> flex<span class="token punctuation">;</span> align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
 padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* banner部分 */</span>
<span class="token punctuation">.</span>imageurl <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">700</span>upx <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

swiper <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">700</span>upx <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>swiper<span class="token operator">-</span>video<span class="token punctuation">{</span>height<span class="token operator">:</span> <span class="token number">700</span>upx<span class="token punctuation">;</span> background<span class="token operator">:</span> #<span class="token number">4</span>CD964<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>swiper<span class="token operator">-</span>video video<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">700</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token comment">/* 自定义按钮 */</span>
<span class="token punctuation">.</span>video<span class="token operator">-</span>img image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span> z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">999</span><span class="token punctuation">;</span>
border<span class="token operator">:</span> <span class="token number">2</span>px solid #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>video<span class="token operator">-</span>img<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span>
position<span class="token operator">:</span> absolute<span class="token punctuation">;</span> bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
left<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
top<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
transform<span class="token operator">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">)</span> <span class="token function">translateY</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>video<span class="token operator">-</span>btn<span class="token punctuation">{</span>height<span class="token operator">:</span> <span class="token number">700</span>upx<span class="token punctuation">;</span> position<span class="token operator">:</span> relative<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="滚动监听显示隐藏导航栏"><a href="#滚动监听显示隐藏导航栏" class="headerlink" title="滚动监听显示隐藏导航栏"></a>滚动监听显示隐藏导航栏</h4><p>首先有滚动监听的方法： onPageScroll ( )   – 监听页面滚动，参数为Object</p>
<p>然后有滚动的淡入淡出效果: opacity属性 </p>
<p>此时details.vue文件代码如下：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 返回按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"header-fixed backno"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"showAbs"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 箭头符号设置的动态的高 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"status_bar"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"'height: '+ tophight.top + 'px;'"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"navs-image"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"'height: '+ tophight.height + 'px;' "</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/fanhuibai.jpg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> tab <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>子组件 默认不显示出来 同时透明度值默认是<span class="token number">0</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"header-fixed backyes"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"!showAbs"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"{opacity:styleObject}"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 放置一个div 撑开到顶部距离 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"status_bar"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"'height: '+ tophight.top + 'px;'"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 引用子组件   且给子组件传递 tophight 子组件里设置高度<span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>top <span class="token operator">:</span>tophight<span class="token operator">=</span><span class="token string">"tophight"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>top<span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view style<span class="token operator">=</span><span class="token string">"height: 2000upx;"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>


<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">import</span> Top <span class="token keyword">from</span> <span class="token string">'./sonzhujian/top.vue'</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		components<span class="token operator">:</span><span class="token punctuation">{</span>
			Top<span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				tophight<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>	<span class="token comment">// 胶囊按钮的数据</span>
				showAbs<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> 	<span class="token comment">//控制箭头按钮显示/隐藏 true为显示</span>
				styleObject<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">//透明度</span>
				
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// 获取胶囊按钮的数据  m包含胶囊按钮的所有信息</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>tophight <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getMenuButtonBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 这里的 e 就是滚动的距离</span>
		<span class="token function">onPageScroll</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleScroll</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>scrollTop<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token comment">// 导航栏的显示 接收一个参数    top是滚动的距离</span>
			<span class="token function">handleScroll</span><span class="token punctuation">(</span><span class="token parameter">top</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 90 300 是任意随便写的 当滑动的距离大于90时</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>top <span class="token operator">&gt;</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">let</span> opacity <span class="token operator">=</span> top <span class="token operator">/</span> <span class="token number">300</span>     				<span class="token comment">// 这一步是让透明度尽量变小 </span>
					opacity <span class="token operator">=</span> opacity <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> opacity   	 	<span class="token comment">// 如果透明度大于1就等于1 否则透明度就取小于1 </span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>showAbs <span class="token operator">=</span> <span class="token boolean">false</span>						<span class="token comment">// 控制顶部栏 的箭头按钮隐藏</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>styleObject <span class="token operator">=</span> opacity					<span class="token comment">// 透明度赋值一下</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>shhowAbs <span class="token operator">=</span> <span class="token boolean">true</span>  <span class="token comment">//小于90 即显示顶部导航栏</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="带视频和图片的轮播组件"><a href="#带视频和图片的轮播组件" class="headerlink" title="带视频和图片的轮播组件"></a>带视频和图片的轮播组件</h4><p>轮播组件其实也就是swiper组件</p>
<p>因为uniapp 的swiper组件 再子组件内时，带有视频的轮播不能播放视频，所以轮播还是写到父组件 <strong>details.vue</strong> 里边</p>
<p><strong>:show-center-play-btn = “false”</strong>  隐藏视频中间默认得播放按钮<br><strong>:controls=”false”</strong>                            隐藏左下角播放组件<br><strong>object-fit=”cover”</strong>                    当视频大小与 video 容器大小不一致时，视频的表现形式。contain：包含，fill：填充，cover：覆盖<strong>uni.createVideoContext(videoId, this)</strong>     创建并返回 video 上下文 videoContext 对象获取videodom对象</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 返回按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">...</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 子组件 tab <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>组件 默认不显示出来 同时透明度值默认是<span class="token number">0</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">...</span>

		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 图片视频宣传样例 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 注意：如果含有视频播放，在子组件里无法触发视频播放，必须要在父组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>swiper <span class="token operator">:</span>indicator<span class="token operator">-</span>dots<span class="token operator">=</span><span class="token string">"dots"</span>  <span class="token operator">:</span>interval<span class="token operator">=</span><span class="token string">"3000"</span> <span class="token operator">:</span>duration<span class="token operator">=</span><span class="token string">"1000"</span> <span class="token operator">:</span>circular<span class="token operator">=</span><span class="token string">"true"</span>
			indicator<span class="token operator">-</span>color<span class="token operator">=</span><span class="token string">"rgba(216, 216, 216)"</span>
			indicator<span class="token operator">-</span>active<span class="token operator">-</span>color<span class="token operator">=</span><span class="token string">"#7a7a7a"</span>
			<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>swiper<span class="token operator">-</span>item <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"swiper-video"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"video-btn"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>video id<span class="token operator">=</span><span class="token string">"myVideo"</span> src<span class="token operator">=</span><span class="token string">"http://vd2.bdstatic.com/mda-naa98nr851kwmwya/cae_h264_delogo/1641911777690304151/mda-naa98nr851kwmwya.mp4"</span>
							<span class="token operator">:</span>show<span class="token operator">-</span>center<span class="token operator">-</span>play<span class="token operator">-</span>btn <span class="token operator">=</span> <span class="token string">"false"</span> 
							<span class="token operator">:</span>controls<span class="token operator">=</span><span class="token string">"false"</span>
							object<span class="token operator">-</span>fit<span class="token operator">=</span><span class="token string">"cover"</span>
							<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>video<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 播放按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"video-img"</span> @click<span class="token operator">=</span><span class="token string">"videoPlay()"</span> <span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/bofang.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>swiper<span class="token operator">-</span>item<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>swiper<span class="token operator">-</span>item<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"imageurl"</span> <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>swiper<span class="token operator">-</span>item<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>swiper<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		videoplay<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>   <span class="token comment">// 得到视频上下文 得到结果是对象	</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 得到视频节点 (对象)</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>videoplay <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">createVideoContext</span><span class="token punctuation">(</span><span class="token string">'myVideo'</span><span class="token punctuation">)</span>
				
<span class="token punctuation">}</span><span class="token punctuation">,</span>
methods<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 手动触发视频播放</span>
	<span class="token function">videoPlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>videoplay<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="视频操作的一些方法"><a href="#视频操作的一些方法" class="headerlink" title="视频操作的一些方法"></a>视频操作的一些方法</h4><p><strong>在video上添加属性</strong></p>
<p><strong>@play</strong>=”playFun”   当开始/继续播放时触发 play事件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 视频播放时触发的方法</span>
<span class="token function">playFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>startVideo <span class="token operator">=</span> <span class="token boolean">false</span>  <span class="token comment">// 中间播放按钮 隐藏</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>conting <span class="token operator">=</span> <span class="token boolean">true</span>		 <span class="token comment">//	显示视频左下角播放组控件</span>
<span class="token punctuation">}</span>	
				<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>@pause</strong>=”pauseFun”  当暂停播放时触发 pause 事件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 视频暂停时触发的方法</span>
<span class="token function">pauseFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>conting <span class="token operator">=</span> <span class="token boolean">false</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>startVideo <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>@ended</strong>=”endedFun“   当播放到末尾时触发 ended 事件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">endedFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>conting <span class="token operator">=</span> <span class="token boolean">false</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>startVideo <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>swiper 的滑动事件</strong></p>
<p> <strong>@change</strong>  current 改变时会触发 change 事件，</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">@change<span class="token operator">=</span><span class="token string">"bannerfun()"</span>  <span class="token comment">//写在swiper属性中</span>
<span class="token comment">// 滑块滑动时触发</span>
<span class="token function">bannerfun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>videoplay<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="请求banner栏的数据"><a href="#请求banner栏的数据" class="headerlink" title="请求banner栏的数据"></a>请求banner栏的数据</h4><p>接口的添加就和之前一样定义好就不赘述了，</p>
<p>在mthods里定义请求的方法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">methods<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token comment">// 请求数据方法</span>
	<span class="token keyword">async</span> <span class="token function">detRequest</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> introduce <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>introduceurl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
			<span class="token comment">// 因为后期需要发起多次请求,用promise.all做一个并发请求</span>
			<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>introduce<span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token comment">// 图片视频的数据</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>imagetext <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>		
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// 在onLoad里边调用请求方法 这里的参数是暂时选择的一个接口地址</span>
<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">detRequest</span><span class="token punctuation">(</span><span class="token string">'5f8bbf2823954733542169a1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>在swiper里遍历</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>swiper <span class="token operator">:</span>indicator<span class="token operator">-</span>dots<span class="token operator">=</span><span class="token string">"dots"</span>  <span class="token operator">:</span>interval<span class="token operator">=</span><span class="token string">"3000"</span> <span class="token operator">:</span>duration<span class="token operator">=</span><span class="token string">"1000"</span> <span class="token operator">:</span>circular<span class="token operator">=</span><span class="token string">"true"</span>
indicator<span class="token operator">-</span>color<span class="token operator">=</span><span class="token string">"rgba(216, 216, 216)"</span>
indicator<span class="token operator">-</span>active<span class="token operator">-</span>color<span class="token operator">=</span><span class="token string">"#7a7a7a"</span>
@change<span class="token operator">=</span><span class="token string">"bannerfun()"</span>
<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(iteming,index) in imagetext[0].media"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>swiper<span class="token operator">-</span>item <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"swiper-video"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"video-btn"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>video id<span class="token operator">=</span><span class="token string">"myVideo"</span> <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"iteming.video"</span>
					<span class="token operator">:</span>show<span class="token operator">-</span>center<span class="token operator">-</span>play<span class="token operator">-</span>btn <span class="token operator">=</span> <span class="token string">"false"</span> 
					<span class="token operator">:</span>controls<span class="token operator">=</span><span class="token string">"conting"</span>
					object<span class="token operator">-</span>fit<span class="token operator">=</span><span class="token string">"cover"</span>
					@play<span class="token operator">=</span><span class="token string">"playFun"</span>
					@pause<span class="token operator">=</span><span class="token string">"pauseFun"</span>
					@ended<span class="token operator">=</span><span class="token string">"endedFun"</span>
					<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>video<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 播放按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"video-img"</span> @click<span class="token operator">=</span><span class="token string">"videoPlay()"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"startVideo"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/bofang.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>swiper<span class="token operator">-</span>item<span class="token operator">&gt;</span>

		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,indexing) in iteming.imgArray"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"indexing"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>swiper<span class="token operator">-</span>item<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"imageurl"</span> <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>swiper<span class="token operator">-</span>item<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>swiper<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>对指示点的出现时机作配置，当请求到的数据里的video有数据时，不显示指示点，否则显示指示点</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 请求数据方法</span>
<span class="token keyword">async</span> <span class="token function">detRequest</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> introduce <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>introduceurl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token comment">// 因为后期需要发起多次请求,用promise.all做一个并发请求</span>
		<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>introduce<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token comment">// 图片视频的数据</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>imagetext <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
		<span class="token keyword">let</span> mendata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
		<span class="token comment">// 如果有视频,不显示面板指示点 先拿到数据里的video地址</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>truevideo <span class="token operator">=</span> mendata<span class="token punctuation">.</span>media<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>video
		<span class="token comment">// 三元表达式 如果视频数据为空 就显示指示点 否则不显示</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>dots <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>truevideo <span class="token operator">==</span> <span class="token string">''</span><span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>同时用v-if判断，当没有请求到video数据时，隐藏视频的swiper=</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">							<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 视频数据不为空 才显示视频组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>swiper<span class="token operator">-</span>item <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"swiper-video"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"iteming.video !== ''"</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>对有视频的情况，进行指示点的详细判断，在视频页面不显示指示点，图片页面显示指示点，核心思路是e.current值</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 滑块滑动时触发  这里的 e 包含了很多的数据 其中 current值等于 请求到的index值</span>
<span class="token function">bannerfun</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// if(e.detail.current !== 0) { 		//滑块滑动到图片的时候显示面板指示点 方法 1</span>
	<span class="token comment">// 	this.dots = true</span>
	<span class="token comment">// }else {</span>
	<span class="token comment">// 	this.dots = false</span>
	<span class="token comment">// }</span>
	<span class="token keyword">let</span> inx <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>current 				<span class="token comment">//滑块滑动到图片的时候显示面板指示点 方法 2</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>truevideo <span class="token operator">!==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>videoplay<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   			<span class="token comment">//暂停视频</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>dots <span class="token operator">=</span> inx <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token boolean">false</span> <span class="token operator">:</span> <span class="token boolean">true</span> 
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>dots <span class="token operator">=</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当滑动视频时候会触发自带的 enable-progress-gesture 属性 –开启控制进度的手势 ，给它关闭掉，这样下次会继续播放之前暂停的视频。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 在video标签内</span>
<span class="token operator">:</span>enable<span class="token operator">-</span>progress<span class="token operator">-</span>gesture <span class="token operator">=</span> <span class="token string">"false"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h4 id="封装预览图片"><a href="#封装预览图片" class="headerlink" title="封装预览图片"></a>封装预览图片</h4><p>预览图片功能是公共的组件，因此抽出到新目录</p>
<p>在根目录下新建<strong>public/logic.js</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 预览图片</span>
<span class="token keyword">class</span> <span class="token class-name">Login</span><span class="token punctuation">{</span>
	<span class="token comment">// index --当前图片下标     imgarr --图片地址(是数组参数)</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>imgarr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">=</span> index
		<span class="token keyword">this</span><span class="token punctuation">.</span>imgarr <span class="token operator">=</span> imgarr
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 调用预览图片的方法</span>
	<span class="token function">previewImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		uni<span class="token punctuation">.</span><span class="token function">previewImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			current<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>index<span class="token punctuation">,</span>
			urls<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>imgarr
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>

<span class="token comment">// 导出</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> Login <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>引入到details.vue文件</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 预览图片 node导入模式</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Login <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../public/logic.js'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>给图片上添加点击事情,同时实例化引入的Login，并传入参数后调用内置的previewImg方法</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"imageurl"</span> @click<span class="token operator">=</span><span class="token string">"previmg(indexing,iteming.imgArray)"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
<span class="token comment">//...</span>

<span class="token comment">// 预览图片</span>
<span class="token function">previmg</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>imgArray</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>imgArray<span class="token punctuation">)</span>
		<span class="token comment">// 实例化类 ,同时传入俩参数,接着调用里边的previewImg方法</span>
		<span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>imgArray<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">previewImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="获取商品标题价格等数据"><a href="#获取商品标题价格等数据" class="headerlink" title="获取商品标题价格等数据"></a>获取商品标题价格等数据</h4><p>在<strong>pages/details/sonzhujian下新建price.vue</strong></p>
<p>接着在<strong>details.vue引入price.vue，</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 价格区域 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"price-view"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>当前价<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"price-list"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>¥<span class="token punctuation">{</span><span class="token punctuation">{</span>priceetc<span class="token punctuation">.</span>Trueprice<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"scribing"</span><span class="token operator">&gt;</span>原价¥<span class="token punctuation">{</span><span class="token punctuation">{</span>priceetc<span class="token punctuation">.</span>Crossedprice<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>  淘金币抵<span class="token number">6</span><span class="token operator">%</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Discount-view"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>priceetc<span class="token punctuation">.</span>Goldcoin<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>priceetc<span class="token punctuation">.</span>integral<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 标题 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"price-Title"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"titleing"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>priceetc<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"price-Image"</span> <span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/canshu.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>参数<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 月销 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Monthly"</span><span class="token operator">&gt;</span>销量<span class="token punctuation">{</span><span class="token punctuation">{</span>priceetc<span class="token punctuation">.</span>sales_volume<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	props<span class="token operator">:</span><span class="token punctuation">{</span>
		priceetc<span class="token operator">:</span>Object<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>	
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>price<span class="token operator">-</span>view<span class="token punctuation">{</span>
<span class="token comment">/* background: #FFFFFF; */</span>
background<span class="token operator">:</span>linear<span class="token operator">-</span><span class="token function">gradient</span><span class="token punctuation">(</span>to right<span class="token punctuation">,</span>#ff0000<span class="token punctuation">,</span>#ff4000<span class="token punctuation">,</span>#ff8000<span class="token punctuation">)</span><span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">120</span>upx<span class="token punctuation">;</span>
font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">35</span>upx<span class="token punctuation">;</span>
padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
color<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>price<span class="token operator">-</span>list<span class="token punctuation">{</span>display<span class="token operator">:</span> flex<span class="token punctuation">;</span> align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span> line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>price<span class="token operator">-</span>list text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">40</span>upx<span class="token punctuation">;</span> padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>price<span class="token operator">-</span>list text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span>
<span class="token comment">/* background: red;
color: #fe0032;
height: 30upx;
line-height: 30upx;
text-align: center;
border-radius: 50upx;
padding: 9upx 23upx; */</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>scribing<span class="token punctuation">{</span>text<span class="token operator">-</span>decoration<span class="token operator">:</span> line<span class="token operator">-</span>through<span class="token punctuation">;</span> color<span class="token operator">:</span> #b5b5b5 <span class="token operator">!</span>important<span class="token punctuation">;</span>
padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">7</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>textstyle text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>background<span class="token operator">:</span> #<span class="token constant">FFFFFF</span> <span class="token operator">!</span>important<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>coupon<span class="token operator">-</span>text<span class="token punctuation">{</span>color<span class="token operator">:</span> #<span class="token constant">FFFFFF</span> <span class="token operator">!</span>important<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token comment">/* 优惠券 */</span>
<span class="token punctuation">.</span>Discount<span class="token operator">-</span>view<span class="token punctuation">{</span>
font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span>
background<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>Discount<span class="token operator">-</span>view text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">-</span>n<span class="token operator">+</span><span class="token number">2</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>background<span class="token operator">:</span> #ffeaef<span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
margin<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>Discount<span class="token operator">-</span>view text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">3</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
text<span class="token operator">-</span>align<span class="token operator">:</span> right<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token comment">/* 标题 */</span>
<span class="token punctuation">.</span>price<span class="token operator">-</span>Title<span class="token punctuation">{</span>font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">35</span>upx<span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
background<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">20</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>

<span class="token punctuation">.</span>titleing<span class="token punctuation">{</span>
overflow<span class="token operator">:</span> hidden<span class="token punctuation">;</span>
text<span class="token operator">-</span>overflow<span class="token operator">:</span> ellipsis<span class="token punctuation">;</span>
display<span class="token operator">:</span> <span class="token operator">-</span>webkit<span class="token operator">-</span>box<span class="token punctuation">;</span>
<span class="token operator">-</span>webkit<span class="token operator">-</span>line<span class="token operator">-</span>clamp<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>  <span class="token comment">// 控制多行的行数</span>
<span class="token operator">-</span>webkit<span class="token operator">-</span>box<span class="token operator">-</span>orient<span class="token operator">:</span> vertical<span class="token punctuation">;</span>
flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>price<span class="token operator">-</span>Title image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span> padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">5</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>price<span class="token operator">-</span>Image<span class="token punctuation">{</span>display<span class="token operator">:</span> flex<span class="token punctuation">;</span> flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span> justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
align<span class="token operator">-</span>items<span class="token operator">:</span> flex<span class="token operator">-</span>end<span class="token punctuation">;</span>
font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span>
width<span class="token operator">:</span> <span class="token number">150</span>upx<span class="token punctuation">;</span>
<span class="token comment">/* background: #1183E6; */</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 月销 */</span>
<span class="token punctuation">.</span>Monthly<span class="token punctuation">{</span>
background<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span> color<span class="token operator">:</span> #<span class="token number">999999</span><span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
justify<span class="token operator">-</span>content<span class="token operator">:</span> flex<span class="token operator">-</span>end<span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="兄弟组件传值请求产品参数数据"><a href="#兄弟组件传值请求产品参数数据" class="headerlink" title="兄弟组件传值请求产品参数数据"></a>兄弟组件传值请求产品参数数据</h4><p>在<strong>pages/details/sonzhujian下新建parame.vue</strong></p>
<p>接着在<strong>details.vue引入parame.vue，</strong>同时引入写好的公共样式文件夹pattern，并在main.js中引入</p>
<p><strong>功能需求：</strong>price.vue组件中点击参数后，parame.vue组件显示产品参数页面</p>
<p><strong>思路：</strong></p>
<p>默认使用v-if 隐藏</p>
<p>然后兄弟组件间传值  –使用bus总线传值</p>
<p>public文件夹下新建文件bus.js</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// vue 的总线传值</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>然后在main.js中引入</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// bus传值</span>
<span class="token keyword">import</span> bus <span class="token keyword">from</span> <span class="token string">'./public/bus.js'</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$bus <span class="token operator">=</span> bus<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>在要发送数据的组件里使用全局事件总线：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">methods<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 兄弟组件传值显示产品参数</span>
	<span class="token function">parameFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// $emit() 传值  第一个值是要调用组件的名称可以随意命名  第二个值是要传递的参数</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'parames'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>show<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在要用到数据的组件里接收：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 接收 $on</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'parames'</span><span class="token punctuation">,</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 让键值对的键相对应</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>couponif <span class="token operator">=</span> res<span class="token punctuation">.</span>show
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在price.vue组件的点击参数事件中，添加请求方法，并通过全局总线传递给兄弟组件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">					<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> priceetc<span class="token punctuation">.</span>id <span class="token operator">--</span> 通过父组件details<span class="token punctuation">.</span>vue传递过来的priceetc<span class="token punctuation">.</span>id 值作为本组件发起请求的id参数 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"price-Image"</span> @click<span class="token operator">=</span><span class="token string">"parameFun(priceetc.id)"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/canshu.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>参数<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 兄弟组件传值显示产品参数</span>
		<span class="token keyword">async</span> <span class="token function">parameFun</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
				<span class="token keyword">let</span> parameter <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>parameterurl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token comment">// $emit() 传值  第一个值是要调用组件的名称可以随意命名  第二个值是要传递的参数</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'parames'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>show<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>data<span class="token operator">:</span>parameter<span class="token punctuation">.</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				
			<span class="token punctuation">}</span>	
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>子组件代码如下：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"couponif"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 遮罩层 <span class="token operator">--</span><span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> catchtouchmove 防止穿透点击下方的事件 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Coupon-yin anim"</span> <span class="token operator">:</span>catchtouchmove<span class="token operator">=</span><span class="token string">"true"</span> @click<span class="token operator">=</span><span class="token string">"hideCou()"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Coupon-view coup-anim"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Coupon-title"</span><span class="token operator">&gt;</span>产品参数<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in paramedata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"parame-view"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"parame-left"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"parame-right"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>label<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				couponif<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span> 		<span class="token comment">// 隐藏组件的数据</span>
				paramedata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>			<span class="token comment">// 接收所有产品参数的数据</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// 接收 $on 兄弟组件数据</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'parames'</span><span class="token punctuation">,</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token comment">// 让键值对的键相对应</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">let</span> <span class="token punctuation">{</span>show<span class="token punctuation">,</span>data<span class="token punctuation">}</span> <span class="token operator">=</span> res
				<span class="token keyword">this</span><span class="token punctuation">.</span>paramedata <span class="token operator">=</span> data
				<span class="token keyword">this</span><span class="token punctuation">.</span>couponif <span class="token operator">=</span> show
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token comment">// 隐藏该组件</span>
			<span class="token function">hideCou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>couponif <span class="token operator">=</span> <span class="token boolean">false</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>parame<span class="token operator">-</span>view<span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>rpx<span class="token punctuation">;</span> 
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span> 
	border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">1</span>px solid #<span class="token constant">F0F0F0</span><span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> flex<span class="token operator">-</span>start<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">25</span>rpx <span class="token number">15</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>parame<span class="token operator">-</span>left<span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>parame<span class="token operator">-</span>right<span class="token punctuation">{</span>
	flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="获取商品评价数据"><a href="#获取商品评价数据" class="headerlink" title="获取商品评价数据"></a>获取商品评价数据</h4><p>在<strong>pages/details/sonzhujian下新建evaluate.vue</strong></p>
<p>接着在<strong>details.vue引入evaluate.vue，</strong>引入css样式</p>
<p>在添加请求商品评价数据的方法，通过ref传递给子组件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品评价 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>evaluate <span class="token operator">:</span>comment<span class="token operator">=</span><span class="token string">"comment"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>evaluate<span class="token operator">&gt;</span>

<span class="token comment">// 请求数据方法</span>
<span class="token keyword">async</span> <span class="token function">detRequest</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 商品评价的数据</span>
	<span class="token keyword">let</span> wxcommnt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>wxcommnturl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token comment">// 因为后期需要发起多次请求,用promise.all做一个并发请求</span>
		<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>introduce<span class="token punctuation">,</span>wxcommnt<span class="token punctuation">]</span><span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 拿到评价数据</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>comment <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>子组件evaluate.vue代码如下</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 当返回的评价数据大于<span class="token number">0</span>条才展示此组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"evaluate-view"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"comment[0].commlen &gt; 0"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 第一排 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"evaluate-top"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token function">商品评价</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">{</span>comment<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>commlen<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"evaluate-rig"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>查看全部<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/quanbu.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 评论的标签  <span class="token operator">--</span><span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果评价标签数据数组的长度大于<span class="token number">0</span>才展示数据 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"evaluate-class"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"comment[0].commtag.length &gt; 0"</span><span class="token operator">&gt;</span>	
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in comment[0].commtag"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>label<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>num<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 评价内容 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"evaluate-User"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in comment[0].parcontent"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"USering"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.avatarUrl"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>nickName<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"USering-text"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"USering-time"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>time<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>颜色<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>尺码<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>size<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		 	<span class="token comment">// 接收父组件的数据</span>
		props<span class="token operator">:</span> <span class="token punctuation">{</span>
			comment<span class="token operator">:</span>Array
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span>view<span class="token punctuation">{</span>background<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span>top<span class="token punctuation">{</span>font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token comment">/* background: #4CD964; */</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span>rig image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">27</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">27</span>upx<span class="token punctuation">;</span>
padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span>rig<span class="token punctuation">{</span>display<span class="token operator">:</span> flex<span class="token punctuation">;</span> align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token comment">/* 分类 */</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span><span class="token keyword">class</span><span class="token punctuation">{</span>font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span> display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
margin<span class="token operator">:</span> <span class="token number">15</span>upx <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span><span class="token keyword">class</span> <span class="token class-name">text</span><span class="token punctuation">{</span>background<span class="token operator">:</span> #feecea<span class="token punctuation">;</span>
border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">15</span>upx<span class="token punctuation">;</span>
margin<span class="token operator">:</span> <span class="token number">0</span>upx <span class="token number">14</span>upx <span class="token number">14</span>upx <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 用户评价 */</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span>User<span class="token punctuation">{</span>font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span> color<span class="token operator">:</span> #<span class="token number">999999</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span>User image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">50</span>upx <span class="token operator">!</span>important<span class="token punctuation">;</span>
border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>USering<span class="token punctuation">{</span>height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span> 
<span class="token comment">/* background: #007AFF; */</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>USering text<span class="token punctuation">{</span>padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>USering<span class="token operator">-</span>text<span class="token punctuation">{</span>color<span class="token operator">:</span> #<span class="token number">333333</span><span class="token punctuation">;</span>
line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">40</span>upx<span class="token punctuation">;</span>
overflow<span class="token operator">:</span> hidden<span class="token punctuation">;</span>
text<span class="token operator">-</span>overflow<span class="token operator">:</span> ellipsis<span class="token punctuation">;</span>
display<span class="token operator">:</span> <span class="token operator">-</span>webkit<span class="token operator">-</span>box<span class="token punctuation">;</span>
<span class="token operator">-</span>webkit<span class="token operator">-</span>line<span class="token operator">-</span>clamp<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>  <span class="token comment">// 控制多行的行数</span>
<span class="token operator">-</span>webkit<span class="token operator">-</span>box<span class="token operator">-</span>orient<span class="token operator">:</span> vertical<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>USering<span class="token operator">-</span>time<span class="token punctuation">{</span>display<span class="token operator">:</span> flex<span class="token punctuation">;</span> align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>USering<span class="token operator">-</span>time text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="请求商品详情图片介绍数据"><a href="#请求商品详情图片介绍数据" class="headerlink" title="请求商品详情图片介绍数据"></a>请求商品详情图片介绍数据</h4><p>数据在datails中已经取到，是priceetc:{} 数据里</p>
<p>在<strong>pages/details/sonzhujian下新建produce.vue</strong>，在父组件引入</p>
<p>同时父组件将priceetc通过ref传递给<strong>produce.vue</strong></p>
<p>其中图片是应该点击能够预览，可以使用之前封装的 <strong>logic.js</strong></p>
<pre><code>// 预览图片 node导入模式
const { Login } = require('../../public/logic.js')</code></pre>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Product-view"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in priceetc.Detaileddrawing"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> @click<span class="token operator">=</span><span class="token string">"previmg(index,priceetc.Detaileddrawing)"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token comment">// 预览图片 node导入模式</span>
	<span class="token keyword">const</span> <span class="token punctuation">{</span> Login <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../../public/logic.js'</span><span class="token punctuation">)</span>
	
	<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
		props<span class="token operator">:</span><span class="token punctuation">{</span>priceetc<span class="token operator">:</span>Object<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token comment">// 参数1 --当前图片下标     参数2 --图片地址(所有图片的数组)</span>
			<span class="token function">previmg</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>imgArray</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>imgArray<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">previewImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
	<span class="token punctuation">.</span>Product<span class="token operator">-</span>view<span class="token punctuation">{</span>margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span> padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token punctuation">.</span>Product<span class="token operator">-</span>view image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span> vertical<span class="token operator">-</span>align<span class="token operator">:</span> bottom<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="商品所有的评价"><a href="#商品所有的评价" class="headerlink" title="商品所有的评价"></a>商品所有的评价</h4><p>在pages下<strong>新建comments文件夹</strong>，同时在其下 <strong>新建comments.vue,</strong></p>
<p>为了便于观察，可以在page.json中先将comments.vue,放到第一位</p>
<p>开始写comments.vue组件内容</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 评价分类的标签 <span class="token operator">--</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果评价标签的数据长度大于<span class="token number">0</span><span class="token punctuation">,</span>就表示有数据<span class="token punctuation">,</span>才显示标签 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"evaluate-class"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"labeldata.length &gt; 0"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item, index) in labeldata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果评价标签数据中的num值为空代表是<span class="token string">'全部'</span>标签<span class="token punctuation">,</span>就不展条数 <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"item.num == ''"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>label <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>label <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>num <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 完整的评价内容 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in commdata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-user"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-top comments-flex"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.avatarUrl"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 用户头像 <span class="token operator">--</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>nickName<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>						  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 用户昵称 <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-zh comments-flex"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>time<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>颜色分类<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>尺码<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>size<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-mes"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果 item<span class="token punctuation">.</span>isimg 中有数据<span class="token punctuation">,</span>就显示图片 <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-img"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"item.isimg"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(items,indexs) in item.image"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"indexs"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 评论图片   有没有数据 取决于isimg的布尔值 <span class="token operator">--</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"user-images"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"items"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span> 	
					<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			<span class="token comment">// 选中第几个</span>
			labeldata<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			commdata<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token keyword">async</span> <span class="token function">reqComm</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">let</span> comtag <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>comtagurl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//评价分类标签数据</span>
			<span class="token keyword">let</span> comtconent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>comtconenturl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">'&amp;label='</span> <span class="token operator">+</span> <span class="token string">'全部'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//评价的内容数据</span>
			<span class="token keyword">try</span> <span class="token punctuation">{</span>
				<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>comtag<span class="token punctuation">,</span> comtconent<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token comment">// 标签数据</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>labeldata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
				<span class="token comment">// 评价数据</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reqComm</span><span class="token punctuation">(</span><span class="token string">'5f8bbf2823954733542169a1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>view <span class="token punctuation">{</span>
	margin<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 分类 */</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span><span class="token keyword">class</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">1</span>px solid #eeeeee<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span><span class="token keyword">class</span> <span class="token class-name">text</span> <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #feecea<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">15</span>upx<span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">0</span>upx <span class="token number">14</span>upx <span class="token number">14</span>upx <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 选中*/</span>
<span class="token punctuation">.</span>actives <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #ff0036 <span class="token operator">!</span>important<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #fff <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* user评价 */</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>user <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">15</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">1</span>px solid #eeeeee<span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">25</span>upx <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>flex <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>top image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">60</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">60</span>upx <span class="token operator">!</span>important<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>top text <span class="token punctuation">{</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>zh <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">80</span>upx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #a7a7a7<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>zh text <span class="token punctuation">{</span>
	padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">8</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>mes <span class="token punctuation">{</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">1.5</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>top <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">60</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>img <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>user<span class="token operator">-</span>images <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">33.33</span><span class="token operator">%</span> <span class="token operator">-</span> <span class="token number">10</span>rpx <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">200</span>rpx<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>user<span class="token operator">-</span>images image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">200</span>rpx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">2</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="完成商品分类查询评价"><a href="#完成商品分类查询评价" class="headerlink" title="完成商品分类查询评价"></a>完成商品分类查询评价</h4><p>先完成图片预览功能</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"items"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span> @click<span class="token operator">=</span><span class="token string">"preTmage(indexs,item.image)"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>

<span class="token comment">// 预览图片 node导入模式</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Login <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../public/logic.js'</span><span class="token punctuation">)</span>

<span class="token comment">// 阅览图片方法</span>
<span class="token function">preTmage</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>imgArray</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>imgArray<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">previewImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后完成点击标签变色，且展示相关评论功能，</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 评价分类的标签 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果评价标签的数据长度大于<span class="token number">0</span><span class="token punctuation">,</span>就表示有数据<span class="token punctuation">,</span>才显示标签 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"evaluate-class"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"labeldata.length &gt; 0"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item, index) in labeldata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果评价标签数据中的num值为空代表是<span class="token string">'全部'</span>标签<span class="token punctuation">,</span>就不展示条数 <span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 添加动态的<span class="token keyword">class</span> 当num等于下标值时触发<span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"item.num == ''"</span> <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{ actives: num == index }"</span> @click<span class="token operator">=</span><span class="token string">"labelFun(item.commid,item.label,index)"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>label <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text v<span class="token operator">-</span><span class="token keyword">else</span> <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{ actives: num == index }"</span> @click<span class="token operator">=</span><span class="token string">"labelFun(item.commid,item.label,index)"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>label <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>num <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 完整的评价内容 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item, index) in commdata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-user"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-top comments-flex"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.avatarUrl"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 用户头像 <span class="token operator">--</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>nickName <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 用户昵称 <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-zh comments-flex"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>time <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>颜色分类<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>color <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>尺码<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>size <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-mes"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>text <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果 item<span class="token punctuation">.</span>isimg 中有数据<span class="token punctuation">,</span>就显示图片 <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comments-img"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"item.isimg"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(items, indexs) in item.image"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"indexs"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 评论图片   有没有数据 取决于isimg的布尔值 <span class="token operator">--</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"user-images"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"items"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span> @click<span class="token operator">=</span><span class="token string">"preTmage(indexs, item.image)"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token comment">// 预览图片 node导入模式</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Login <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../public/logic.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			<span class="token comment">// 选中第几个</span>
			num<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
			labeldata<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 	<span class="token comment">// 标签数据</span>
			commdata<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>	<span class="token comment">// 评价数据</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token keyword">async</span> <span class="token function">reqComm</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">let</span> comtag <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>comtagurl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//评价分类标签数据</span>
			<span class="token keyword">let</span> comtconent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>comtconenturl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">'&amp;label='</span> <span class="token operator">+</span> <span class="token string">'全部'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//评价的内容数据</span>
			<span class="token keyword">try</span> <span class="token punctuation">{</span>
				<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>comtag<span class="token punctuation">,</span> comtconent<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token comment">// 标签数据</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>labeldata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
				<span class="token comment">// 评价数据</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 预览览图片方法</span>
		<span class="token function">preTmage</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> imgArray</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> imgArray<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">previewImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		
		<span class="token comment">// 点击标签切换的方法</span>
		<span class="token keyword">async</span> <span class="token function">labelFun</span><span class="token punctuation">(</span><span class="token parameter">commid<span class="token punctuation">,</span>label<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> index
				<span class="token comment">// 请求分类标签的接口</span>
				<span class="token keyword">let</span> comtconent1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>comtconenturl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> commid <span class="token operator">+</span> <span class="token string">'&amp;label='</span> <span class="token operator">+</span> label<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
				<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> comtconent1<span class="token punctuation">.</span>data
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// onLoad生命周期可以接收上个页面过来的值  e就包含接收的数据</span>
	<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reqComm</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>view <span class="token punctuation">{</span>
	margin<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 分类 */</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span><span class="token keyword">class</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">1</span>px solid #eeeeee<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>evaluate<span class="token operator">-</span><span class="token keyword">class</span> <span class="token class-name">text</span> <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #feecea<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">15</span>upx<span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">0</span>upx <span class="token number">14</span>upx <span class="token number">14</span>upx <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 选中*/</span>
<span class="token punctuation">.</span>actives <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #ff0036 <span class="token operator">!</span>important<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #fff <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* user评价 */</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>user <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">15</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">1</span>px solid #eeeeee<span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">25</span>upx <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>flex <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>top image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">60</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">60</span>upx <span class="token operator">!</span>important<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>top text <span class="token punctuation">{</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>zh <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">80</span>upx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #a7a7a7<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>zh text <span class="token punctuation">{</span>
	padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">8</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>mes <span class="token punctuation">{</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">1.5</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>top <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">60</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>comments<span class="token operator">-</span>img <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>user<span class="token operator">-</span>images <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">33.33</span><span class="token operator">%</span> <span class="token operator">-</span> <span class="token number">10</span>rpx <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">200</span>rpx<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>user<span class="token operator">-</span>images image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">200</span>rpx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">2</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>最后完成点击evaluate.vue组件的查看全部，携带id跳转到当前商品的评价页面功能</p>
<p>先给evaluate添加点击事件并且拿到评价数据中携带的商品id，然后使用uni.navigateTo跳转到comments页面</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"evaluate-rig"</span> @click<span class="token operator">=</span><span class="token string">"commEnts(comment[0].parcontent[0].commid)"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>查看全部<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/quanbu.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 跳转到评论详情</span>
<span class="token function">commEnts</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		url<span class="token operator">:</span><span class="token string">'../comments/comments?id='</span> <span class="token operator">+</span> id
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>comments组件接收值，然后调用请求接口的方法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// onLoad生命周期可以接收上个页面过来的值  e就包含接收的数据</span>
<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reqComm</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="锚点链接将页面滚动到目标位置"><a href="#锚点链接将页面滚动到目标位置" class="headerlink" title="锚点链接将页面滚动到目标位置"></a>锚点链接将页面滚动到目标位置</h4><p><strong>uni.pageScrollTo(OBJECT)</strong>  –将页面滚动到目标位置</p>
<p>在top.vue文件中，通过$parent调用父组件的方法，同时传递参数index过去</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">methods<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 控制短横线跳转位置</span>
	<span class="token function">navbtn</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> index
		<span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 跳转到页面顶部</span>
			uni<span class="token punctuation">.</span><span class="token function">pageScrollTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				scrollTop<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
				duration<span class="token operator">:</span><span class="token number">300</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span><span class="token function">fathEr</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>父组件中给节点添加 class属性，即可使用uni.pageScrollTo的方法去跳转到该节点</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品评价 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>evaluate <span class="token operator">:</span>comment<span class="token operator">=</span><span class="token string">"comment"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"evaluate"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>evaluate<span class="token operator">&gt;</span>
		
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>product <span class="token operator">:</span>priceetc<span class="token operator">=</span><span class="token string">"priceetc"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"produce"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>product<span class="token operator">&gt;</span>

<span class="token comment">// 被 子组件top 用来锚点链接</span>
<span class="token function">fathEr</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> clsdata <span class="token operator">=</span> index <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string">'.evaluate'</span> <span class="token operator">:</span> <span class="token string">'.produce'</span>
	uni<span class="token punctuation">.</span><span class="token function">pageScrollTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		selector<span class="token operator">:</span>clsdata<span class="token punctuation">,</span>
		duration<span class="token operator">:</span><span class="token number">300</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>此时发现因为之前固定了导航栏，所以滑动到评价或者详情区域，被胶囊按钮的高度和它到顶部的距离之和盖住了一部分</p>
<p>如下代码导致：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 子组件 tab <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>组件 默认不显示出来 同时透明度值默认是<span class="token number">0</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"header-fixed backyes"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"!showAbs"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"{opacity:styleObject}"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 放置一个div 撑开到顶部距离 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"status_bar"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"'height: '+ tophight.top + 'px;'"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 引用子组件   且给子组件传递 tophight 子组件里设置高度<span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>top <span class="token operator">:</span>tophight<span class="token operator">=</span><span class="token string">"tophight"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>top<span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>解决方法：减去顶部被盖住的距离</p>
<p><strong>思路：不使用uniapp的方法，使用微信小程序的一个方法</strong></p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/wxml/SelectorQuery.html">SelectorQuery</a> wx.createSelectorQuery()</p>
<p>功能描述：</p>
<p>返回一个 SelectorQuery 对象实例。在自定义组件或包含自定义组件的页面中，应使用 <code>this.createSelectorQuery()</code> 来代替。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> query <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">createSelectorQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'#the-id'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">boundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
query<span class="token punctuation">.</span><span class="token function">selectViewport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scrollOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>top       <span class="token comment">// #the-id节点的上边界坐标</span>
  res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>scrollTop <span class="token comment">// 显示区域的竖直滚动位置</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 被子组件top 用来锚点链接</span>
<span class="token function">fathEr</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span> clsdata <span class="token operator">=</span> index <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string">'.evaluate'</span> <span class="token operator">:</span> <span class="token string">'.produce'</span><span class="token punctuation">;</span>
	<span class="token keyword">let</span> he <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tophight<span class="token punctuation">.</span>top <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tophight<span class="token punctuation">.</span>height<span class="token punctuation">;</span> <span class="token comment">//胶囊按钮到顶部距离 + 自身高度</span>
	<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createSelectorQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>clsdata<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">boundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	query<span class="token punctuation">.</span><span class="token function">selectViewport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scrollOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token comment">// res[0].top       // clsdata节点到上边界的距离 		节点的上边界坐标</span>
		<span class="token comment">// res[1].scrollTop // 往下滑动屏幕后,到节点的距离   显示区域的竖直滚动位置</span>
		<span class="token comment">// 跳转</span>
		uni<span class="token punctuation">.</span><span class="token function">pageScrollTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			scrollTop<span class="token operator">:</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>top <span class="token operator">+</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>scrollTop <span class="token operator">-</span> he<span class="token punctuation">,</span>
			duration<span class="token operator">:</span> <span class="token number">300</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>添加功能：当和滑动到目标位置时，顶部的导航栏自动选中对应的tab</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/*
* 定义mutations事件类型：函数名称port const ADDCOUNT = </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h4 id="商品详情页下方的功能组件"><a href="#商品详情页下方的功能组件" class="headerlink" title="商品详情页下方的功能组件"></a>商品详情页下方的功能组件</h4><p>pages/details/sonzhujian/新建shopping.vue</p>
<p><strong>静态布局如下：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopping-view"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopping-text"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/fenxiang.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>分享<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopping-text middle"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/gouwuche.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>购物车<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token number">10</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 未收藏 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopping-text"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/shoucang.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>收藏<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 已收藏 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopping-text"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/yishoucang.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>已收藏<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"join join-right"</span><span class="token operator">&gt;</span>加入购物车<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"join join-left"</span><span class="token operator">&gt;</span>立即购买<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 登录弹窗 <span class="token operator">--</span><span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>shopping<span class="token operator">-</span>view image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">35</span>rpx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">35</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopping<span class="token operator">-</span>view <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
	border<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">1</span>rpx solid #cccccc<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
	bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>join <span class="token punctuation">{</span>
	flex<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">80</span>upx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">80</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> white<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopping<span class="token operator">-</span>text <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
	flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopping<span class="token operator">-</span>text text <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">23</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">5</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">666666</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>join<span class="token operator">-</span>right <span class="token punctuation">{</span>
	background<span class="token operator">:</span> linear<span class="token operator">-</span><span class="token function">gradient</span><span class="token punctuation">(</span>to right<span class="token punctuation">,</span> #ffc800 <span class="token number">10</span><span class="token operator">%</span><span class="token punctuation">,</span> #ff9602 <span class="token number">80</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	border<span class="token operator">-</span>top<span class="token operator">-</span>left<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>bottom<span class="token operator">-</span>left<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>join<span class="token operator">-</span>left <span class="token punctuation">{</span>
	background<span class="token operator">:</span> linear<span class="token operator">-</span><span class="token function">gradient</span><span class="token punctuation">(</span>to right<span class="token punctuation">,</span> #ff7500 <span class="token number">10</span><span class="token operator">%</span><span class="token punctuation">,</span> #ff4b00 <span class="token number">80</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	border<span class="token operator">-</span>top<span class="token operator">-</span>right<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>bottom<span class="token operator">-</span>right<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	margin<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>middle <span class="token punctuation">{</span>
	border<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">1</span>rpx solid #f4f4f4<span class="token punctuation">;</span>
	border<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">1</span>rpx solid #f4f4f4<span class="token punctuation">;</span>
	position<span class="token operator">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>middle text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">3</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">16</span>upx<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #fe0036<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">!</span>important<span class="token punctuation">;</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	position<span class="token operator">:</span> absolute<span class="token punctuation">;</span>
	top<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
	right<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="收藏和取消收藏功能"><a href="#收藏和取消收藏功能" class="headerlink" title="收藏和取消收藏功能"></a>收藏和取消收藏功能</h5><p>点击收藏后，发起请求</p>
<p>所以这个接口是有权限的，因为一般收藏需要用户<strong>登录了才能操作</strong>，收藏只属于自己，不属于别人。（权限接口，需携带token）</p>
<p>根据请求的返回值，来显示或者隐藏 组件</p>
<p>在<strong>shopping组件</strong>中要写俩对应不同的图标情况</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 未收藏 <span class="token operator">--</span><span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 根据接口文档 id为<span class="token number">1</span> 是收藏 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopping-text"</span> @click<span class="token operator">=</span><span class="token string">"collEct(1)"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"collects == 0"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/shoucang.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>收藏<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 已收藏 <span class="token operator">--</span><span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 根据接口文档 id为<span class="token number">2</span> 是取消收藏 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopping-text"</span> @click<span class="token operator">=</span><span class="token string">"collEct(0)"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"collects == 1"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/yishoucang.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>已收藏<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在<strong>details.vue</strong>中拿到商品id</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 商品id</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>goodid <span class="token operator">=</span> mendata<span class="token punctuation">.</span>id

通过ref传递给子组件
props<span class="token operator">:</span><span class="token punctuation">{</span>
	goodid<span class="token operator">:</span>String<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 未收藏 <span class="token operator">--</span><span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 子组件将接收到的goodid 当作第二个data参数填入 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopping-text"</span> @click<span class="token operator">=</span><span class="token string">"collEct(1,goodid)"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"collects == 0"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/shoucang.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>收藏<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 已收藏 <span class="token operator">--</span><span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 根据接口文档 id为<span class="token number">2</span> 是取消收藏 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopping-text"</span> @click<span class="token operator">=</span><span class="token string">"collEct(0,goodid)"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"collects == 1"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/yishoucang.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>已收藏<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在点击事件中发起<strong>post请求</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">methods<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 收藏和取消收藏</span>
	<span class="token keyword">async</span> <span class="token function">collEct</span><span class="token punctuation">(</span><span class="token parameter">num<span class="token punctuation">,</span>id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> num<span class="token operator">:</span>num<span class="token punctuation">,</span>id<span class="token operator">:</span>id <span class="token punctuation">}</span>  <span class="token comment">// 等于 { num,id }</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
								<span class="token comment">// this.Urls.m().enshrineurl 代表url , data 代表携带的参数 data</span>
			<span class="token keyword">let</span> enshrine <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>enshrineurl<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>enshrine<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">let</span> <span class="token punctuation">{</span> errrcode <span class="token punctuation">}</span> <span class="token operator">=</span> enshrine<span class="token punctuation">.</span>msg
			<span class="token keyword">if</span><span class="token punctuation">(</span>errrcode <span class="token operator">==</span> <span class="token string">'401'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 要登录</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
				
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">{</span>
			
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>此时<strong>点击收藏会返回401，没有权限，即没有登录的时候，后端不知道是谁在操作收藏会阻止。</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/*
* 定义mutations事件类型：函数名称port const ADDCOUNT = </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h5 id="登录弹窗以及微信小程序登录"><a href="#登录弹窗以及微信小程序登录" class="headerlink" title="登录弹窗以及微信小程序登录"></a>登录弹窗以及微信小程序登录</h5><p>当点击收藏后，弹出登录弹窗，登陆后刷新页面</p>
<h6 id="登录弹窗"><a href="#登录弹窗" class="headerlink" title="登录弹窗"></a>登录弹窗</h6><p>功能在很多页面都要用到，因此抽出做一个公用的组件</p>
<p>在pages/commponents/新建showmodal.vue,并<strong>注册到main.js</strong>，同时在shopping组件中引入showmodal组件</p>
<p><strong>showmodal.vue 布局如下：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"showmodel anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"modeling"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"showmodel-view"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"showmodel-tips"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>请登录后在操作<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"showmodel-button"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>button plain<span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
													<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 小程序中只有button触发登录 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>button plain<span class="token operator">=</span><span class="token string">"true"</span> open<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">"getUserInfo"</span> @click<span class="token operator">=</span><span class="token string">"getUserInfo()"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				<span class="token comment">// 默认隐藏的数据</span>
				modeling<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>modeling <span class="token operator">=</span> <span class="token boolean">true</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>showmodel<span class="token punctuation">{</span>
	background<span class="token operator">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
	left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">999</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>showmodel<span class="token operator">-</span>view<span class="token punctuation">{</span>
	background<span class="token operator">:</span> white<span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">90</span>rpx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">280</span>rpx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">20</span>rpx<span class="token punctuation">;</span>
	position<span class="token operator">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>showmodel<span class="token operator">-</span>tips<span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">190</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>showmodel<span class="token operator">-</span>tips text<span class="token punctuation">{</span>display<span class="token operator">:</span> block<span class="token punctuation">;</span> text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span> font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">32</span>rpx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>showmodel<span class="token operator">-</span>button<span class="token punctuation">{</span>
	border<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">0.5</span>rpx solid #<span class="token constant">FEECEA</span><span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span> justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	position<span class="token operator">:</span> absolute<span class="token punctuation">;</span>
	bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>showmodel<span class="token operator">-</span>button button<span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">32</span>rpx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
	border<span class="token operator">:</span> none<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">!</span>important<span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> inherit<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>showmodel<span class="token operator">-</span>button button<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>border<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">0.5</span>rpx solid #<span class="token constant">FEECEA</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>showmodel<span class="token operator">-</span>button button<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>color<span class="token operator">:</span> #ff6699<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后 注册到main.js</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 注册到main.js</span>
<span class="token comment">// 引入登录弹窗组件</span>
<span class="token keyword">import</span> showmodal <span class="token keyword">from</span> <span class="token string">'pages/commponents/showmodal.vue'</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'showmodal'</span><span class="token punctuation">,</span>showmodal<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//在 shopping组件中引入showmodal组件</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 使用 全局引入的登录弹窗 组件<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>showmodal<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>showmodal<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<p><strong>showmodal.vue中，默认隐藏组件</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"showmodel anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"modeling"</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>当有登录请求的时候显示</strong>，即当点击 shopping组件中收藏时，后端返回401检测到没有登录时候，在shopping组件中去操控子组件showmodal的v-if属性</p>
<p>思路：<strong>父子组件传值，refs</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 使用 全局引入的登录弹窗 组件<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>showmodal ref<span class="token operator">=</span><span class="token string">"show"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>showmodal<span class="token operator">&gt;</span>

<span class="token comment">// 请求的时候如果返回值是401 就展示弹窗组件 （通过ref调用子组件里的方法）</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>errcode <span class="token operator">==</span> <span class="token string">'401'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 要登录</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>show<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
	
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h6 id="登录逻辑"><a href="#登录逻辑" class="headerlink" title="登录逻辑"></a><strong>登录逻辑</strong></h6><p>思路：</p>
<p>封装发起登录的请求方法：</p>
<p><strong>新建login/login.js</strong></p>
<ol>
<li><p><strong>引入请求接口、请求方法、弹框类</strong></p>
</li>
<li><p>新建wxLogin类， 接收俩参数，user和msg，在类中封装wxlogin( )方法 和 loGin( )方法</p>
</li>
<li><p>wxlogin方法获取登录请求要携带的五个参数：</p>
<p>1）首先将user对象 解构出微信头像、微信昵称。</p>
<p>2）然后返回一个promise实例对象，执行 **wx.login(Object object)**，调用接口获取登录凭证（code）。通过凭证进而换取用户登录态信息，包括用户在当前小程序的唯一标识（openid）、微信开放平台帐号下的唯一标识（unionid，若当前小程序已绑定到微信开放平台帐号）及本次登录的会话密钥（session_key）等。用户数据的加解密通讯需要依赖会话密钥完成。</p>
<p>将五个数据赋值给了data中，<strong>返回的成功值取到data 将会return出去</strong></p>
</li>
<li><p>loGin( )方法中：</p>
<p>1）首先判断constructor构造函数的第二个参数msg，是否值为”getUserProfile:ok”，如果不是就抛出错误(‘登录失败’)， <strong>//抛出错误,阻止代码允许</strong></p>
<p>2）接着获取code，即调用wxlogin()方法结果赋值给userdata，此时userdata包含了所有的参数，记得添加await和async拿到返回值</p>
<p>3）然后再try，catch中调用后台的微信接口返回结果给user，添加刚才得到的userdata作为请求的data参数</p>
<p>4）判断user中msg值是否为 SUCCESS，如果是就 执行 **uni.setStorageSync(KEY,DATA) **</p>
<p>将 data 存储在本地缓存中指定的 key 中，会覆盖掉原来该 key 对应的内容，这是一个同步接口。</p>
<p><strong>//即存储用户信息到本地缓存</strong></p>
</li>
</ol>
<p>​        5）然后调用 弹窗 中的showtoast方法，显示登录成功</p>
<p>​        6）最后返回 <strong>return(‘SUCCESS’)</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 微信登录</span>
<span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">'../api/api.js'</span> 	<span class="token comment">// 引入请求接口</span>
<span class="token keyword">import</span> urls <span class="token keyword">from</span> <span class="token string">'../api/request.js'</span>	<span class="token comment">// 引入请求方法		</span>
<span class="token keyword">import</span> toast <span class="token keyword">from</span> <span class="token string">'../public/toast.js'</span>	<span class="token comment">// 引入弹框类</span>

<span class="token keyword">class</span> <span class="token class-name">wxLogin</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">user<span class="token punctuation">,</span>msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> user
		<span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 调用接口登录,async其实是返回一个promise</span>
	<span class="token keyword">async</span> <span class="token function">loGin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 拒绝登录 即登陆失败</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">!==</span> <span class="token string">"getUserInfo:ok"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'拒绝登录'</span><span class="token punctuation">)</span>
			<span class="token keyword">throw</span> <span class="token punctuation">(</span><span class="token string">'登录失败'</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span> 
		<span class="token comment">// 获取code</span>
		<span class="token keyword">let</span> userdata <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wxlogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">request</span><span class="token punctuation">(</span>urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>wxloginurl<span class="token punctuation">,</span>userdata<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				uni<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'wxuser'</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//存储用户信息到本地缓存</span>
				<span class="token keyword">new</span> <span class="token class-name">toast</span><span class="token punctuation">(</span><span class="token string">'登录成功'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token keyword">return</span><span class="token punctuation">(</span><span class="token string">'SUCCESS'</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> e
			<span class="token comment">// 500,501,502,</span>
			<span class="token comment">//TODO handle the exception</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 获取code</span>
	<span class="token function">wxlogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> <span class="token punctuation">{</span>avatarUrl<span class="token punctuation">,</span>nickName<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>user
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token comment">//wx404e88f75f32c85b</span>
						appid<span class="token operator">:</span><span class="token string">'wx404e88f75f32c85b'</span><span class="token punctuation">,</span>
						secret<span class="token operator">:</span><span class="token string">'0402d0b4b834bf9449b2477115a2e25f'</span><span class="token punctuation">,</span>
						nickName<span class="token punctuation">,</span>
						avatarUrl<span class="token punctuation">,</span>
						code<span class="token operator">:</span>res<span class="token punctuation">.</span>code
					<span class="token punctuation">}</span>
					<span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'登录失败'</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> wxLogin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h6 id="收藏按钮逻辑"><a href="#收藏按钮逻辑" class="headerlink" title="收藏按钮逻辑"></a>收藏按钮逻辑</h6><p><strong>点击收藏按钮后 getUserInfo() 执行思路：</strong></p>
<ol>
<li><p>点击确定 会隐藏 showmodel组件</p>
</li>
<li><p>实例化 <strong>Toast</strong> 类，并传递 title值，同时实例调用 **showloading()**方法，内部 **uni.showLoading **方法生效即显示loading提示框，展示提示文字title值，并且使用mask显示透明蒙层防止触摸穿透</p>
</li>
<li><p>获取用户信息 –<strong>wx.getUserProfile</strong>，获取用户头像昵称等。当点击拒绝，可以在err回调中查看errMsg，当点击允许后调用res回调，回调中res能够拿到err数据中的包含用户头像和昵称的信息<strong>userInfo</strong>和 代表成功值的<strong>errMsg信息</strong>，</p>
</li>
<li><p>然后调用<strong>wxusEr（）</strong>，即调用前边写在<strong>login.js</strong>里的登录请求方法，成功后存储用户头像、昵称和token值到本地，然后调用其他弹窗组件**showtoast()**，显示登录成功后自动隐藏。</p>
</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 登录</span>
<span class="token keyword">async</span> <span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>modeling <span class="token operator">=</span> <span class="token boolean">false</span>
		<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'登录中'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token comment">/*wx.getUserProfile 获取用户信息。页面产生点击事件后才可调用，每次请求都会弹出授权窗口，用户同意后返回userInfo。该接口用于替换 wx.getUserInfo， */</span>
		wx<span class="token punctuation">.</span><span class="token function">getUserProfile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				desc<span class="token operator">:</span> <span class="token string">'登录'</span> <span class="token comment">//声明获取用户个人信息后的用途，不超过30个字符</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            	
				<span class="token keyword">let</span> <span class="token punctuation">{</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">}</span> <span class="token operator">=</span> res
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wxusEr</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'拒绝登录或登录失败'</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 调用登录</span>
<span class="token keyword">async</span> <span class="token function">wxusEr</span><span class="token punctuation">(</span><span class="token parameter">userInfo<span class="token punctuation">,</span>errMsg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">wxLogin</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loGin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'coll'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">// 更新收藏状态</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'collict'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>colldata<span class="token operator">:</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">//TODO handle the exception</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="封装消息提示框"><a href="#封装消息提示框" class="headerlink" title="封装消息提示框"></a>封装消息提示框</h5><p>微信弹窗已经弃用</p>
<p>现在准备一个登录时候的弹窗反馈：使用微信小程序（uni）自带的uni.showToast</p>
<p><strong>新建public/toast.js</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 一些弹窗</span>
<span class="token keyword">class</span> <span class="token class-name">Toast</span><span class="token punctuation">{</span>
	<span class="token comment">// title		String		提示的内容，长度与 icon 取值有关</span>
	<span class="token comment">// icon			String		图标</span>
	<span class="token comment">// duration		Number		提示的延迟时间，单位毫秒，默认：1500</span>
	<span class="token comment">// mask			Boolean		是否显示透明蒙层，防止触摸穿透，默认：false</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">title<span class="token punctuation">,</span>icon<span class="token punctuation">,</span>duration<span class="token operator">=</span><span class="token number">1300</span><span class="token punctuation">,</span>mask<span class="token operator">=</span><span class="token boolean">true</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	    <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title
		<span class="token keyword">this</span><span class="token punctuation">.</span>icon <span class="token operator">=</span> icon
		<span class="token keyword">this</span><span class="token punctuation">.</span>duration <span class="token operator">=</span> duration
		<span class="token keyword">this</span><span class="token punctuation">.</span>mask <span class="token operator">=</span> mask
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 消息提示框：自动消失</span>
	<span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		uni<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		    title<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span>
			icon<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>icon<span class="token punctuation">,</span>
		    duration<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>duration<span class="token punctuation">,</span>
			mask<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>mask
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	
	<span class="token comment">// 消息提示框：手动消失</span>
	<span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">//  uni.showLoading  显示 loading 提示框, 需主动调用 uni.hideLoading 才能关闭提示框。</span>
		uni<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		    title<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span>
			mask<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>mask
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Toast<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>main.js引入</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// toast弹窗</span>
<span class="token keyword">import</span> toast <span class="token keyword">from</span> <span class="token string">'./public/toast.js'</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$Toast <span class="token operator">=</span> toast<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h5 id="携带token令牌登录小程序"><a href="#携带token令牌登录小程序" class="headerlink" title="携带token令牌登录小程序"></a>携带token令牌登录小程序</h5><p>使用 <strong>js-base64加密token</strong>，下载 js-base.js到本地的api下，</p>
<p>在login.js中引入加密方法，取出本地存储的token进行加密，然后将token放置在header中</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// request 该文件封装了请求方法</span>
<span class="token comment">// 引入js-base.js</span>
<span class="token keyword">let</span> Base64 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./base64'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Base64

<span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token punctuation">{</span>

	<span class="token comment">// 参数url是request.js暴露出的url </span>
	<span class="token comment">// 参数data是post请求传递的值</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>arg <span class="token operator">=</span> arg<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 封装 post请求</span>
	<span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			uni<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				url<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">,</span>
				method<span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
				data<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>arg<span class="token punctuation">,</span>
				header<span class="token operator">:</span> <span class="token punctuation">{</span>
					Authorization<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">baseFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'出错了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 封装 get请求</span>
	<span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			uni<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
					url<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">,</span>
					method<span class="token operator">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
					header<span class="token operator">:</span> <span class="token punctuation">{</span>
						Authorization<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">baseFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token comment">// 输出成功的值</span>
					<span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token comment">// 失败的原因/提示</span>
					<span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'出错了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 加密token 方法</span>
	<span class="token function">baseFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> token <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token string">'wxuser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>token <span class="token comment">//取出token</span>
		<span class="token keyword">const</span> base64 <span class="token operator">=</span> Base64<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>token <span class="token operator">+</span> <span class="token string">':'</span><span class="token punctuation">)</span> <span class="token comment">//使用base里的方法</span>
		<span class="token keyword">return</span> <span class="token string">'Basic '</span> <span class="token operator">+</span> base64

	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> request<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>当请求携带了token后，shopping.vue中</strong></p>
<p>let <strong>enshrine</strong> = await new this.Request(this.Urls.m().enshrineurl,data).modepost();</p>
<p><strong>enshrine就能返回带有</strong>：</p>
<p><strong>成功的200 状态码 errcodes</strong></p>
<p><strong>表示收藏与否的数值 1或者 2</strong></p>
<p><strong>和提示信息msg</strong></p>
<p>判断：<strong>当collects值为errcodes时，下方栏展示收藏或者未收藏的图标，但因为每次重新请求数据默认是取到collects的默认值0，所以图标不会变化</strong>。</p>
<p>因此还需要请求一个接口   –<strong>获取详情页商品是否收藏：GET /collection?query=       {权限接口，需携带token}</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 收藏和取消收藏</span>
<span class="token keyword">async</span> <span class="token function">collEct</span><span class="token punctuation">(</span><span class="token parameter">num<span class="token punctuation">,</span>id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> num<span class="token operator">:</span>num<span class="token punctuation">,</span>id<span class="token operator">:</span>id <span class="token punctuation">}</span>  <span class="token comment">// 等于 { num,id }</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
							<span class="token comment">// this.Urls.m().enshrineurl 代表url , data 代表携带的参数 data</span>
		<span class="token keyword">let</span> enshrine <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>enshrineurl<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>enshrine<span class="token punctuation">,</span><span class="token string">'我是enshrine'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">let</span> <span class="token punctuation">{</span> errcode <span class="token punctuation">}</span> <span class="token operator">=</span> enshrine<span class="token punctuation">.</span>msg
		<span class="token keyword">if</span><span class="token punctuation">(</span>errcode <span class="token operator">==</span> <span class="token string">'401'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 要登录</span>
			<span class="token comment">// 使用 全局引入的登录弹窗 组件里的方法</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>show<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>errcode <span class="token operator">==</span> <span class="token string">'200'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			 <span class="token keyword">this</span><span class="token punctuation">.</span>collects <span class="token operator">=</span> enshrine<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>collects <span class="token comment">//判断当collects值为errcodes时，下方栏展示收藏或者未收藏的图标，但因为每次重新请求数据默认是取到collects的默认值0，使用图标不会变化</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">{</span>
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="获取该商品是否已经收藏"><a href="#获取该商品是否已经收藏" class="headerlink" title="获取该商品是否已经收藏"></a>获取该商品是否已经收藏</h5><p><strong>父组件datails</strong>中调用<strong>获取详情页商品是否收藏</strong>的接口 <strong>collectionur</strong></p>
<p>即当页面加载就调用该接口检查是否res[2]的返回值，并将返回值赋值给<strong>colldata</strong> ，通过refs将colldata传递给子组件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 获取商品是否收藏</span>
<span class="token keyword">let</span> collection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>collectionurl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>introduce<span class="token punctuation">,</span> wxcommnt<span class="token punctuation">,</span>collection<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'商品是否收藏数据'</span><span class="token punctuation">,</span>res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">this</span><span class="token punctuation">.</span>colldata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 底部操作栏组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>shopping <span class="token operator">:</span>goodid<span class="token operator">=</span><span class="token string">"goodid"</span> <span class="token operator">:</span>colldata<span class="token operator">=</span><span class="token string">"colldata"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>shopping<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>子组件shopping</strong>中接收数据，</p>
<p><strong>监听器wtach</strong> 监听msg对象中是否有变化，有新值就赋值给collects，<strong>这样就实现了收藏图标变化</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">props<span class="token operator">:</span><span class="token punctuation">{</span>
	goodid<span class="token operator">:</span>String<span class="token punctuation">,</span>
	colldata<span class="token operator">:</span>Object<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
    
watch<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 收藏和获取该商品是否收藏</span>
	<span class="token function">colldata</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">let</span> <span class="token punctuation">{</span> collects <span class="token punctuation">}</span> <span class="token operator">=</span> newValue<span class="token punctuation">.</span>msg
		<span class="token keyword">this</span><span class="token punctuation">.</span>collects <span class="token operator">=</span> collects
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<p><strong>当本地没有token的时候，即用户重新登陆后，</strong></p>
<p><strong>虽然这个请求返回的msg.errcode 值是 302 ，msg.msg返回值是 “未登录,收藏默认未收藏状态”</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> collection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>collectionurl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>introduce<span class="token punctuation">,</span> wxcommnt<span class="token punctuation">,</span>collection<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	

<span class="token comment">// .......</span>

<span class="token punctuation">{</span>__ob__<span class="token operator">:</span> Observer<span class="token punctuation">}</span>
msg<span class="token operator">:</span> Object
collects<span class="token operator">:</span> <span class="token number">0</span>
errcode<span class="token operator">:</span> <span class="token string">"302"</span>
msg<span class="token operator">:</span> <span class="token string">"未登录,收藏默认未收藏状态"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>但是：当登陆后，之前收藏的图标仍然显示未收藏</strong></p>
<p>思路：每次登录后刷新收藏状态</p>
<p>首先需要知道登陆成功，即shopping组件中，当errcode值等于401时候，表示没有登录，就调用弹窗组件<strong>showmodal.vue</strong>展示提示登录的弹窗,<strong>并且传递值 ‘coll’ 到子组件的参数中</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 收藏和取消收藏</span>
<span class="token keyword">async</span> <span class="token function">collEct</span><span class="token punctuation">(</span><span class="token parameter">num<span class="token punctuation">,</span>id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> num<span class="token operator">:</span>num<span class="token punctuation">,</span>id<span class="token operator">:</span>id <span class="token punctuation">}</span>  <span class="token comment">// 等于 { num,id }</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
							<span class="token comment">// this.Urls.m().enshrineurl 代表url , data 代表携带的参数 data</span>
		<span class="token keyword">let</span> enshrine <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>enshrineurl<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>enshrine<span class="token punctuation">,</span><span class="token string">'我是查看收藏成功与否'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">let</span> <span class="token punctuation">{</span> errcode <span class="token punctuation">}</span> <span class="token operator">=</span> enshrine<span class="token punctuation">.</span>msg
		<span class="token keyword">if</span><span class="token punctuation">(</span>errcode <span class="token operator">==</span> <span class="token string">'401'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 要登录</span>
			<span class="token comment">// 使用 全局引入的登录弹窗 组件里的方法</span>
            
				<span class="token comment">// 登陆这里传值过去 coll </span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>show<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token string">'coll'</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>errcode <span class="token operator">==</span> <span class="token string">'200'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>collects <span class="token operator">=</span> enshrine<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>collects
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">{</span>
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>子组件中，showing方法显示组件，同时接受值‘coll’，</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		<span class="token comment">// 默认隐藏的数据</span>
		modeling<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
		<span class="token comment">// 告知是哪个组件传值过来</span>
		msg<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    
<span class="token comment">// 显示组件  接收父组件shopping里的coll 这里参数默认是空值</span>
<span class="token function">showing</span><span class="token punctuation">(</span>msg <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg
	<span class="token keyword">this</span><span class="token punctuation">.</span>modeling <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后拿着msg到<strong>调用登录方法 wxusEr</strong> 下：</p>
<p><strong>判断如果当前组件的msg等于了‘coll’，就使用全局事件总线将data值传递出去   命名未 collict</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 调用登录</span>
<span class="token keyword">async</span> <span class="token function">wxusEr</span><span class="token punctuation">(</span><span class="token parameter">userInfo<span class="token punctuation">,</span>errMsg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">wxLogin</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loGin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// data 值是 success 来自于login.js中的返回值</span>
        
        		<span class="token comment">//如果登录成功就</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'coll'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// 更新收藏状态 emit是传值的作用 collict随意命名 值的话是data data值是SUCCESS</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'collict'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>colldata<span class="token operator">:</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>最后在父组件这，先封装一个更新收藏状态的方法，然后在生命周期created中接收 collict 值，当值等于SUCCESS时，调用更新状态的方法</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 登录成功后，更新收藏状态</span>
<span class="token keyword">async</span> <span class="token function">reFresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token comment">// 获取商品是否已经收藏</span>
		<span class="token keyword">let</span> collection <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>collectionurl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>goodid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>collection<span class="token punctuation">,</span><span class="token string">'更新商品是否收藏'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>collects <span class="token operator">=</span> collection<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>collects
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">// 接收showmodal组件传过来的判断是否登录的 SUCCESS 值</span>
<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'collict'</span><span class="token punctuation">,</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>colldata <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 更新收藏状态</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reFresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="获取购物车商品件数"><a href="#获取购物车商品件数" class="headerlink" title="获取购物车商品件数"></a>获取购物车商品件数</h5><p>在接口文件内添加获取商品件数接口 ，</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"> <span class="token comment">// 获取购物车件数</span>
<span class="token keyword">let</span> mycarturl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">mycart</span><span class="token template-punctuation string">`</span></span>
<span class="token comment">// 加入购物车</span>
<span class="token keyword">let</span> atcarturl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">atcart</span><span class="token template-punctuation string">`</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>在details组件内，发起请求，拿到res数据，初次其长度为0，即购物车里0件商品</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 获取购物车件数</span>
<span class="token keyword">let</span> mycart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mycarturl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
	<span class="token comment">// 因为后期需要发起多次请求,用promise.all做一个并发请求</span>
	<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token operator">...</span> <span class="token punctuation">,</span> mycart<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>		
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">' ... '</span> <span class="token punctuation">,</span> 获取购物车数据'<span class="token punctuation">,</span>res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>然后shopping中完成登陆之后刷新购物车功能</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 登录成功后，更新收藏状态</span>
<span class="token keyword">async</span> <span class="token function">reFresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token comment">// 获取商品是否已经收藏</span>
		<span class="token keyword">let</span> collection <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>collectionurl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>goodid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>collection<span class="token punctuation">,</span><span class="token string">'更新商品是否收藏'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>collects <span class="token operator">=</span> collection<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>collects
		
		<span class="token comment">// 更新购物车件数</span>
		<span class="token keyword">let</span> mycart <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mycarturl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>cartnum <span class="token operator">=</span> mycart<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h5 id="封装商品sku选择组件"><a href="#封装商品sku选择组件" class="headerlink" title="封装商品sku选择组件"></a><strong>封装商品sku选择组件</strong></h5><p>在pages/commponents下新建addtocart组件，同时在details中引入，</p>
<p><strong>静态布局代码如下</strong>：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 公用的商品sku选择组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Coupon-yin anim"</span> <span class="token operator">:</span>catchtouchmove<span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Coupon-view coup-anim padd"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品图片 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"commodity-view"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"commodity-left-img"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"attribute.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span>图片<span class="token number">1</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"commodity-zh"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>¥<span class="token number">300</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>库存<span class="token number">100</span>件<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"choice"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>请选择<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>颜色<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>尺码<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"commodity-right-img"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/guanbi.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span>
						图片<span class="token number">2</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 主要颜色 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-view"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-title"</span><span class="token operator">&gt;</span>主要颜色<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-mian"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span>
							图片<span class="token number">3</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>黑色<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 尺寸 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-view"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-title"</span><span class="token operator">&gt;</span>尺码<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-mian sku-two"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token constant">S</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token constant">M</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 购买数量 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-view sku-height"</span> <span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-title numes"</span><span class="token operator">&gt;</span>购买数量<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-mums-gight"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token number">0</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 确定按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"determine coup-anim"</span> <span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 登录弹窗 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>showmodal ref<span class="token operator">=</span><span class="token string">"show"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>showmodal<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>padd <span class="token punctuation">{</span>
	padding<span class="token operator">:</span> <span class="token number">15</span>upx<span class="token punctuation">;</span>
	margin<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">90</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>Coupon<span class="token operator">-</span>view text <span class="token punctuation">{</span>
	display<span class="token operator">:</span> block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>commodity<span class="token operator">-</span>view <span class="token punctuation">{</span>
	<span class="token comment">/* background: #4CD964; */</span>
	height<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>commodity<span class="token operator">-</span>left<span class="token operator">-</span>img <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>commodity<span class="token operator">-</span>left<span class="token operator">-</span>img image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>commodity<span class="token operator">-</span>zh <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">27</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">3</span>d4245<span class="token punctuation">;</span>
	flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>commodity<span class="token operator">-</span>zh view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">35</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #fe0036<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>commodity<span class="token operator">-</span>zh view <span class="token punctuation">{</span>
	padding<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">15</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>choice <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>choice text <span class="token punctuation">{</span>
	padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">8</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>commodity<span class="token operator">-</span>right<span class="token operator">-</span>img <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>commodity<span class="token operator">-</span>right<span class="token operator">-</span>img image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* sku */</span>
<span class="token punctuation">.</span>sku<span class="token operator">-</span>view <span class="token punctuation">{</span>
	margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">40</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">1</span>px solid #e5e5e5<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sku<span class="token operator">-</span>title <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">051</span>b28<span class="token punctuation">;</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
	margin<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sku<span class="token operator">-</span>mian image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">45</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">45</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">17</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sku<span class="token operator">-</span>mian view <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">65</span>upx<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #f5f5f5<span class="token punctuation">;</span>
	border<span class="token operator">:</span> <span class="token number">1</span>rpx solid #f5f5f5<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">14</span>upx<span class="token punctuation">;</span>
	margin<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	margin<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sku<span class="token operator">-</span>mian <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">27</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">051</span>b28<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sku<span class="token operator">-</span>two view <span class="token punctuation">{</span>
	padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">35</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 购买数量 */</span>
<span class="token punctuation">.</span>sku<span class="token operator">-</span>height <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">120</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>numes <span class="token punctuation">{</span>
	margin<span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sku<span class="token operator">-</span>mums<span class="token operator">-</span>gight <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sku<span class="token operator">-</span>mums<span class="token operator">-</span>gight view <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">051</span>b28<span class="token punctuation">;</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #f5f5f5<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sku<span class="token operator">-</span>mums<span class="token operator">-</span>gight view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	background<span class="token operator">:</span> none <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>determine <span class="token punctuation">{</span>
	z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">999</span><span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #fe0036<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
	position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
	bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 选了颜色加上边框 */</span>
<span class="token punctuation">.</span>active <span class="token punctuation">{</span>
	border<span class="token operator">:</span> <span class="token number">1</span>rpx solid red <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>添加 隐藏或显示 购物车组件功能</strong></p>
<h6 id="显示组件思路"><a href="#显示组件思路" class="headerlink" title="显示组件思路:"></a><strong>显示组件思路:</strong></h6><p><strong>在父组件details中通过ref绑定子组件Addtocart，然后details中封装一个方法用于在子组件shopping中用$parent调用该方法来控制Addtocart组件中的数据</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 公用的商品sku组件 父组件通过ref可以通过这个方式 控制节点  <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Addtocart ref<span class="token operator">=</span><span class="token string">"addto"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Addtocart<span class="token operator">&gt;</span>

<span class="token comment">// 父组件details中被子组件shopping调用的方法</span>
<span class="token function">shoPp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>addto<span class="token punctuation">.</span><span class="token function">showCou</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token comment">// shopping调用父组件details里的sku组件</span>
<span class="token function">couponsFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span><span class="token function">shoPp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token comment">// Addtocart组件中控制显示隐藏的方法 被其他组件调用</span>
methods<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 被其他组件调用显示sku组件</span>
	<span class="token function">showCou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>couponif <span class="token operator">=</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h6 id="隐藏组件思路："><a href="#隐藏组件思路：" class="headerlink" title="隐藏组件思路："></a>隐藏组件思路：</h6><p><strong>给叉叉按钮或者遮罩背景添加点击事件，然后将v-if属性变为false</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 背景遮罩层 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Coupon-yin anim"</span> <span class="token operator">:</span>catchtouchmove<span class="token operator">=</span><span class="token string">"true"</span> @click<span class="token operator">=</span><span class="token string">"hideCou()"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"commodity-right-img"</span> @click<span class="token operator">=</span><span class="token string">"hideCou()"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 叉叉按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/guanbi.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span>
		图片<span class="token number">2</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>



<span class="token comment">// 隐藏sku组件</span>
<span class="token function">hideCou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>couponif <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h6 id="sku组件的确定功能"><a href="#sku组件的确定功能" class="headerlink" title="sku组件的确定功能"></a>sku组件的确定功能</h6><p>点击立即购买也会显示sku组件，但是立即购买显示的sku组件的确定按钮是会跳转到付款页面，而点击加入购物车显示的sku组件的确定按钮仅仅是加入了购物车功能，在点击确定按钮时，要让按钮知道点击的目的。</p>
<p>所以要传值过去，让确定按钮执行相应的操作。</p>
<p>思路：</p>
<p><strong>多写两条确定按钮，分别触发的点击事件不一样，通过v-if来选择不同的情况。</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 确定按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"determine coup-anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"mean == '002'"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"determine coup-anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"mean == '003'"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// data中默认mean值是002</span>
<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		couponif<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span> 	<span class="token comment">//显示 或 隐藏该组件</span>
		mean<span class="token operator">:</span> <span class="token string">'002'</span><span class="token punctuation">,</span>		<span class="token comment">// 设置一个值   002代表加入购物车    003代表直接购买 </span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
  
<span class="token comment">// 在shopping组件中给立即购买添加相同的点击事件，但传递的参数值不同 </span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"join join-right"</span> @click<span class="token operator">=</span><span class="token string">"couponsFun('002')"</span><span class="token operator">&gt;</span>加入购物车<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"join join-left"</span> @click<span class="token operator">=</span><span class="token string">"couponsFun('003')"</span><span class="token operator">&gt;</span>立即购买<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token comment">// 调用父组件details里的sku组件 并且将相应点击触发的值传递给父组件的shoPp方法的参数中</span>
<span class="token function">couponsFun</span><span class="token punctuation">(</span><span class="token parameter">mean</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span><span class="token function">shoPp</span><span class="token punctuation">(</span>mean<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 父组件details被子组件shopping调用 同时接收子组件传递的参数值mean 最终通过ref拿到子组件sku的节点并使用其showCou方法 同时传递mean参数值 </span>
<span class="token function">shoPp</span><span class="token punctuation">(</span><span class="token parameter">mean</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>addto<span class="token punctuation">.</span><span class="token function">showCou</span><span class="token punctuation">(</span>mean<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="请求商品sku组件的数据"><a href="#请求商品sku组件的数据" class="headerlink" title="请求商品sku组件的数据"></a>请求商品sku组件的数据</h5><p>后台request.js配置很好接口后，到父组件details，发起请求拿到数据，并拿到轮播的第一张图片和价格、库存、商品id、标题等数据然后psuh到res[4]数据中，最后传递给子组件sku使用数据</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 请求数据方法  id是商品的id</span>
<span class="token keyword">async</span> <span class="token function">detRequest</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// ......</span>
          
	<span class="token comment">// 商品sku组件数据</span>
	<span class="token keyword">let</span> wxsku <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>wxskuurl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">try</span> <span class="token punctuation">{</span>
		<span class="token comment">// 因为后期需要发起多次请求,用promise.all做一个并发请求</span>
		<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token operator">...</span> <span class="token punctuation">,</span> wxsku <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">' ... , '</span>sku组件数据'<span class="token punctuation">,</span>res<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        		<span class="token comment">// 获取sku数据 这里的数据来自轮播图和商品价格</span>
		<span class="token keyword">let</span> defaultdata <span class="token operator">=</span> <span class="token punctuation">{</span>
			image<span class="token operator">:</span>mendata<span class="token punctuation">.</span>media<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>imgArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 	 <span class="token comment">// 拿到轮播图第一张图片</span>
			price<span class="token operator">:</span>mendata<span class="token punctuation">.</span>describe<span class="token punctuation">.</span>Trueprice<span class="token punctuation">,</span>  		 <span class="token comment">// 拿到价格</span>
			totalstock<span class="token operator">:</span>mendata<span class="token punctuation">.</span>describe<span class="token punctuation">.</span>Total_stock<span class="token punctuation">,</span> <span class="token comment">// 拿到库存</span>
			id<span class="token operator">:</span>mendata<span class="token punctuation">.</span>id<span class="token punctuation">,</span>						 	 <span class="token comment">// 拿到商品id</span>
			title<span class="token operator">:</span>mendata<span class="token punctuation">.</span>describe<span class="token punctuation">.</span>title<span class="token punctuation">,</span>			 <span class="token comment">// 拿到商品标题，在提交到购物车需要用到</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">// 将以上数据 push到一个数组里面 即 商品sku组件数据</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>skudata <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data
		<span class="token keyword">this</span><span class="token punctuation">.</span>skudata<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>defaultdata<span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>skudata<span class="token punctuation">,</span><span class="token string">'商品sku新数据'</span><span class="token punctuation">)</span>            
                    
	<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>子组件保存数据：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">props<span class="token operator">:</span><span class="token punctuation">{</span>
	skudata<span class="token operator">:</span>Array<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// watch监听数据</span>
<span class="token comment">// 因为图片会随着选择码数时变化，所以使用监听更高效 </span>
watch<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 获取父组件来的sku默认展示数据</span>
	<span class="token function">skudata</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span><span class="token string">'sku新值'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> newValue<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id
		<span class="token keyword">this</span><span class="token punctuation">.</span>attribute <span class="token operator">=</span> newValue<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> newValue<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>title
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
    
<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		couponif<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span> 	<span class="token comment">//显示 或 隐藏该组件</span>
		mean<span class="token operator">:</span> <span class="token string">'002'</span><span class="token punctuation">,</span>		<span class="token comment">// 设置一个值   002代表加入购物车    003代表直接购买 </span>
		id<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span> 				<span class="token comment">//商品id</span>
		attribute<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>		<span class="token comment">// 商品展示的sku</span>
		title<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>			<span class="token comment">// 商品标题</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>sku组件中模板代码修改如下：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品图片 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"commodity-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"commodity-left-img"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"attribute.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"commodity-zh"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>¥<span class="token punctuation">{</span><span class="token punctuation">{</span>attribute<span class="token punctuation">.</span>price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>库存<span class="token punctuation">{</span><span class="token punctuation">{</span>attribute<span class="token punctuation">.</span>totalstock<span class="token punctuation">}</span><span class="token punctuation">}</span>件<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"choice"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>请选择<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>颜色<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>尺码<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"commodity-right-img"</span> @click<span class="token operator">=</span><span class="token string">"hideCou()"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 叉叉按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/guanbi.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 主要颜色 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-view"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-title"</span><span class="token operator">&gt;</span>主要颜色<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-mian"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in skudata[1]"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span>
					
				<span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 尺寸 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-view"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-title"</span><span class="token operator">&gt;</span>尺码<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-mian sku-two"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in skudata[0]"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="计算属性处理选中某个sku"><a href="#计算属性处理选中某个sku" class="headerlink" title="计算属性处理选中某个sku"></a>计算属性处理选中某个sku</h5><p>给 <strong>颜色 / 尺码</strong> 按钮添加点击事件，并且动态绑定边框变色的css属性 ，属性值默认-1，index值取自于对应的item 或 item.color</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 给颜色按钮添加点击事件，并且动态绑定边框变色的css属性   </span>
<span class="token operator">&lt;</span>view @click<span class="token operator">=</span><span class="token string">"colorFun(item.color,index)"</span> <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{active:index == colornum}"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 尺码添加点击事件， 并且动态绑定边框变色的css属性 </span>
<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in skudata[0]"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view @click<span class="token operator">=</span><span class="token string">"sizeFun(item,index)"</span> <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{active:index == sizenum}"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>

<span class="token comment">// 选择颜色</span>
<span class="token function">colorFun</span><span class="token punctuation">(</span><span class="token parameter">color<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>color<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>colornum <span class="token operator">=</span> index
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 选择尺码</span>
<span class="token function">sizeFun</span><span class="token punctuation">(</span><span class="token parameter">size<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>sizenum <span class="token operator">=</span> index
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>接着完成请选择：颜色 尺码 的文字动态变化</strong></p>
<p><strong>使用计算属性：choice</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 选择颜色</span>
<span class="token function">colorFun</span><span class="token punctuation">(</span><span class="token parameter">color<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>color<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>colornum <span class="token operator">=</span> index
    <span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue <span class="token operator">=</span> color 		<span class="token comment">//每次选中颜色后 data中的colorvalue就有值 可以将其赋值给请选择。。。</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 选择尺码</span>
<span class="token function">sizeFun</span><span class="token punctuation">(</span><span class="token parameter">size<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>sizenum <span class="token operator">=</span> index
   	<span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue <span class="token operator">=</span> size			<span class="token comment">//每次选中尺码后 data中的sizevalue就有值 可以将其赋值给请选择。。。</span>
<span class="token punctuation">}</span>

computed<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 选择sku的改变</span>
	<span class="token function">choice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue <span class="token operator">==</span> <span class="token string">''</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token string">'请选择'</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token string">'已选择'</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>**此时，在template模板中的代码块如下使用计算属性中的方法  **</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"choice"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>choice<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>颜色<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>尺码<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>再一次使用计算属性：skumen 完成选择颜色或者尺码时，上方主要颜色下 显示的文字</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 选择颜色或者尺码 主要颜色下显示的文字</span>
<span class="token function">skumen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 两个都被选中</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue <span class="token operator">!=</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 返回一个对象</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			color<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue<span class="token punctuation">,</span>size<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue<span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 两个都未选中</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue <span class="token operator">==</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			color<span class="token operator">:</span><span class="token string">'主要颜色'</span><span class="token punctuation">,</span>size<span class="token operator">:</span><span class="token string">'尺码'</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 假如尺码没有选择, 并且 颜色选择了</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue <span class="token operator">==</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			color<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>size<span class="token operator">:</span><span class="token string">'尺码'</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 假如尺码选择了, 并且 颜色没选择</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue <span class="token operator">!=</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			color<span class="token operator">:</span><span class="token string">'主要颜色'</span><span class="token punctuation">,</span>size<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>最后当未选择商品和尺码时候 ，禁止确定按钮功能</strong></p>
<p>在计算属性中，添加return的一个 键值对，当ban为true时，可以触发确定的点击功能</p>
<p><strong>扩展知识：JS中的逻辑运算符&amp;&amp;、||</strong></p>
<ul>
<li> 只要“&amp;&amp;”前面是false，无论“&amp;&amp;”后面是true还是false，结果都将返“&amp;&amp;”前面的值;</li>
<li>只要“&amp;&amp;”前面是true，无论“&amp;&amp;”后面是true还是false，结果都将返“&amp;&amp;”后面的值;</li>
<li>只要“||”前面为false,不管“||”后面是true还是false，都返回“||”后面的值。</li>
<li>只要“||”前面为true,不管“||”后面是true还是false，都返回“||”前面的值。                        </li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 确定按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>

												<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 利用计算属性 如果两个未选中就禁止使用确定按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"determine coup-anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"mean == '002'"</span> @click<span class="token operator">=</span><span class="token string">"skumen.ban &amp;&amp; detErmine()"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 。。。。。。</span>

<span class="token comment">// 选择颜色或者尺码 主要颜色下显示的文字</span>
<span class="token function">skumen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 两个都被选中</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue <span class="token operator">!=</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 返回一个对象</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			color<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue<span class="token punctuation">,</span>size<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue<span class="token punctuation">,</span>ban<span class="token operator">:</span><span class="token boolean">true</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 两个都未选中</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue <span class="token operator">==</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			color<span class="token operator">:</span><span class="token string">'主要颜色'</span><span class="token punctuation">,</span>size<span class="token operator">:</span><span class="token string">'尺码'</span><span class="token punctuation">,</span>ban<span class="token operator">:</span><span class="token boolean">false</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 假如尺码没有选择, 并且 颜色选择了</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue <span class="token operator">==</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			color<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>size<span class="token operator">:</span><span class="token string">'尺码'</span><span class="token punctuation">,</span>ban<span class="token operator">:</span><span class="token boolean">false</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 假如尺码选择了, 并且 颜色没选择</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue <span class="token operator">!=</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			color<span class="token operator">:</span><span class="token string">'主要颜色'</span><span class="token punctuation">,</span>size<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>ban<span class="token operator">:</span><span class="token boolean">false</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="请求每个sku的库存、价格"><a href="#请求每个sku的库存、价格" class="headerlink" title="请求每个sku的库存、价格"></a>请求每个sku的库存、价格</h5><p>分析可得当同时选择了颜色和尺码，才会展示相应的价格和库存，即发起请求 <strong>this.skuing()</strong></p>
<p>那么如何得知选择了尺码和颜色呢</p>
<p>**在监听器中，监听skumen方法返回的数据变化： ** 当得到的newValue中的color和size数据不为空，即都选择了就调用请求方法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">methods：<span class="token punctuation">{</span>
	<span class="token comment">// 获取请求每个sku的数据</span>
	<span class="token keyword">async</span> <span class="token function">skuRequest</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> querysku <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>queryskuurl<span class="token punctuation">,</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>querysku<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 刚好得到的data和之前用于展示库存、价格、图片的对象里的键值对一致 </span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>attribute <span class="token operator">=</span> querysku<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">//TODO handle the exception</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

watch<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 是否选择了尺码和颜色</span>
	<span class="token function">skumen</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span><span class="token string">'更新后的尺码和颜色数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">let</span> <span class="token punctuation">{</span> color<span class="token punctuation">,</span>size <span class="token punctuation">}</span> <span class="token operator">=</span> newValue
		
		<span class="token keyword">if</span><span class="token punctuation">(</span>color <span class="token operator">!=</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> size <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">skuRequest</span><span class="token punctuation">(</span>
            		<span class="token comment">// 将请求需要的参数在这里放到一个对象中一个带到请求方法参数中</span>
					<span class="token punctuation">{</span>id<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> color<span class="token operator">:</span>color<span class="token punctuation">,</span>size<span class="token operator">:</span>size<span class="token punctuation">}</span> 
            <span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="商品购买数量加减"><a href="#商品购买数量加减" class="headerlink" title="商品购买数量加减"></a>商品购买数量加减</h5><p>对减号和加号添加点击事件，并且当数值为1时，禁用减号按钮，核心思路是利用三元表达式和 click 的false情况</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 购买数量 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-view sku-height"</span> <span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-title numes"</span><span class="token operator">&gt;</span>购买数量<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sku-mums-gight"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 三元表达式 如果商品数量等于<span class="token number">1</span> 就禁用 <span class="token operator">-</span> 按钮 ，否则可以使用减号按钮<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view @click<span class="token operator">=</span><span class="token string">"many === 1 ? forbid==false : forbid==true &amp;&amp; reDuce()"</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>many<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view @click<span class="token operator">=</span><span class="token string">"pLus()"</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        many<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>				<span class="token comment">// 购买数量</span>
		forbid<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>		<span class="token comment">// 购买数量最少为1，&lt;=1 时禁止按钮点击</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>				

<span class="token comment">// 数量</span>
<span class="token function">reDuce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>many <span class="token operator">--</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>many <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'数量不能低于1'</span><span class="token punctuation">,</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 加数量</span>
<span class="token function">pLus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>many <span class="token operator">++</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="加入所选商品到购物车"><a href="#加入所选商品到购物车" class="headerlink" title="加入所选商品到购物车"></a>加入所选商品到购物车</h5><p><strong>当点击确定按钮，需要在addtoart.vue文件中获取如下的data对象中的所有数据用作请求的data参数，</strong></p>
<p>拿到返回结果后，判断如果存在errcode 即没有登录，调用登录弹窗和登录请求弹窗。</p>
<p>如果返回的数据值 ‘SUCCESS’ ，那么隐藏sku组件，同时调用反馈弹窗，并且调用一次获取购物车件数的接口，将拿到的件数（length值）传递给shoppping.vue组件中，刷新购物车的件数 —（<strong>使用vuex传值</strong>）</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 加入购物车按钮 (需要选择颜色和尺码后才能触发)</span>
<span class="token function">detErmine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 点击确定按钮 要将这里的data对象传到请求作为参数使用</span>
	<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
		id<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span>
		size<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue<span class="token punctuation">,</span>
		color<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue<span class="token punctuation">,</span>
		image<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>attribute<span class="token punctuation">.</span>image<span class="token punctuation">,</span>
		price<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>attribute<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
		title<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span>
		many<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>many<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> atcartdata <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>atcarturl<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">,</span><span class="token string">'加入购物车的返回数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// 如果errcode存在就需要登录</span>
			<span class="token comment">// 登陆这里传值过去 'coll'</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>show<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token string">'coll'</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">"SUCCESS"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hideCou</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'加入购物车成功'</span><span class="token punctuation">,</span><span class="token string">'success'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//反馈 弹窗</span>
			<span class="token comment">// 相同的sku（颜色、尺码一样）加入购物车后只显示一条，仅件数变化 （后端接口已经做了处理）</span>
			<span class="token keyword">let</span> mycart <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mycarturl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mycart<span class="token punctuation">,</span><span class="token string">"购物车件数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>
                <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="vuex传值到购物车的商品数量"><a href="#vuex传值到购物车的商品数量" class="headerlink" title="vuex传值到购物车的商品数量"></a>vuex传值到购物车的商品数量</h5><p>在项目根目录下新建文件夹 store，其下新建<strong>store.js</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// vuex存放数据，数据仓库，数据管理中心</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'vuex'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>

<span class="token comment">// 购物车件数</span>
<span class="token keyword">const</span> cartnum <span class="token operator">=</span> <span class="token punctuation">{</span>
	nums<span class="token operator">:</span><span class="token string">''</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token comment">// 购物车件数</span>
	cartnum<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token comment">// 数据仓库中心</span>
	state<span class="token punctuation">,</span>
	<span class="token comment">// 传值</span>
	<span class="token comment">// actions : 异步传值 --不能直接到达数据仓库，		组件中使用 ： store.dispatch()</span>
	<span class="token comment">// getters : 类似计算属性，带有缓存，有新的值进来才会被触发 （不常用）</span>
	<span class="token comment">// mutitions : 同步传值：可以直接传给state    	组件中使用 ： store.commit('mutations中方法名',value) </span>
	
	mutations<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 加入购物车成功后传值的购物车条数  (第一个参数是state仓库，第二个是要传递过来的值)</span>
		<span class="token function">mutacart</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span>nums</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// 接收到组件传过来的值之后要存储到数据中心仓库</span>
			state<span class="token punctuation">.</span>cartnum <span class="token operator">=</span> <span class="token punctuation">{</span>
				nums<span class="token operator">:</span>nums
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>在sku组件中，将获取到的购物车件数，存储到vuex中，</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 加入购物车按钮 (需要选择颜色和尺码后才能触发)</span>
<span class="token keyword">async</span> <span class="token function">detErmine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 点击确定按钮 要将这里的data对象传到请求作为参数使用</span>
	<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
		id<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span>
		size<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue<span class="token punctuation">,</span>
		color<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue<span class="token punctuation">,</span>
		image<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>attribute<span class="token punctuation">.</span>image<span class="token punctuation">,</span>
		price<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>attribute<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
		title<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span>
		many<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>many<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> atcartdata <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>atcarturl<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">,</span><span class="token string">'加入购物车的返回数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// 如果errcode存在就需要登录</span>
			<span class="token comment">// 登陆这里传值过去 'coll'</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>show<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token string">'coll'</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">"SUCCESS"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hideCou</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'加入购物车成功'</span><span class="token punctuation">,</span><span class="token string">'success'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//反馈 弹窗</span>
			<span class="token comment">// 相同的sku（颜色、尺码一样）加入购物车后只显示一条，仅件数变化 （后端接口已经做了处理）</span>
			<span class="token keyword">let</span> mycart <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mycarturl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mycart<span class="token punctuation">,</span><span class="token string">"购物车件数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 使用vuex方法 将购物车件数值传递到 仓库</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'mutacart'</span><span class="token punctuation">,</span>mycart<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>在shopping.vue组件，监听器中使用vuex的数据</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">watch<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 加入购物车成功后存储到vuex后，从vuex仓库中心拿取值；监听vuex数据中心的值变化，</span>
	<span class="token comment">// 如果vuex数据中心的值变化才会被触发执行</span>
	<span class="token string">"$store.state.cartnum"</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span><span class="token string">'监听器监听vuex中购物车件数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>cartnum <span class="token operator">=</span> newValue
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="商品订单页"><a href="#商品订单页" class="headerlink" title="商品订单页"></a>商品订单页</h3><h4 id="直接下单获取待付款商品数据"><a href="#直接下单获取待付款商品数据" class="headerlink" title="直接下单获取待付款商品数据"></a>直接下单获取待付款商品数据</h4><p>pages新建 payment-page目录，下方新建payment.vue,同时去page.json中引入</p>
<p>然后对addtocart.vue文件中的确定按钮进行添加点击事件，并配置方法，</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"determine coup-anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"mean == '003'"</span> @click<span class="token operator">=</span><span class="token string">"skumen.ban &amp;&amp; purChase()"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 直接下单</span>
<span class="token keyword">async</span> <span class="token function">purChase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 点击确定按钮 要将这里的data对象传到请求作为参数使用，因为购物车的商品类目不止一个，所以用数组包裹很多对象</span>
	<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			id<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span>
			size<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue<span class="token punctuation">,</span>
			color<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue<span class="token punctuation">,</span>
			image<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>attribute<span class="token punctuation">.</span>image<span class="token punctuation">,</span>
			price<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>attribute<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
			title<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span>
			many<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>many<span class="token punctuation">,</span>
			total_price<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>attribute<span class="token punctuation">.</span>price <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>many<span class="token punctuation">,</span>  <span class="token comment">//商品总价</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span>
	<span class="token comment">// 校验登录状态</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> tokening <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tokeningurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tokening<span class="token punctuation">,</span><span class="token string">'检查登录状态'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>tokening<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode <span class="token operator">==</span> <span class="token string">"401"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 没有token 就展示登录弹窗</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>show<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token string">'coll'</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>tokening<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">"SUCCESS"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 数组，对象转换成字符串才能携带值</span>
			<span class="token keyword">let</span> cartdata <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
			<span class="token comment">// 跳转到下单页面 同时携带参数</span>
			uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				url<span class="token operator">:</span><span class="token string">'../payment-page/payment?cartdata='</span> <span class="token operator">+</span> cartdata<span class="token punctuation">,</span>
				
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span><span class="token punctuation">,</span>
    
<span class="token comment">// 在payment.vue组件中，使用onLoad生命周期 的e参数 接收 参数</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token comment">// e就是上个页面使用navigateTo路径，携带的值  --来自于addtocart组件 purChase方法</span>
	<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 将JSON字符串转化为对象</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cartdata<span class="token punctuation">)</span><span class="token punctuation">)</span>
				
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="视图层展示待付款的商品"><a href="#视图层展示待付款的商品" class="headerlink" title="视图层展示待付款的商品"></a>视图层展示待付款的商品</h4><p>js浮点数解决：</p>
<p>在上个组件addtocart中对total_price数据进行修改</p>
<p>*<em>total_price:parseFloat((this.attribute.price * this.many).toFixed(10)),*</em>  //商品总价 ,解决浮点数</p>
<p><strong>总价显示小数点后两位：</strong></p>
<p><code>npm i e-commerce_price</code></p>
<p>// 引入下载的node库 –支付小数点后两位 价格补零<br><strong>const Price = require(‘e-commerce_price’)</strong></p>
<p><strong>payment.vue 完整代码如下：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-view"</span><span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 收货地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-name"</span> <span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-left-img"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/address-shouhuo.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 收货地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-add"</span> <span class="token operator">&gt;</span>请选择收货地址<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-right-img"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/shouhuo-jiantou.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-commodity"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in comminfo"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order-img"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-title"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>颜色<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>尺码<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>size<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-flex"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-price"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>￥ <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>x<span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>many<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
							共<span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>many<span class="token punctuation">}</span><span class="token punctuation">}</span>件 小计<span class="token operator">:</span> ￥ <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>total_price<span class="token punctuation">}</span><span class="token punctuation">}</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 底部提交订单 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"place-order"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>合计<span class="token operator">:</span> ￥<span class="token punctuation">{</span><span class="token punctuation">{</span>Totalprice<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text @click<span class="token operator">=</span><span class="token string">"placeOrder()"</span><span class="token operator">&gt;</span>提交订单<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token comment">// 引入下载的node库 --支付小数点后两位 价格补零</span>
	<span class="token keyword">const</span> Price <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'e-commerce_price'</span><span class="token punctuation">)</span>
	
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				comminfo<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//上个页面接收的商品数据</span>
				Totalprice<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//商品总价 小数点两位数</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// e就是路径上携带的值 来自于addtocart组件 purChase方法</span>
		<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token comment">// 将JSON字符串转化为对象</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cartdata<span class="token punctuation">)</span><span class="token punctuation">)</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>comminfo <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cartdata<span class="token punctuation">)</span>
				<span class="token comment">// 合计支付总价计算 numdata默认为0，使用forEach遍历</span>
				<span class="token keyword">let</span> numdata <span class="token operator">=</span> <span class="token number">0</span>
				<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cartdata<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
					numdata <span class="token operator">+=</span> item<span class="token punctuation">.</span>total_price
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token comment">// 合计总价 小数点两位数</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>Totalprice <span class="token operator">=</span> <span class="token function">Price</span><span class="token punctuation">(</span>numdata<span class="token punctuation">)</span> <span class="token comment">// 将需补0的数据传入方法</span>
		
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
page<span class="token punctuation">{</span>background<span class="token operator">-</span>color<span class="token operator">:</span> #f2f2f2<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>view<span class="token punctuation">{</span>margin<span class="token operator">:</span> <span class="token number">15</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>name<span class="token punctuation">{</span>
height<span class="token operator">:</span> <span class="token number">150</span>upx<span class="token punctuation">;</span>
background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span> border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">15</span>upx<span class="token punctuation">;</span>
font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>upx<span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>left<span class="token operator">-</span>img<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">60</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">60</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>left<span class="token operator">-</span>img image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">60</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">60</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>add text<span class="token punctuation">{</span>display<span class="token operator">:</span> block<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>add text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>padding<span class="token operator">:</span> <span class="token number">4</span>rpx <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>add<span class="token punctuation">{</span>flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">20</span>rpx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>right<span class="token operator">-</span>img<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">40</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">40</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>right<span class="token operator">-</span>img image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">40</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">40</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token comment">/* 下单商品 */</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>commodity<span class="token punctuation">{</span>
background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span> border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">15</span>upx<span class="token punctuation">;</span>
font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>upx<span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span>
margin<span class="token operator">:</span> <span class="token number">15</span>upx <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>order<span class="token punctuation">{</span>display<span class="token operator">:</span> flex<span class="token punctuation">;</span>justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
<span class="token comment">/* background: #4CD964; */</span>
margin<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">20</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>order text<span class="token punctuation">{</span>display<span class="token operator">:</span> block<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>order<span class="token operator">-</span>img<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">8</span>upx<span class="token punctuation">;</span>
padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>order<span class="token operator">-</span>img image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">8</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>title<span class="token punctuation">{</span>flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>title text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
overflow<span class="token operator">:</span> hidden<span class="token punctuation">;</span>
text<span class="token operator">-</span>overflow<span class="token operator">:</span> ellipsis<span class="token punctuation">;</span>
display<span class="token operator">:</span> <span class="token operator">-</span>webkit<span class="token operator">-</span>box<span class="token punctuation">;</span>
<span class="token operator">-</span>webkit<span class="token operator">-</span>line<span class="token operator">-</span>clamp<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token operator">-</span>webkit<span class="token operator">-</span>box<span class="token operator">-</span>orient<span class="token operator">:</span> vertical<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>title text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
background<span class="token operator">-</span>color<span class="token operator">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">5</span>upx<span class="token punctuation">;</span>
border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">7</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>price<span class="token punctuation">{</span>text<span class="token operator">-</span>align<span class="token operator">:</span> right<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>payment<span class="token operator">-</span>flex<span class="token punctuation">{</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>text<span class="token operator">-</span>you<span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span><span class="token number">156</span><span class="token punctuation">,</span> <span class="token number">156</span><span class="token punctuation">,</span> <span class="token number">156</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">8</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 提交 */</span>
<span class="token punctuation">.</span>place<span class="token operator">-</span>order<span class="token punctuation">{</span>height<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span>
background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
justify<span class="token operator">-</span>content<span class="token operator">:</span> flex<span class="token operator">-</span>end<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>place<span class="token operator">-</span>order text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>background<span class="token operator">-</span>color<span class="token operator">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span>
width<span class="token operator">:</span> <span class="token number">270</span>upx<span class="token punctuation">;</span>
color<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span>
margin<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="我的收货地址页面"><a href="#我的收货地址页面" class="headerlink" title="我的收货地址页面"></a>我的收货地址页面</h4><p>   在pages下新建my-address文件夹，然后在下方新建my-address.vue、new-address.vue文件</p>
<p><strong>然后注册到pages.json</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">{</span>
	<span class="token string">"path"</span><span class="token operator">:</span> <span class="token string">"pages/my-address/my-addres"</span><span class="token punctuation">,</span>
	<span class="token string">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"我的收货地址"</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
	<span class="token string">"path"</span><span class="token operator">:</span> <span class="token string">"pages/my-address/new-address"</span><span class="token punctuation">,</span>
	<span class="token string">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"新增收货地址"</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>my-address.vue组件静态布局</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-name"</span> @click<span class="token operator">=</span><span class="token string">"getAdd(item)"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>北京大学<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-adding"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>张三<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token number">10086</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-change"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/genggai.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 新增收货地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"button-address"</span> <span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/xinzeng.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>新增收货地址<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
				<span class="token keyword">async</span> <span class="token function">getadd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token keyword">try</span><span class="token punctuation">{</span>
						<span class="token keyword">let</span> atcartdata <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gainaddurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">,</span><span class="token string">'请求收货地址信息'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token comment">//TODO handle the exception</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getadd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
page<span class="token punctuation">{</span>background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token constant">F2F2F2</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>address<span class="token operator">-</span>view<span class="token punctuation">{</span>
font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
background<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span> margin<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>address<span class="token operator">-</span>name<span class="token punctuation">{</span>
flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">130</span>rpx<span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>address<span class="token operator">-</span>name view<span class="token punctuation">{</span>display<span class="token operator">:</span> flex<span class="token punctuation">;</span> align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>address<span class="token operator">-</span>change<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>address<span class="token operator">-</span>change image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>address<span class="token operator">-</span>adding<span class="token punctuation">{</span>color<span class="token operator">:</span> #<span class="token constant">A7A7A7</span><span class="token punctuation">;</span> padding<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">8</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>address<span class="token operator">-</span>adding text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">15</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token comment">/* 新增收货地址 */</span>
<span class="token punctuation">.</span>button<span class="token operator">-</span>address<span class="token punctuation">{</span>
font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span> align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
background<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>button<span class="token operator">-</span>address image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>完成新的登录页面</strong></p>
<p><strong>在pages/components/新建login-page.vue</strong></p>
<p>在里边完成登录逻辑</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"login-page"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"login"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> open<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">"getUserInfo"</span> @click<span class="token operator">=</span><span class="token string">"getUserInfo()"</span><span class="token operator">&gt;</span>登录<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token comment">// 引入登录</span>
<span class="token keyword">import</span> wxLogin <span class="token keyword">from</span> <span class="token string">'../../login/login.js'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			login<span class="token operator">:</span> <span class="token boolean">false</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token function">showing</span><span class="token punctuation">(</span><span class="token parameter">boll<span class="token operator">=</span><span class="token boolean">true</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>login <span class="token operator">=</span> boll
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 登录</span>
		<span class="token keyword">async</span> <span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'登录中'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token comment">//新的登录接口：wx.getUserProfile</span>
			wx<span class="token punctuation">.</span><span class="token function">getUserProfile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				desc<span class="token operator">:</span> <span class="token string">'登录'</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				<span class="token keyword">let</span> <span class="token punctuation">{</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">}</span> <span class="token operator">=</span> res
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wxusEr</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'拒绝登录或登录失败'</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 调用登录</span>
		<span class="token keyword">async</span> <span class="token function">wxusEr</span><span class="token punctuation">(</span><span class="token parameter">userInfo<span class="token punctuation">,</span>errMsg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
				<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">wxLogin</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loGin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token comment">// 登录成功更新需要请求的接口或者数据</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'mycart'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>cart<span class="token operator">:</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>login <span class="token operator">=</span> <span class="token boolean">false</span>
			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">//TODO handle the exception</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>login<span class="token operator">-</span>page<span class="token punctuation">{</span>
	position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
	left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
	z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">999</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>login<span class="token operator">-</span>page button<span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">350</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>因为其他地方会用到，所以放到公共main.js中</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 引入新的登录组件</span>
<span class="token keyword">import</span> loginpage <span class="token keyword">from</span> <span class="token string">'pages/commponents/login-page.vue'</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'loginpage'</span><span class="token punctuation">,</span>loginpage<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>引入到收货组件my-address.vue里使用</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-view"</span><span class="token operator">&gt;</span>
		。。。。。
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 新增收货地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
		。。。。。

	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 登录界面 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>loginpage<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>loginpage<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>完整login-page.vue逻辑代码</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token comment">// 引入 微信登录逻辑</span>
<span class="token keyword">import</span> wxLogin <span class="token keyword">from</span> <span class="token string">'../../login/login.js'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			login<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">//默认不展示登录组件，除非登录接口返回数据</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 当需要展示组件时，调用这个方法 默认是true 即可以展示组件</span>
		<span class="token function">showing</span><span class="token punctuation">(</span><span class="token parameter">boll<span class="token operator">=</span><span class="token boolean">true</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>login <span class="token operator">=</span> boll
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		
		<span class="token comment">// 登录的方法</span>
		<span class="token keyword">async</span> <span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// 显示其他的弹窗 登录时的反馈 弹窗</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'登录中'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token comment">/*wx.getUserProfile 获取用户信息。页面产生点击事件
			后才可调用，每次请求都会弹出授权窗口，用户同意后返回 userInfo
			 */</span>
			<span class="token comment">//新的登录接口：wx.getUserProfile</span>
			wx<span class="token punctuation">.</span><span class="token function">getUserProfile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				desc<span class="token operator">:</span> <span class="token string">'登录咯'</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				<span class="token keyword">let</span> <span class="token punctuation">{</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">}</span> <span class="token operator">=</span> res <span class="token comment">// res中包含用户的个人信息 如昵称,头像等 </span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wxusEr</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'拒绝登录或登录失败'</span><span class="token punctuation">)</span>
				<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'用户取消登录'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//登录时的反馈 弹窗</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 调用登录</span>
		<span class="token keyword">async</span> <span class="token function">wxusEr</span><span class="token punctuation">(</span><span class="token parameter">userInfo<span class="token punctuation">,</span>errMsg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
				<span class="token comment">// 微信登录逻辑</span>
				<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">wxLogin</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loGin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token comment">// 登录成功后 更新需要请求的接口或者数据 emit是传值的作用 </span>
				<span class="token comment">// mycart、cart随意命名 cart值是data data值是SUCCESS 在my-addres.vue中接收 $on</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'mycart'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>cart<span class="token operator">:</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>login <span class="token operator">=</span> <span class="token boolean">false</span>
			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">//TODO handle the exception</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>my-address.vue组件逻辑代码</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
				<span class="token comment">// 获取收货地址</span>
				<span class="token keyword">async</span> <span class="token function">getadd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token keyword">try</span><span class="token punctuation">{</span>
						<span class="token keyword">let</span> atcartdata <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gainaddurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">,</span><span class="token string">'请求到的收货地址信息'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">if</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token comment">// 需要登录 使用ref获取登录组件的节点 然后调用节点下的控制展示组件的方法showing()</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loginmen<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
							
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token comment">//TODO handle the exception</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getadd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'mycart'</span><span class="token punctuation">,</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token comment">// res就是收到的值 这里是来自于loain-oage.vue中的 cart: "SUCCESS"</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token string">'我是收到的data'</span><span class="token punctuation">)</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>cart <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 如果登录成功就	 获取收货地址</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getadd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// gainaddurl</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="获取我的收货地址数据"><a href="#获取我的收货地址数据" class="headerlink" title="获取我的收货地址数据"></a>获取我的收货地址数据</h4><p>首次获取到的数据肯定是空的，因为没有设置过地址</p>
<p><strong>对获取到的请求结果进行判断，出现errcode值就需要重新登陆，数据长度为0，展示提示新增地址的消息，最后拿到结果赋值</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		adddata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 	<span class="token comment">//存放收货地址信息</span>
		searchno<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//默认不展示提示</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 获取收货地址</span>
		<span class="token keyword">async</span> <span class="token function">getadd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
				<span class="token keyword">let</span> atcartdata <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gainaddurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">,</span><span class="token string">'请求到的收货地址信息'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 如果存在errcode值就表示没有token 没有登录</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 就需要登录 使用ref获取登录组件的节点 然后调用节点下的控制展示组件的方法showing()</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loginmen<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					<span class="token comment">// 如果data长度为0,就表示收货地址为空</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 展示提示信息</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>searchno <span class="token operator">=</span> <span class="token boolean">true</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token comment">// 登陆后拿到数据时赋值给一个数组中 </span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>adddata <span class="token operator">=</span> atcartdata<span class="token punctuation">.</span>data
					<span class="token keyword">this</span><span class="token punctuation">.</span>searchno <span class="token operator">=</span> <span class="token boolean">false</span> 	<span class="token comment">//同时隐藏提示信息</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">//TODO handle the exception</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>最终拿到数据后，遍历数据然后放到view标签中展示</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in adddata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-view"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-name"</span> @click<span class="token operator">=</span><span class="token string">"getAdd(item)"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>city <span class="token operator">+</span> item<span class="token punctuation">.</span>address<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-adding"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>mobile<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-change"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/genggai.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 新增收货地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"button-address"</span> <span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/xinzeng.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>新增收货地址<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 登录界面 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>loginpage ref<span class="token operator">=</span><span class="token string">"loginmen"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>loginpage<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果没有保存收货地址 就展示此处 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"empty-cart"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"searchno"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/search/sousuono.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>你还没有收货地址<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>然后在new-address.vue文件中，进行代码编写</strong> ：静态布局如下 主要难点是使用了 <strong>uniapp的picker</strong>选择器</p>
<p>picker：</p>
<p>从底部弹起的滚动选择器。支持五种选择器，通过mode来区分，分别是普通选择器，多列选择器，时间选择器，日期选择器，省市区选择器，默认是普通选择器。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"new-address-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 收货地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"new-address"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>收货城市<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span>  placeholder<span class="token operator">=</span><span class="token string">"请选择收货城市"</span> disabled placeholder<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">"color:#9c9c9c"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>picker mode<span class="token operator">=</span><span class="token string">"region"</span> <span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>选择城市<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>picker<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 详细地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"new-address"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>详细地址<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span>  placeholder<span class="token operator">=</span><span class="token string">"请填写详细地址"</span> placeholder<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">"color:#9c9c9c"</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 联系人 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"new-address"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>联系人<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span>  placeholder<span class="token operator">=</span><span class="token string">"请填写收货人姓名"</span> placeholder<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">"color:#9c9c9c"</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 手机号码 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"new-address"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>手机号<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"number"</span>  placeholder<span class="token operator">=</span><span class="token string">"请填写收货人手机号码"</span> placeholder<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">"color:#9c9c9c"</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 保存地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conServe adcolor"</span> <span class="token operator">&gt;</span>保存地址<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 修改地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conServe adcolor"</span>  v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!nameadd"</span><span class="token operator">&gt;</span>修改地址<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 删除地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conServe decolor"</span>  v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!nameadd"</span><span class="token operator">&gt;</span>删除<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>new<span class="token operator">-</span>address<span class="token operator">-</span>view <span class="token punctuation">{</span>
	padding<span class="token operator">:</span> <span class="token number">10</span>upx <span class="token number">30</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>new<span class="token operator">-</span>address <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>rpx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">1</span>rpx solid #f0f0f0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>new<span class="token operator">-</span>address view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">150</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>new<span class="token operator">-</span>address view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>new<span class="token operator">-</span>address view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">3</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	color<span class="token operator">:</span> #<span class="token number">4</span>cd964<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 保存 */</span>
<span class="token punctuation">.</span>conServe <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">80</span>rpx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>rpx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
	margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">30</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>adcolor <span class="token punctuation">{</span>
	background<span class="token operator">:</span> linear<span class="token operator">-</span><span class="token function">gradient</span><span class="token punctuation">(</span>to right<span class="token punctuation">,</span> #ffd300<span class="token punctuation">,</span> #e6be00<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>decolor <span class="token punctuation">{</span>
	background<span class="token operator">-</span>color<span class="token operator">:</span> red<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>在选择城市这里，添加**@change事件   – value 改变时触发 change 事件，event.detail = {value: value}**</p>
<p>然后把e里边拿到的数据赋值给city，然后将city字符串通过 v-model绑定到 input标签中，</p>
<p>其他input也通过v-model绑定数据到data中</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 收货城市 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"new-address"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>收货城市<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span>  v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"city"</span> placeholder<span class="token operator">=</span><span class="token string">"请选择收货城市"</span> disabled placeholder<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">"color:#9c9c9c"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>picker mode<span class="token operator">=</span><span class="token string">"region"</span> @change<span class="token operator">=</span><span class="token string">"regionChange"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>选择城市<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>picker<span class="token operator">&gt;</span>y
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 详细地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"new-address"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>详细地址<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"address"</span> placeholder<span class="token operator">=</span><span class="token string">"请填写详细地址"</span> placeholder<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">"color:#9c9c9c"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 联系人 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"new-address"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>联系人<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"name"</span>  placeholder<span class="token operator">=</span><span class="token string">"请填写收货人姓名"</span> placeholder<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">"color:#9c9c9c"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 手机号码 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"new-address"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>手机号<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"number"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"mobile"</span> placeholder<span class="token operator">=</span><span class="token string">"请填写收货人手机号码"</span> placeholder<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">"color:#9c9c9c"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		city<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
		address<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
		name<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
		mobile<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
    
methods<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 省市区选择  e里边包含了选择的城市数据</span>
	<span class="token function">regionChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// console.log(e.detail)</span>
		<span class="token keyword">let</span> values <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
		<span class="token comment">// 浙江省 杭州市 上城区</span>
		<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">''</span> <span class="token comment">//空字符串</span>
		values<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			str <span class="token operator">+=</span> item <span class="token operator">+</span> <span class="token string">' '</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>city <span class="token operator">=</span> str
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="新增收货地址"><a href="#新增收货地址" class="headerlink" title="新增收货地址"></a>新增收货地址</h4><p>拿到用户填写的收货地址数据后，需要点击保存地址按钮提交数据到后台，</p>
<p>在<strong>new-address.vue</strong> 中，给按钮绑定点击事件<strong>preTion( )</strong>,在事件中发起请求，声明一个对象保存需要的参数数据，作为请求的参数使用，并且请求成功和失败时候设置对应的提示弹窗，</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				city<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				address<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				name<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				mobile<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token comment">// 省市区选择  e里边包含了选择的城市数据</span>
			<span class="token function">regionChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">// console.log(e.detail)</span>
				<span class="token keyword">let</span> values <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
				<span class="token comment">// 浙江省 杭州市 上城区</span>
				<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">''</span> <span class="token comment">//空字符串</span>
				values<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					str <span class="token operator">+=</span> item <span class="token operator">+</span> <span class="token string">' '</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>city <span class="token operator">=</span> str
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
                
			<span class="token comment">// 保存并提交收货地址</span>
			<span class="token keyword">async</span> <span class="token function">preTion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'正在提交中'</span><span class="token punctuation">,</span><span class="token string">'loading'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
				
				<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
					city<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>city<span class="token punctuation">,</span>
					address<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>address<span class="token punctuation">,</span>
					name<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
					mobile<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>mobile
				<span class="token punctuation">}</span>
				<span class="token keyword">try</span><span class="token punctuation">{</span>
					<span class="token keyword">let</span> sudeadd <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sudeaddurl<span class="token punctuation">,</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sudeadd<span class="token punctuation">,</span><span class="token string">'提交保存的收货地址'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>sudeadd<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'提交成功'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
                        <span class="token comment">// 完成自动返回到上一级页面</span>
						<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
							uni<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
								data<span class="token operator">:</span> <span class="token number">1</span>
							<span class="token punctuation">}</span><span class="token punctuation">)</span>
						<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span>
						
					<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
						<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>sudeadd<span class="token punctuation">.</span>msg<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
					<span class="token punctuation">}</span>
					
					<span class="token comment">// 如果出现errcode 就表示没有登录 </span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>sudeadd<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token comment">// 就需要登录 使用ref获取登录组件的节点 然后调用节点下的控制展示组件的方法showing()</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loginmen<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
						uni<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token comment">//TODO handle the exception</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>当新增保存地址后，完成自动返回到上一级页面</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">if</span><span class="token punctuation">(</span>sudeadd<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'提交成功'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
		uni<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			data<span class="token operator">:</span> <span class="token number">1</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span>
	
<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>sudeadd<span class="token punctuation">.</span>msg<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>上一级页面 <strong>my-address.vue</strong> 中每次<strong>进入页面要刷新一下 收货地址</strong> </p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 获取收货地址</span>
		<span class="token keyword">async</span> <span class="token function">getadd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
				<span class="token keyword">let</span> atcartdata <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gainaddurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">,</span><span class="token string">'请求到的收货地址信息'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 如果存在errcode值就表示没有token 没有登录</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 就需要登录 使用ref获取登录组件的节点 然后调用节点下的控制展示组件的方法showing()</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loginmen<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					<span class="token comment">// 如果data长度为0,就表示收货地址为空</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>atcartdata<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 展示提示信息</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>searchno <span class="token operator">=</span> <span class="token boolean">true</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token comment">// 登陆后拿到数据时赋值给一个数组中 </span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>adddata <span class="token operator">=</span> atcartdata<span class="token punctuation">.</span>data
					<span class="token keyword">this</span><span class="token punctuation">.</span>searchno <span class="token operator">=</span> <span class="token boolean">false</span> 	<span class="token comment">//同时隐藏提示信息</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">//TODO handle the exception</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 点击新增收货地址按钮</span>
		<span class="token function">chAnge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				url<span class="token operator">:</span><span class="token string">'./new-address'</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// onShow生命周期 表示:无论从什么页面返回,都会再一次执行下面的方法</span>
<span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getadd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>实现收货地址的修改功能</strong></p>
<p>点击修改图标，进入修改地址页面，可以编辑和删除</p>
<p>给点击事件传递两个值，第一个001代表修改收货地址，002代表新增收货地址，第二个参数item，包含了地址的详细信息，是放到修改点击事件里</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in adddata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-view"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-name"</span> @click<span class="token operator">=</span><span class="token string">"getAdd(item)"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>city <span class="token operator">+</span> item<span class="token punctuation">.</span>address<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-adding"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>mobile<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
										<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 传值  <span class="token number">001</span>表示修改  同时将item传递过去<span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-change"</span> @click<span class="token operator">=</span><span class="token string">"chAnge('001',item)"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/genggai.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 新增收货地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 传值  <span class="token number">002</span>表示新增收货 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"button-address"</span> @click<span class="token operator">=</span><span class="token string">"chAnge('002')"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/xinzeng.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>新增收货地址<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>


<span class="token comment">// 新增收货地址 同时也修改地址  传递参数判断 点击后跳转的页面,将参数转为json字符串添加到要跳转链接后边</span>
<span class="token function">chAnge</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">'002'</span><span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> value<span class="token punctuation">,</span>data <span class="token punctuation">}</span>
	<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> 
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		url<span class="token operator">:</span><span class="token string">'./new-address?value='</span> <span class="token operator">+</span> str
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>在new-address.vue中</strong>，接收数据 同时调用获取按钮的方法，接收到的数据传入<strong>useradd</strong>方法中 从而变更data中控制v-if的值，达到显示需要的按钮，</p>
<p>同时，将数据解构出来，赋值给data中数据，即页面显示的收货地址信息填充为用户之前输入的信息</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 保存地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conServe adcolor"</span> @click<span class="token operator">=</span><span class="token string">"preTion()"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"nameadd"</span><span class="token operator">&gt;</span>保存地址<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 修改地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conServe adcolor"</span> @click<span class="token operator">=</span><span class="token string">"preTion()"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!nameadd"</span><span class="token operator">&gt;</span>修改地址<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 删除地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conServe decolor"</span> @click<span class="token operator">=</span><span class="token string">"preTion()"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!nameadd"</span><span class="token operator">&gt;</span>删除地址<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>


<span class="token comment">// 获取用户从那个按钮点击进来的</span>
<span class="token function">useradd</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 修改地址或者删除地址</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token string">'001'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>nameadd <span class="token operator">=</span> <span class="token boolean">false</span>
		<span class="token comment">// 将接收的到数据解构出来存储</span>
		<span class="token keyword">let</span> <span class="token punctuation">{</span> city<span class="token punctuation">,</span>address<span class="token punctuation">,</span>mobile<span class="token punctuation">,</span>name<span class="token punctuation">,</span>_id <span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>data
		<span class="token keyword">this</span><span class="token punctuation">.</span>city <span class="token operator">=</span> city
		<span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> address
		<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
		<span class="token keyword">this</span><span class="token punctuation">.</span>mobile <span class="token operator">=</span> mobile
		<span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> _id
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>nameadd <span class="token operator">=</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">// e 里边包含了上个组件传递的数据</span>
<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token string">'接收到上个组件的数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// JSON.parse(e.value) json字符串还原为js对象</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">useradd</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="更改删除收货地址"><a href="#更改删除收货地址" class="headerlink" title="更改删除收货地址"></a>更改删除收货地址</h4><p><strong>在new-address.vue中</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 修改地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conServe adcolor"</span> @click<span class="token operator">=</span><span class="token string">"modifyAdd()"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!nameadd"</span><span class="token operator">&gt;</span>修改地址<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 删除地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conServe decolor"</span> @click<span class="token operator">=</span><span class="token string">"deleteAdd()"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!nameadd"</span><span class="token operator">&gt;</span>删除地址<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>修改收货地址方法</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 修改收货地址</span>
<span class="token keyword">async</span> <span class="token function">modifyAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'正在修改中'</span><span class="token punctuation">,</span><span class="token string">'loading'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
	<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
		id<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span>
		city<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>city<span class="token punctuation">,</span>
		address<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>address<span class="token punctuation">,</span>
		name<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
		mobile<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>mobile<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> modifyadd <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>modifyaddurl<span class="token punctuation">,</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>modifyadd<span class="token punctuation">,</span><span class="token string">'修改收货地址'</span><span class="token punctuation">)</span>
		
		<span class="token keyword">if</span><span class="token punctuation">(</span>modifyadd<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'修改成功'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				uni<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
					data<span class="token operator">:</span> <span class="token number">1</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span>
			
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>modifyadd<span class="token punctuation">.</span>msg<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">// 如果出现errcode 就表示没有登录</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>modifyadd<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 就需要登录 使用ref获取登录组件的节点 然后调用节点下的控制展示组件的方法showing()</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loginmen<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			uni<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>删除收货地址方法</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 删除收货地址</span>
<span class="token keyword">async</span> <span class="token function">deleteAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'删除中'</span><span class="token punctuation">,</span><span class="token string">'loading'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
	<span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> deleadd <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>deleaddurl <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment">// console.log(deleadd,'删除收货地址')</span>
		
		<span class="token keyword">if</span><span class="token punctuation">(</span>deleadd<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'删除成功'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				uni<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
					data<span class="token operator">:</span> <span class="token number">1</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
			
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>deleadd<span class="token punctuation">.</span>msg<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">// 如果出现errcode 就表示没有登录</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>deleadd<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 就需要登录 使用ref获取登录组件的节点 然后调用节点下的控制展示组件的方法showing()</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loginmen<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			uni<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="商品订单页选择收货地址"><a href="#商品订单页选择收货地址" class="headerlink" title="商品订单页选择收货地址"></a>商品订单页选择收货地址</h4><p>提交订单页面 –<strong>payment.vue</strong> 给 “请选择收货地址” 添加点击事件  <strong>@click=”shAddress()**，跳转到我的收货地址 – **my-address.vue</strong>组件中</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 收货地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-name"</span> @click<span class="token operator">=</span><span class="token string">"shAddress()"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-left-img"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/address-shouhuo.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 收货地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-add"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"nameadd"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>orderdata<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>orderdata<span class="token punctuation">.</span>mobile<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>orderdata<span class="token punctuation">.</span>city <span class="token operator">+</span> orderdata<span class="token punctuation">.</span>address<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-add"</span>  v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!nameadd"</span><span class="token operator">&gt;</span>请选择收货地址<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-right-img"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/shouhuo-jiantou.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>


methods<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 选择收货地址</span>
	<span class="token function">shAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//跳转到我的收货地址 -- myaddress.vue组件中</span>
		uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			url<span class="token operator">:</span><span class="token string">'../my-address/my-addres'</span><span class="token punctuation">,</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>my-address.vue</strong>组件中，添加点击地址后的事件**@click=”getAdd(item)”**，同时拿到包含收货地址详细信息的item作为参数，</p>
<p>在方法中，调用 **this.$store.commit(‘mutaadd’,item)**，将item传入vuex的mutation中的mutaadd方法中，将item赋值给state中的addordr。</p>
<p>接着<strong>uni.navigateBack</strong> 返回上一级 <strong>payment.vue</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 新增收货地址页面 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in adddata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-view"</span><span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 设置点击地址后的点击事件 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-name"</span> @click<span class="token operator">=</span><span class="token string">"getAdd(item)"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>city <span class="token operator">+</span> item<span class="token punctuation">.</span>address<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-adding"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>mobile<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 传值  <span class="token number">001</span>表示修改  同时将item传递过去<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-address-change"</span> @click<span class="token operator">=</span><span class="token string">"chAnge('001',item)"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/genggai.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>


		
<span class="token comment">// 选中某个收货地址 携带数据返回上一级订单页面</span>
<span class="token function">getAdd</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 使用vuex传值 将这item传值到state中</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'mutaadd'</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		data<span class="token operator">:</span><span class="token number">1</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> <strong>payment.vue</strong>中设置监听器，监听<strong>state中addordr</strong>是否变化，将变化后的数据（ 即收货地址信息）赋值给 <strong>this.orderdata</strong>，</p>
<p>最后计算属性中，nameadd()方法，判断 转化为JSON字符串的<strong>this.orderdata</strong>是否为空，空的话<strong>nameadd</strong>返回false，否则true。即控制显示的是否显示请选择收货地址还是已经选择的收货地址</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">watch<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 监听vuex的收货地址数据 newValue里边就包含了vuex里的数据</span>
	<span class="token string">"$store.state.addordr"</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span><span class="token string">'监听到的新值'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>orderdata <span class="token operator">=</span> newValue<span class="token punctuation">.</span>address
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
    
computed<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 是否选择了收货地址</span>
	<span class="token function">nameadd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>orderdata<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">"{}"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token boolean">false</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token boolean">true</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="微信支付"><a href="#微信支付" class="headerlink" title="微信支付"></a>微信支付</h3><h4 id="获取支付所需数据，以及try-catch-的应用"><a href="#获取支付所需数据，以及try-catch-的应用" class="headerlink" title="获取支付所需数据，以及try{}catch{}的应用"></a>获取支付所需数据，以及try{}catch{}的应用</h4><p>payment.vue组件，<strong>点击提交订单按钮的点击事件</strong></p>
<p>代码如下：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 底部提交订单 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"place-order"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>合计<span class="token operator">:</span> ￥<span class="token punctuation">{</span><span class="token punctuation">{</span>Totalprice<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text @click<span class="token operator">=</span><span class="token string">"placeOrder()"</span><span class="token operator">&gt;</span>提交订单<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 提交订单</span>
<span class="token keyword">async</span> <span class="token function">placeOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 商品数据 通过对comminfo数据进行map方法遍历，会返回一个新的数组对象</span>
	<span class="token keyword">let</span> codata <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>comminfo<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">let</span> data <span class="token operator">=</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span>item<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
			image<span class="token operator">:</span>item<span class="token punctuation">.</span>image<span class="token punctuation">,</span>
			title<span class="token operator">:</span>item<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
			size<span class="token operator">:</span>item<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
			color<span class="token operator">:</span>item<span class="token punctuation">.</span>color<span class="token punctuation">,</span>
			price<span class="token operator">:</span>item<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
			many<span class="token operator">:</span>item<span class="token punctuation">.</span>many
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> data
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">// 准备一个对象 将请求需要的参数放入</span>
	<span class="token keyword">let</span> dataobj <span class="token operator">=</span> <span class="token punctuation">{</span>
		consignee<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>orderdata<span class="token punctuation">,</span> 		<span class="token comment">// 收货地址相关数据</span>
		commodity<span class="token operator">:</span>codata<span class="token punctuation">,</span>				<span class="token comment">// 商品相关数据</span>
		total_price<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>Totalprice<span class="token punctuation">,</span>	<span class="token comment">// 商品总价数据</span>
		idcard<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>idcard<span class="token punctuation">,</span>				<span class="token comment">// 购物车内所有商品的id相关数据</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 1.请求统一下单 接口</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> wxpayurl <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>wxpay<span class="token punctuation">,</span>dataobj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>wxpayurl<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>wxpayurl<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">"SUCCESS"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">// throw 用来捕获一个错误  如果try 中出现throw关键词，就会进入catch里面来</span>
			<span class="token keyword">throw</span> wxpayurl<span class="token punctuation">.</span>msg
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// e就是throw 捕获的错误 </span>
		<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
		<span class="token keyword">throw</span> e <span class="token comment">//如果try 中出现throw关键词，此时try catch 后边的代码将不会执行</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 2.调用微信支付接口</span>
	
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="wx-requestpayment-调起微信付款"><a href="#wx-requestpayment-调起微信付款" class="headerlink" title="wx.requestpayment()调起微信付款"></a>wx.requestpayment()调起微信付款</h4><p>payment.vue组件中，点击提交订单后。</p>
<p>原本在请求接口时，是调用<strong>wxpay</strong>接口    – var <strong>wxpay</strong> = await new this.Request(this.Urls.m().wxpay,dataobj).modepost();<br>但因为个人没有微信商户号，所以这里使用的是虚拟支付接口<strong>fictpay</strong> –let <strong>fictpay</strong> = await new this.Request(this.Urls.m().fictpay,dataobj).modepost();</p>
<p>携带参数完整时， <strong>返回结果是”SUCCESS”</strong></p>
<p><strong>methods中方法如下：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 选择收货地址</span>
<span class="token function">shAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		url<span class="token operator">:</span><span class="token string">'../my-address/my-addres'</span><span class="token punctuation">,</span>
		
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// 提交订单</span>
<span class="token keyword">async</span> <span class="token function">placeOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 商品数据 通过对comminfo数据进行map方法遍历，会返回一个新的数组对象</span>
	<span class="token keyword">let</span> codata <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>comminfo<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> data <span class="token operator">=</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span>item<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
			image<span class="token operator">:</span>item<span class="token punctuation">.</span>image<span class="token punctuation">,</span>
			title<span class="token operator">:</span>item<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
			size<span class="token operator">:</span>item<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
			color<span class="token operator">:</span>item<span class="token punctuation">.</span>color<span class="token punctuation">,</span>
			price<span class="token operator">:</span>item<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
			many<span class="token operator">:</span>item<span class="token punctuation">.</span>many<span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> data
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">// 准备一个对象 将请求需要的参数放入</span>
	<span class="token keyword">let</span> dataobj <span class="token operator">=</span> <span class="token punctuation">{</span>
		consignee<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>orderdata<span class="token punctuation">,</span> 		<span class="token comment">// 收货地址相关数据</span>
		commodity<span class="token operator">:</span>codata<span class="token punctuation">,</span>				<span class="token comment">// 商品相关数据</span>
		total_price<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>Totalprice<span class="token punctuation">,</span>	<span class="token comment">// 支付总价数据</span>
		idcard<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>idcard<span class="token punctuation">,</span>				<span class="token comment">// 购物车内所有商品的id相关数据</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 1.请求统一下单接口   </span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
						<span class="token comment">// 微信支付: 统一下单接口</span>
						<span class="token comment">// 因为个人没有认证微信商户号，这里使用的是虚拟支付接口 返回结果是"SUCCESS"</span>
		<span class="token keyword">let</span> fictpay <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fictpayurl<span class="token punctuation">,</span>dataobj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>fictpay<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">"SUCCESS"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>fictpay<span class="token punctuation">.</span>data<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">// throw 用来捕获一个错误  如果try 中出现throw关键词，就会进入catch里面来</span>
			<span class="token keyword">throw</span> fictpay<span class="token punctuation">.</span>msg
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// e就是throw 捕获的错误 </span>
		<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
		<span class="token comment">// throw e //如果try 中出现throw关键词，此时try catch 后边的代码将不会执行</span>
	<span class="token punctuation">}</span>
				
	<span class="token comment">// 2.调用微信支付接口</span>
				
	<span class="token comment">// 3.查询订单是否支付成功</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>当拥有微信商户认证时候，发起真正的请求时，</strong></p>
<p>使用 wxpay接口 – var <strong>wxpay</strong> = await new this.Request(this.Urls.m().wxpay,dataobj).modepost();</p>
<p><strong>methods中方法如下：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">methods<span class="token operator">:</span><span class="token punctuation">{</span>
    
	<span class="token comment">// 选择收货地址</span>
	<span class="token function">shAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			url<span class="token operator">:</span><span class="token string">'../my-address/my-addres'</span><span class="token punctuation">,</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 提交订单</span>
	<span class="token keyword">async</span> <span class="token function">placeOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 商品数据 通过对comminfo数据进行map方法遍历，会返回一个新的数组对象</span>
		<span class="token keyword">let</span> codata <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>comminfo<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> data <span class="token operator">=</span><span class="token punctuation">{</span>
				id<span class="token operator">:</span>item<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
				image<span class="token operator">:</span>item<span class="token punctuation">.</span>image<span class="token punctuation">,</span>
				title<span class="token operator">:</span>item<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
				size<span class="token operator">:</span>item<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
				color<span class="token operator">:</span>item<span class="token punctuation">.</span>color<span class="token punctuation">,</span>
				price<span class="token operator">:</span>item<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
				many<span class="token operator">:</span>item<span class="token punctuation">.</span>many<span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> data
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token comment">// 准备一个对象 将请求需要的参数放入</span>
		<span class="token keyword">let</span> dataobj <span class="token operator">=</span> <span class="token punctuation">{</span>
			consignee<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>orderdata<span class="token punctuation">,</span> 		<span class="token comment">// 收货地址相关数据</span>
			commodity<span class="token operator">:</span>codata<span class="token punctuation">,</span>				<span class="token comment">// 商品相关数据</span>
			total_price<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>Totalprice<span class="token punctuation">,</span>	<span class="token comment">// 支付总价数据</span>
			idcard<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>idcard<span class="token punctuation">,</span>				<span class="token comment">// 购物车内所有商品的id相关数据</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 1.请求统一下单接口   </span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
			<span class="token comment">// 微信支付: 统一下单接口</span>
			<span class="token keyword">var</span> wxpay <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>wxpay<span class="token punctuation">,</span>dataobj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>wxpay<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">"SUCCESS"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 存储商户订单号和订单id</span>
				 <span class="token keyword">this</span><span class="token punctuation">.</span>outno <span class="token operator">=</span> wxpayurl<span class="token punctuation">.</span>data<span class="token punctuation">.</span>out_trade_no
				 <span class="token keyword">this</span><span class="token punctuation">.</span>ide <span class="token operator">=</span> wxpayurl<span class="token punctuation">.</span>data<span class="token punctuation">.</span>id
				<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>wxpay<span class="token punctuation">.</span>data<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
				
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token comment">// throw 用来捕获一个错误  如果try 中出现throw关键词，就会进入catch里面来</span>
				<span class="token keyword">throw</span> wxpay<span class="token punctuation">.</span>msg
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// e就是throw 捕获的错误 </span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
			<span class="token keyword">throw</span> e <span class="token comment">//如果try 中出现throw关键词，此时try catch 后边的代码将不会执行即不会调用下边的微信接口</span>
		<span class="token punctuation">}</span>
				
		<span class="token comment">// 2.调用微信支付接口</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
			<span class="token comment">// package：属于源码里的关键词 因此这个参数不能解构使用 而是：package:wxpay.data.package</span>
			<span class="token comment">// 从真正的微信支付接口中拿到返回结果，这4（5）个数据用于调用微信支付接口时作为参数，</span>
			<span class="token keyword">let</span> <span class="token punctuation">{</span> nonceStr<span class="token punctuation">,</span>paySign<span class="token punctuation">,</span>signType<span class="token punctuation">,</span>timeStamp <span class="token punctuation">}</span> <span class="token operator">=</span> wxpay<span class="token punctuation">.</span>data
			<span class="token comment">// 使用下方调用支付的方法 wxPay(payment)</span>
			<span class="token keyword">let</span> wxpay <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wxPay</span><span class="token punctuation">(</span><span class="token punctuation">{</span> nonceStr<span class="token punctuation">,</span>paySign<span class="token punctuation">,</span>signType<span class="token punctuation">,</span>timeStamp<span class="token punctuation">,</span><span class="token keyword">package</span><span class="token operator">:</span>wxpay<span class="token punctuation">.</span>data<span class="token punctuation">.</span>package <span class="token punctuation">}</span><span class="token punctuation">)</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>wxpay<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'支付失败'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
			<span class="token keyword">throw</span> e
		<span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 调用支付的方法：包装一个promise</span>
    <span class="token comment">//  payment就是接收到的5个数据，用于调用微信支付接口的参数</span>
	<span class="token function">wxPay</span><span class="token punctuation">(</span><span class="token parameter">payment</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			wx<span class="token punctuation">.</span><span class="token function">requestpayment</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				<span class="token operator">...</span>payment<span class="token punctuation">,</span>
				<span class="token function-variable function">success</span><span class="token operator">:</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
					<span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token function-variable function">fail</span><span class="token operator">:</span><span class="token parameter">Error</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
					<span class="token function">reject</span><span class="token punctuation">(</span>Error<span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="查询订单是否支付成功"><a href="#查询订单是否支付成功" class="headerlink" title="查询订单是否支付成功"></a>查询订单是否支付成功</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 3.查询订单是否支付成功 （去微信那边查询是否成功）</span>

<span class="token keyword">try</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> dataobj <span class="token operator">=</span> <span class="token punctuation">{</span>outno<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>outno<span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>ide<span class="token punctuation">}</span>
	<span class="token keyword">let</span> queryorderurl <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>queryorderurl<span class="token punctuation">,</span>dataobj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>queryorderurl<span class="token punctuation">.</span>data<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'支付成功'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">throw</span> <span class="token string">'支付失败'</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="动态路由跳转详情页"><a href="#动态路由跳转详情页" class="headerlink" title="动态路由跳转详情页"></a>动态路由跳转详情页</h4><p>在pages.json文件中，将首页排到首位</p>
<ul>
<li><p><strong>完成轮播页</strong>，点击图片跳转到对应页面功能</p>
</li>
<li><p>在pages/index/sonzhujian/<strong>swipers.vue</strong>下,添加点击事件 <strong>deTails(item._id)</strong></p>
<p><strong>deTails( item._id ）</strong>这里的 <strong>_id</strong> 就是通过轮播接口，返回的成功数据中的_id ，表示商品的唯一标识</p>
</li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>swiper<span class="token operator">-</span>item<span class="token operator">&gt;</span>
    <span class="token comment">//这里的 _id 就是通过轮播接口，返回的成功数据中的_id表示商品的唯一标识</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"swiper-item"</span> @click<span class="token operator">=</span><span class="token string">"deTails(item._id)"</span><span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> mode 图片裁剪、缩放的模式  <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>img <span class="token operator">:</span>src<span class="token operator">=</span>item<span class="token punctuation">.</span>image mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>swiper<span class="token operator">-</span>item<span class="token operator">&gt;</span>

<span class="token comment">// 跳转到详情页</span>
<span class="token function">deTails</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token comment">// 跳转到详情页组件，同时携带商品id参数</span>
		url<span class="token operator">:</span><span class="token string">'../details/details?id='</span> <span class="token operator">+</span> id
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<ul>
<li><strong>完成快抢购页</strong>，点击图片跳转到对应页面功能</li>
<li>在pages/index/sonzhujian/<strong>purchhase.vue</strong>下,添加点击事件 <strong>deTails(item._id)</strong></li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pur-img"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in recomdata[0].image"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.img"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> @click<span class="token operator">=</span><span class="token string">"daTails(item._id)"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 跳转到详情页</span>
<span class="token function">deTails</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token comment">// 跳转到详情页组件，同时携带商品id参数</span>
		url<span class="token operator">:</span><span class="token string">'../details/details?id='</span> <span class="token operator">+</span> id
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<ul>
<li><strong>完成天猫榜单页</strong>，点击图片跳转到对应页面功能</li>
<li>在pages/index/sonzhujian/<strong>list.vue</strong>下,添加点击事件 <strong>deTails(item._id)</strong></li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item, index) in billdata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"menb"</span> @click<span class="token operator">=</span><span class="token string">"deTails(item._id)"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>title <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>want <span class="token punctuation">}</span><span class="token punctuation">}</span>人想要<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>

<span class="token comment">// 跳转到详情页</span>
<span class="token function">deTails</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token comment">// 跳转到详情页组件，同时携带商品id参数</span>
		url<span class="token operator">:</span><span class="token string">'../details/details?id='</span> <span class="token operator">+</span> id
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<ul>
<li><strong>完成卡片流页</strong>，点击图片跳转到对应页面功能</li>
<li>在pages/commponents/<strong>card.vue</strong>下,添加点击事件 <strong>deTails(item._id)</strong></li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in commdata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comm-card"</span> @click<span class="token operator">=</span><span class="token string">"deTails(item._id)"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comm-img"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comm-title"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comm-left"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>freight<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>预计<span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>Duration<span class="token punctuation">}</span><span class="token punctuation">}</span>h发货<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comm-right"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>Price<span class="token punctuation">}</span><span class="token punctuation">}</span>￥<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>

<span class="token comment">// 跳转到详情页</span>
<span class="token function">deTails</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token comment">// 跳转到详情页组件，同时携带商品id参数</span>
		url<span class="token operator">:</span><span class="token string">'../details/details?id='</span> <span class="token operator">+</span> id
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>完成右上角按钮的返回功能</strong></p>
<p>进入pages/details/<strong>details.vue文件</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 返回按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"header-fixed backno"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"showAbs"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 箭头符号设置的动态的高 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"status_bar"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"'height: ' + tophight.top + 'px;'"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"navs-image"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"'height: ' + tophight.height + 'px;'"</span> @click<span class="token operator">=</span><span class="token string">"pageRe()"</span> <span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/fanhuibai.jpg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 返回上级页面 按钮</span>
<span class="token function">pageRe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		data<span class="token operator">:</span><span class="token number">1</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>同时给top.vue组件中的左上角按钮 也设置点击事件</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"navs-image"</span> <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">" 'height:'+ tophight.height + 'px;'"</span>  @click<span class="token operator">=</span><span class="token string">"pageRe()"</span> <span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/fanhuihei.png"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 返回上级页面 按钮</span>
<span class="token function">pageRe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		data<span class="token operator">:</span><span class="token number">1</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="个人中心页面"><a href="#个人中心页面" class="headerlink" title="个人中心页面"></a>个人中心页面</h3><p><strong>静态布局</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-view"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-view-user"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image  src<span class="token operator">=</span><span class="token string">"/static/details/weidenglu.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-view-name"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>button  plain<span class="token operator">=</span><span class="token string">"true"</span> open<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">"getUserInfo"</span> @click<span class="token operator">=</span><span class="token string">"getUserInfo()"</span><span class="token operator">&gt;</span>点击登录<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span> 
	
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 菜单 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-menu"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in datas"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.img"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				datas<span class="token operator">:</span><span class="token punctuation">[</span>
					<span class="token punctuation">{</span>
						<span class="token string">'img'</span><span class="token operator">:</span><span class="token string">'/static/details/daifukuan.svg'</span><span class="token punctuation">,</span>
						<span class="token string">'name'</span><span class="token operator">:</span><span class="token string">'待付款'</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token punctuation">{</span>
						<span class="token string">'img'</span><span class="token operator">:</span><span class="token string">'/static/details/daifahuo.svg'</span><span class="token punctuation">,</span>
						<span class="token string">'name'</span><span class="token operator">:</span><span class="token string">'待发货'</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token punctuation">{</span>
						<span class="token string">'img'</span><span class="token operator">:</span><span class="token string">'/static/details/daishouhuo.svg'</span><span class="token punctuation">,</span>
						<span class="token string">'name'</span><span class="token operator">:</span><span class="token string">'待收货'</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token punctuation">{</span>
						<span class="token string">'img'</span><span class="token operator">:</span><span class="token string">'/static/details/daipingjia.svg'</span><span class="token punctuation">,</span>
						<span class="token string">'name'</span><span class="token operator">:</span><span class="token string">'待评价'</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">]</span><span class="token punctuation">,</span>
				usering<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
				userdata<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>


<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>view<span class="token punctuation">{</span>
background<span class="token operator">:</span> linear<span class="token operator">-</span><span class="token function">gradient</span><span class="token punctuation">(</span>to top<span class="token punctuation">,</span> #ff0714 <span class="token number">10</span><span class="token operator">%</span><span class="token punctuation">,</span> #ff3388 <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">500</span>upx<span class="token punctuation">;</span>
border<span class="token operator">-</span>bottom<span class="token operator">-</span>left<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
border<span class="token operator">-</span>bottom<span class="token operator">-</span>right<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
position<span class="token operator">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>view<span class="token operator">-</span>user<span class="token punctuation">{</span>height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
position<span class="token operator">:</span> absolute<span class="token punctuation">;</span>
left<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
top<span class="token operator">:</span> <span class="token number">170</span>upx<span class="token punctuation">;</span>
<span class="token comment">/* width: 100%; */</span>
color<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>view<span class="token operator">-</span>user text<span class="token punctuation">{</span>display<span class="token operator">:</span> block<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>view<span class="token operator">-</span>user image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span> border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>view<span class="token operator">-</span>user view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>view<span class="token operator">-</span>name text<span class="token punctuation">{</span>font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">32</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>view<span class="token operator">-</span>name button<span class="token punctuation">{</span>border<span class="token operator">:</span> none<span class="token punctuation">;</span>font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">32</span>upx<span class="token punctuation">;</span>
color<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>view<span class="token operator">-</span>name<span class="token punctuation">{</span>padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>menu<span class="token punctuation">{</span>height<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span> background<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
position<span class="token operator">:</span> absolute<span class="token punctuation">;</span>
top<span class="token operator">:</span> <span class="token number">350</span>upx<span class="token punctuation">;</span>
left<span class="token operator">:</span> <span class="token number">35</span>upx<span class="token punctuation">;</span>
right<span class="token operator">:</span> <span class="token number">35</span>upx<span class="token punctuation">;</span>
border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token comment">/* margin: 0 35upx; */</span>
box<span class="token operator">-</span>shadow<span class="token operator">:</span> <span class="token number">0</span>upx <span class="token number">10</span>rpx <span class="token number">10</span>rpx #e9e9e9<span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>around<span class="token punctuation">;</span>
font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>menu image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">45</span>upx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">45</span>upx<span class="token punctuation">;</span>
display<span class="token operator">:</span> block<span class="token punctuation">;</span>
align<span class="token operator">-</span>self<span class="token operator">:</span> center<span class="token punctuation">;</span>
padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>my<span class="token operator">-</span>menu view<span class="token punctuation">{</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>当本地存在token时候，显示个人信息：</p>
<p><strong>使用v-if 和 v-else来判断头像和个人名称的显示</strong></p>
<p>取出本地token，如果取不到就显示请登录，取到数据吧表示已经登录，则显示个人头像和名称</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-view-user"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"usering"</span> src<span class="token operator">=</span><span class="token string">"/static/details/weidenglu.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image v<span class="token operator">-</span><span class="token keyword">else</span> <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"userdata.avatarUrl"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"my-view-name"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>button v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"usering"</span> plain<span class="token operator">=</span><span class="token string">"true"</span> open<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">"getUserInfo"</span> @click<span class="token operator">=</span><span class="token string">"getUserInfo()"</span><span class="token operator">&gt;</span>点击登录<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text v<span class="token operator">-</span><span class="token keyword">else</span> <span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>userdata<span class="token punctuation">.</span>nickName<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span> 

methods<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">// 取出本地</span>
	<span class="token function">ifUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> user <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'wxuser'</span><span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>usering <span class="token operator">=</span> <span class="token boolean">true</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>usering <span class="token operator">=</span> <span class="token boolean">false</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>userdata <span class="token operator">=</span> user
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ifUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>当本地没有token时，点击按钮登录事件</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>button v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"usering"</span> plain<span class="token operator">=</span><span class="token string">"true"</span> open<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">"getUserInfo"</span> @click<span class="token operator">=</span><span class="token string">"getUserInfo()"</span><span class="token operator">&gt;</span>点击登录<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>


<span class="token comment">// 引入 微信登录逻辑</span>
<span class="token keyword">import</span> wxLogin <span class="token keyword">from</span> <span class="token string">'../../login/login.js'</span>

<span class="token comment">// 触发登录事件</span>
<span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 显示其他的弹窗 登录时的反馈 弹窗</span>
	<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'登录中'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">/*wx.getUserProfile 获取用户信息。页面产生点击事件
	后才可调用，每次请求都会弹出授权窗口，用户同意后返回 userInfo
	 */</span>
	<span class="token comment">//新的登录接口：wx.getUserProfile</span>
	wx<span class="token punctuation">.</span><span class="token function">getUserProfile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		desc<span class="token operator">:</span> <span class="token string">'登录咯'</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> <span class="token punctuation">{</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">}</span> <span class="token operator">=</span> res <span class="token comment">// res中包含用户的个人信息 如昵称,头像等 </span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wxusEr</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'拒绝登录或登录失败'</span><span class="token punctuation">)</span>
		<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'用户取消登录'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//登录时的反馈 弹窗</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// 调用登录</span>
<span class="token keyword">async</span> <span class="token function">wxusEr</span><span class="token punctuation">(</span><span class="token parameter">userInfo<span class="token punctuation">,</span>errMsg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token comment">// 微信登录逻辑</span>
		<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">wxLogin</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loGin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ifUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">//登录成功后刷新一下本组件</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="订单中心页面"><a href="#订单中心页面" class="headerlink" title="订单中心页面"></a>订单中心页面</h3><p><strong>需求：点击待付款或者待发货应该跳转到订单中心</strong></p>
<p>在pages/新建 personal文件夹/<strong>personal.vue</strong></p>
<p><strong>静态布局</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"choice-tips"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item, index) in datas"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果下标index 等于 num值，就让当前下标对应的标签拥有 activetext css属性 <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{ activetext: index == num }"</span> @click<span class="token operator">=</span><span class="token string">"menubtn(index)"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"choice-content"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>Tobepaid v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"num == 0 ? true : false"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Tobepaid<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>Deliverde v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"num == 1 ? true : false"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Deliverde<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>Received v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"num == 2 ? true : false"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Received<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>Evaluated v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"num == 3 ? true : false"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Evaluated<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			num<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
			datas<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'待付款'</span><span class="token punctuation">,</span> <span class="token string">'待发货'</span><span class="token punctuation">,</span> <span class="token string">'待收货'</span><span class="token punctuation">,</span> <span class="token string">'待评价'</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token function">menubtn</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> index<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> e<span class="token punctuation">.</span>index<span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
page <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #eeeeee<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>choice<span class="token operator">-</span>tips <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #d9ffe7<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>around<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">6</span>d6d6d<span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>upx<span class="token punctuation">;</span>
	position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
	top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>choice<span class="token operator">-</span>tips text <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>activetext <span class="token punctuation">{</span>
	color<span class="token operator">:</span> #fe0036 <span class="token operator">!</span>important<span class="token punctuation">;</span>
	border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">4</span>upx solid #fe0036<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>choice<span class="token operator">-</span>content <span class="token punctuation">{</span>
	margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>针对订单中心的四个板块，分别创建子组件</strong></p>
<p>在pages/personal/创建 sonzujian文件夹,</p>
<p>在sonzujian文件夹下新建 待付款组件 <strong>tobepaid.vue</strong>、待发货组件 <strong>delivered.vue</strong>、待收货组件 <strong>received.vue</strong>、待评价组件 <strong>evaluated.vue</strong></p>
<p><strong>通过 三元表达式，对num值是否等于index值作判断，从而显示或隐藏子组件</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 展示子组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"choice-content"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 显示的条件是 num的值是否和当前的index下标对上 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Tobepaid v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"num == 0 ? true : false"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Tobepaid<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Delivered v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"num == 1 ? true : false"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Delivered<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Received v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"num == 2 ? true : false"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Received<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Evaluated v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"num == 3 ? true : false"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Evaluated<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 引入子组件</span>
<span class="token keyword">import</span>  tobepaid <span class="token keyword">from</span> <span class="token string">'./sonzujian/tobepaid.vue'</span>
<span class="token keyword">import</span>  delivered <span class="token keyword">from</span> <span class="token string">'./sonzujian/delivered.vue'</span>
<span class="token keyword">import</span>  received <span class="token keyword">from</span> <span class="token string">'./sonzujian/received.vue'</span>
<span class="token keyword">import</span>  evaluated <span class="token keyword">from</span> <span class="token string">'./sonzujian/evaluated.vue'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="获取待付款订单"><a href="#获取待付款订单" class="headerlink" title="获取待付款订单"></a>获取待付款订单</h4><p><strong>tobepaid 静态布局代码</strong>：</p>
<p>css样式 引入的是style里的公共样式 </p>
<p>没有商户号是无法拿到待付款数据</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 待付款组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-view"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-commodity"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-tips"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"item.expire"</span><span class="token operator">&gt;</span>该订单已过期<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-tips"</span> v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">&gt;</span>等待买家付款<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order-img"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"iteming.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span>图片<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-title"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>标题<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>颜色<span class="token operator">:</span>黑色<span class="token punctuation">;</span>尺码<span class="token operator">:</span><span class="token constant">L</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-flex"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-price"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>￥<span class="token number">0.6</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>x2<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 价格 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-Price"</span><span class="token operator">&gt;</span>需付款￥<span class="token number">1.2</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 付款 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-payment"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>付款<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 登录界面弹窗 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>loginpage ref<span class="token operator">=</span><span class="token string">"loginmen"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>loginpage<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token comment">// 引入公共样式</span>
	<span class="token keyword">import</span> <span class="token string">'../../../style/order.css'</span>
	
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">{</span>
				
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token comment">// 获取待付款数据</span>
			<span class="token keyword">async</span> <span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">try</span><span class="token punctuation">{</span>
					<span class="token keyword">let</span> topebaid <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>topebaidurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 如果没有添加购物数据</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>topebaid <span class="token operator">==</span> <span class="token string">'Not Found'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'没有商户号，不会有待付款数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
					
					
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>假如有商户号代码如下</strong></p>
<p>（使用一些假数组数据）</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 待付款组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-view"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 遍历商品条数和数据 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in topebaid"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-commodity"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 两种情况：<span class="token number">1</span>、订单没有过期时候，俩小时内发起付款没有支付，俩小时内可以再次付款，<span class="token number">2</span>、俩小时之后就不能再付款了，商品显示该订单已过期 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-tips"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"item.expire"</span><span class="token operator">&gt;</span>该订单已过期<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-tips"</span> v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">&gt;</span>等待买家付款<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 遍历商品里面 因为可能支付时候不止一个商品 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(iteming,indexs) in item.order"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"indexs"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order"</span><span class="token operator">&gt;</span>
			
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order-img"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"iteming.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-title"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>iteming<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>颜色<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>iteming<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>尺码<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>iteming<span class="token punctuation">.</span>size<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-flex"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-price"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>￥<span class="token punctuation">{</span><span class="token punctuation">{</span>iteming<span class="token punctuation">.</span>price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>x<span class="token punctuation">{</span><span class="token punctuation">{</span>iteming<span class="token punctuation">.</span>many<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 价格 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-Price"</span><span class="token operator">&gt;</span>需付款￥<span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>total_price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 付款 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-payment"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果过期，就显示删除订单 否则可以付款<span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"item.expire"</span><span class="token operator">&gt;</span>删除订单<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">&gt;</span>付款<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 没有订单数据 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>ordering ref<span class="token operator">=</span><span class="token string">"orderload"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ordering<span class="token operator">&gt;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 登录界面弹窗 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>loginpage ref<span class="token operator">=</span><span class="token string">"loginmen"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>loginpage<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token comment">// 引入公共样式</span>
	<span class="token keyword">import</span> <span class="token string">'../../../style/order.css'</span>
	
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">{</span>
				topebaid<span class="token operator">:</span><span class="token punctuation">[</span>
					<span class="token punctuation">{</span>
						expire<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>	
						total_price<span class="token operator">:</span><span class="token number">169</span><span class="token punctuation">,</span>
						order<span class="token operator">:</span>
						<span class="token punctuation">[</span>
							<span class="token punctuation">{</span>
								color<span class="token operator">:</span><span class="token string">'5526网面-天空蓝'</span><span class="token punctuation">,</span>
								image<span class="token operator">:</span><span class="token string">"http://h.thexxdd.cn/tianmao/public%5Cuploads%5C1606059327494-4142549.jpg"</span><span class="token punctuation">,</span>
								many<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
								price<span class="token operator">:</span><span class="token number">169</span><span class="token punctuation">,</span>
								size<span class="token operator">:</span><span class="token string">"37"</span><span class="token punctuation">,</span>
								title<span class="token operator">:</span><span class="token string">"耐克新款2022 女生白色皮面鞋子高级【店长推荐】"</span>
							<span class="token punctuation">}</span><span class="token punctuation">,</span>
						<span class="token punctuation">]</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token punctuation">{</span>
						expire<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>	
						total_price<span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
						order<span class="token operator">:</span>
						<span class="token punctuation">[</span>
							<span class="token punctuation">{</span>
								color<span class="token operator">:</span><span class="token string">'5526网面-渣渣灰'</span><span class="token punctuation">,</span>
								image<span class="token operator">:</span><span class="token string">"http://h.thexxdd.cn/tianmao/public%5Cuploads%5C1606059327494-4142549.jpg"</span><span class="token punctuation">,</span>
								many<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
								price<span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
								size<span class="token operator">:</span><span class="token string">"41"</span><span class="token punctuation">,</span>
								title<span class="token operator">:</span><span class="token string">"361新款2022 男生灰色皮面鞋子【店长推荐】"</span>
							<span class="token punctuation">}</span><span class="token punctuation">,</span>
						<span class="token punctuation">]</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					
				<span class="token punctuation">]</span><span class="token punctuation">,</span> 
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token comment">// 获取待付款数据</span>
			<span class="token keyword">async</span> <span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">try</span><span class="token punctuation">{</span>
					<span class="token keyword">let</span> topebaid <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>topebaidurl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 如果没有添加购物数据</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>topebaid <span class="token operator">==</span> <span class="token string">'Not Found'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'没有商户号，不会有待付款数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token comment">// 如果未登录 调用登录弹窗</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>topebaid<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loginmen<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					<span class="token comment">// 如果登录成功后</span>
					<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>topebaid<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token comment">// 没有待付款数据</span>
						<span class="token keyword">if</span><span class="token punctuation">(</span>topebaid<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							
						<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>topebaid <span class="token operator">=</span> topebaid<span class="token punctuation">.</span>data
							
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
					
					
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
					
					
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 接收登录组件传递的值 登录成功后也要刷新数据</span>
		<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'mycart'</span><span class="token punctuation">,</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				<span class="token comment">// 当登录成功后</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>cart <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token comment">// 调用方法刷新数据</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="订单的详情页"><a href="#订单的详情页" class="headerlink" title="订单的详情页"></a>订单的详情页</h4><p><strong>准备一个没有订单时候，页面的展示效果提示</strong></p>
<p><strong>pages/commponents **下新建 **ordering.vue</strong>，</p>
<p><strong>静态布局</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 没有订单数据 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"empty-cart"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"emcart"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"http://h.thexxdd.cn/video/tianmao/noorder.png"</span> mode<span class="token operator">=</span><span class="token string">"aspectFit"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>没有相关订单数据<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			emcart<span class="token operator">:</span> <span class="token boolean">false</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">od<span class="token operator">=</span><span class="token boolean">true</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>emcart <span class="token operator">=</span> od
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>在 tobepaid.vue组件中引入，</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 没有订单数据 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>ordering ref<span class="token operator">=</span><span class="token string">"orderload"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ordering<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<p><strong>接着开始新建目录 放订单详情</strong>，因为详情是对于四个板块都类似布局所以抽出到单独文件夹</p>
<p><strong>pages</strong>下新建 <strong>order-details</strong>文件夹，其下新建<strong>order.vue</strong>文件，记得去pages.json中注册</p>
<p><strong>静态布局</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 订单详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-details-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>等待买家付款<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"http://h.thexxdd.cn/video/tianmao/001.webp"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-details-address"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/address-shouhuo.svg"</span> mode<span class="token operator">=</span><span class="token string">"aspectFit"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-details-name"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>马云 <span class="token number">10086</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>四川省成都市 阿里巴巴<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-commodity pay-border"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-tips tips-import"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order-img"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"http://h.thexxdd.cn/tianmao/public%5Cuploads%5C1606059327494-4142549.jpg"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-title"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>商品标题<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>颜色<span class="token operator">:</span>黑色<span class="token punctuation">;</span>尺码<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-flex"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-price"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>￥ <span class="token number">100</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>x1<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 价格 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-Price"</span><span class="token operator">&gt;</span>需付款￥<span class="token number">100</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 订单编号 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-number"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>订单编号<span class="token operator">:</span> <span class="token number">123456</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>创建时间<span class="token operator">:</span> <span class="token number">2022</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-details-play"</span> <span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>右下角按钮<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token string">'../../style/order.css'</span>
<span class="token keyword">import</span> <span class="token string">'../../style/order-details.css'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			values<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
			orderdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>然后回到订单中心 <strong>personal.vue</strong></p>
<p>设置点击商品跳转到商品详情页，如果订单过期无法点击！</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">										<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 不存在订单过期的数据才能点击 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order"</span> @click<span class="token operator">=</span><span class="token string">"!item.expire &amp;&amp; payDetail()"</span><span class="token operator">&gt;</span>
    
<span class="token comment">// 跳转到商品详情页</span>
<span class="token function">payDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		url<span class="token operator">:</span><span class="token string">'../order-details/order'</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>因为待付款、待发货、待收货三个板块的详情页也有不同之处，所以需要一些数据进行动态传值</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 跳转到商品详情页</span>
<span class="token function">payDetail</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 准备一个对象传入 ，不能直接从路径携带过去</span>
	<span class="token keyword">let</span> tip <span class="token operator">=</span> <span class="token punctuation">{</span>
		tips<span class="token operator">:</span><span class="token string">'等待买家付款'</span><span class="token punctuation">,</span>
		sum<span class="token operator">:</span><span class="token string">'需付款'</span><span class="token punctuation">,</span>
		show<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是否展示付款按钮</span>
		text<span class="token operator">:</span><span class="token string">'付款'</span><span class="token punctuation">,</span>
		id<span class="token operator">:</span>id
	<span class="token punctuation">}</span>
	<span class="token comment">// 将对象数据转化成json字符串 然后传入到跳转的组件里</span>
	<span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>tip<span class="token punctuation">)</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		url<span class="token operator">:</span><span class="token string">'../order-details/order?value='</span> <span class="token operator">+</span> value
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>商品详情组件中<strong>，order.vue</strong> 在onload接收数据 </p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// e 接收tobepaid.vue组件 跳转过来时携带的数据</span>
<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 将数据转化为js对象</span>
	<span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>values <span class="token operator">=</span> value <span class="token comment">//接收值然后遍历</span>
	
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>tobepaid.vue 组件 完整代码如下：</strong></p>
<p>因为是没有商户号的购买数据，无法拿到相关数据<br> 因此自己创建一个假数组对象<strong>当作拿到的tobedetail接口数据</strong></p>
<p>然后将数据进行几次遍历到相应位置上</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 订单详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-details-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>values<span class="token punctuation">.</span>tips<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"http://h.thexxdd.cn/video/tianmao/001.webp"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-details-address"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/address-shouhuo.svg"</span> mode<span class="token operator">=</span><span class="token string">"aspectFit"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-details-name"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in orderdata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>consignee<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>consignee<span class="token punctuation">.</span>mobile<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>consignee<span class="token punctuation">.</span>city<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>consignee<span class="token punctuation">.</span>address<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(items,indexs) in orderdata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"indexs"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-commodity pay-border"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-tips tips-import"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(itemimg,indexss) in items.order"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"indexss"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order-img"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"itemimg.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-title"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>itemimg<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>颜色<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>itemimg<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>尺码<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>itemimg<span class="token punctuation">.</span>size<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-flex"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-price"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>￥<span class="token punctuation">{</span><span class="token punctuation">{</span>itemimg<span class="token punctuation">.</span>price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>x<span class="token punctuation">{</span><span class="token punctuation">{</span>itemimg<span class="token punctuation">.</span>many<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 价格 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-Price"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>values<span class="token punctuation">.</span>sum<span class="token punctuation">}</span><span class="token punctuation">}</span>￥<span class="token punctuation">{</span><span class="token punctuation">{</span>items<span class="token punctuation">.</span>total_price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 订单编号 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-number"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in orderdata"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>订单编号<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>order_number<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>创建时间<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>time<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-details-play"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"values.sum"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>values<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token string">'../../style/order.css'</span>
<span class="token keyword">import</span> <span class="token string">'../../style/order-details.css'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			<span class="token comment">// 准备空对象，接收tobepaid.vue组件 跳转过来时携带的数据</span>
			values<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
			orderdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 请求商品数据的方法</span>
			<span class="token keyword">async</span> <span class="token function">tobedetail</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">try</span><span class="token punctuation">{</span>
					<span class="token keyword">let</span> tobedetail <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tobedetail <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 此处因为是没有商户号的购买数据，无法拿到相关数据</span>
					<span class="token comment">// 因此自己创建一个假数组对象当作拿到的tobedetail数据</span>
					<span class="token keyword">let</span> tobedetails <span class="token operator">=</span> <span class="token punctuation">[</span>
						<span class="token punctuation">{</span>
							consignee<span class="token operator">:</span><span class="token punctuation">{</span>
								address<span class="token operator">:</span><span class="token string">"阿里巴巴"</span><span class="token punctuation">,</span>
								city<span class="token operator">:</span><span class="token string">"四川省 成都市 高新区"</span><span class="token punctuation">,</span>
								mobile<span class="token operator">:</span><span class="token string">"15858588888"</span><span class="token punctuation">,</span>
								name<span class="token operator">:</span><span class="token string">"马云"</span><span class="token punctuation">,</span>	
							<span class="token punctuation">}</span><span class="token punctuation">,</span>
							nonceStr<span class="token operator">:</span><span class="token string">"yybvvcyP6CDZ08E4"</span><span class="token punctuation">,</span>
							order<span class="token operator">:</span><span class="token punctuation">[</span>
								<span class="token punctuation">{</span>
									color<span class="token operator">:</span><span class="token string">'5526网面-天空蓝'</span><span class="token punctuation">,</span>
									image<span class="token operator">:</span><span class="token string">"http://h.thexxdd.cn/tianmao/public%5Cuploads%5C1606059327494-4142549.jpg"</span><span class="token punctuation">,</span>
									many<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
									price<span class="token operator">:</span><span class="token number">169</span><span class="token punctuation">,</span>
									size<span class="token operator">:</span><span class="token string">"37"</span><span class="token punctuation">,</span>
									title<span class="token operator">:</span><span class="token string">"耐克新款2022 女生白色皮面鞋子高级【店长推荐】"</span>
								<span class="token punctuation">}</span><span class="token punctuation">,</span>
							<span class="token punctuation">]</span><span class="token punctuation">,</span>
							order_number<span class="token operator">:</span><span class="token string">"1607585433768778712"</span><span class="token punctuation">,</span>
							out_trade_no<span class="token operator">:</span><span class="token string">"2zmCzfDZe6Zr8rKYCz43AbXEe2Kk2Pcs"</span><span class="token punctuation">,</span>
							<span class="token keyword">package</span><span class="token operator">:</span><span class="token string">"prepay_id=wx101530337150731019fc4f4e85085f0000"</span><span class="token punctuation">,</span>
							paySign<span class="token operator">:</span><span class="token string">"C0E5435D1E89E2562048740360E37201"</span><span class="token punctuation">,</span>
							signType<span class="token operator">:</span><span class="token string">"MD5"</span><span class="token punctuation">,</span>
							time<span class="token operator">:</span><span class="token string">"2022-07-15 16:46:00"</span><span class="token punctuation">,</span>
							timeStamp<span class="token operator">:</span><span class="token string">"1657874760"</span><span class="token punctuation">,</span>
							total_price<span class="token operator">:</span><span class="token number">169</span><span class="token punctuation">,</span>
							_id<span class="token operator">:</span><span class="token string">"5fd1ce998c16885a1972d20b"</span><span class="token punctuation">,</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">]</span>
					tobedetail<span class="token punctuation">.</span>data <span class="token operator">=</span> tobedetails
					<span class="token keyword">this</span><span class="token punctuation">.</span>orderdata <span class="token operator">=</span> tobedetail<span class="token punctuation">.</span>data
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
					
					
					<span class="token comment">//TODO handle the exception</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// e 接收tobepaid.vue组件 跳转过来时携带的数据</span>
	<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 将数据转化为js对象</span>
		<span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>values <span class="token operator">=</span> value
		<span class="token comment">// 调用请求方法</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">tobedetail</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
		
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="待付款再次付款（上）"><a href="#待付款再次付款（上）" class="headerlink" title="待付款再次付款（上）"></a>待付款再次付款（上）</h4><p>在public文件夹中新建 payment.js</p>
<p><strong>封装一个类，用于待付款的付款请求</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 用于待付款的付款请求</span>

<span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">'../api/api.js'</span>
<span class="token keyword">import</span> urls <span class="token keyword">from</span> <span class="token string">'../api/request.js'</span>

<span class="token comment">// 待付款</span>
<span class="token keyword">class</span> <span class="token class-name">Payment</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">payment</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>payment <span class="token operator">=</span> payment
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 1、拉起付款， </span>
	<span class="token function">paySuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
			<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wxPay</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">throw</span> e
		<span class="token punctuation">}</span>
		
		<span class="token comment">// 2、查询订单</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> queryorder <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">request</span><span class="token punctuation">(</span>urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>queryorderurl，<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> queryorder
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token string">'支付失败'</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 调用微信支付</span>
	<span class="token function">wxPay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">{</span>
			wx<span class="token punctuation">.</span><span class="token function">requestPayment</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			  timeStamp<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
			  nonceStr<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
			  <span class="token keyword">package</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
			  signType<span class="token operator">:</span> <span class="token string">'MD5'</span><span class="token punctuation">,</span>
			  paySign<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
			  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				  <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
			  <span class="token punctuation">}</span><span class="token punctuation">,</span>
			  <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token parameter">Error</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
				  <span class="token function">reject</span><span class="token punctuation">(</span>Error<span class="token punctuation">)</span>
			  <span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>	
	
	
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>Payment<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在待付款组件中添加点击事件，</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>text v<span class="token operator">-</span><span class="token keyword">else</span> @click<span class="token operator">=</span><span class="token string">"payMent()"</span><span class="token operator">&gt;</span>付款<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h4 id="待付款再次付款（下）"><a href="#待付款再次付款（下）" class="headerlink" title="待付款再次付款（下）"></a>待付款再次付款（下）</h4><p>给方法传值（对象）</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>text v<span class="token operator">-</span><span class="token keyword">else</span> @click<span class="token operator">=</span><span class="token string">"payMent({_id:item.id,})"</span><span class="token operator">&gt;</span>付款<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>

<span class="token comment">// 在付款</span>
<span class="token function">payMent</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>引入付款类</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 引入付款类</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>Payment<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../../public/payment.js'</span><span class="token punctuation">)</span>

<span class="token comment">// 在付款</span>
<span class="token function">payMent</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">paySucc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>然后去方法类中拿到obj对象参数后，代码如下</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 用于待付款的付款请求</span>

<span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">'../api/api.js'</span>
<span class="token keyword">import</span> urls <span class="token keyword">from</span> <span class="token string">'../api/request.js'</span>

<span class="token comment">// 待付款</span>
<span class="token keyword">class</span> <span class="token class-name">Payment</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">payment</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>payment <span class="token operator">=</span> payment
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 1、拉起付款， </span>
	<span class="token keyword">async</span> <span class="token function">paySuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
			<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wxPay</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">throw</span> e
		<span class="token punctuation">}</span>
		
		<span class="token comment">// 2、查询订单</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> queryorder <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">request</span><span class="token punctuation">(</span>urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>queryorderurl<span class="token punctuation">,</span><span class="token punctuation">{</span>id<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>payment<span class="token punctuation">.</span>_id<span class="token punctuation">,</span>outno<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>payment<span class="token punctuation">.</span>out_trade_no<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> queryorder
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token string">'支付失败'</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 调用微信支付</span>
	<span class="token function">wxPay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			wx<span class="token punctuation">.</span><span class="token function">requestPayment</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			  timeStamp<span class="token operator">:</span> <span class="token string">'this.payment.timeStamp'</span><span class="token punctuation">,</span>
			  nonceStr<span class="token operator">:</span> <span class="token string">'this.payment.nonceStr'</span><span class="token punctuation">,</span>
			  <span class="token keyword">package</span><span class="token operator">:</span> <span class="token string">'this.payment.package'</span><span class="token punctuation">,</span>
			  signType<span class="token operator">:</span> <span class="token string">'this.payment.signType'</span><span class="token punctuation">,</span>
			  paySign<span class="token operator">:</span> <span class="token string">'this.payment.paySign'</span><span class="token punctuation">,</span>
			  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				  <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
			  <span class="token punctuation">}</span><span class="token punctuation">,</span>
			  <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token parameter">Error</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
				  <span class="token function">reject</span><span class="token punctuation">(</span>Error<span class="token punctuation">)</span>
			  <span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>	
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>Payment<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>此时点击tobepaid组件的付款将会弹出二维码，但是由于我这是假数据，仅仅返回一个无权限的数据。</p>
<p><strong>下一步做在订单详情页的付款按钮的功能</strong></p>
<p>在order.vue组件中，添加点击事件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-details-play"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"values.sum"</span> <span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text @click<span class="token operator">=</span><span class="token string">"conFirm()"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>values<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 右下角按钮（付款、确认收货、评价）</span>
<span class="token function">conFirm</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>text <span class="token operator">==</span> <span class="token string">'付款'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'正在下单中'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//手动 弹窗</span>
		<span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>orderdata<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">paySuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'支付成功'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
			<span class="token comment">// 支付成功跳转</span>
			uni<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				url<span class="token operator">:</span><span class="token string">'../personal/personal'</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'支付失败（无商品号权限）'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>	
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>text <span class="token operator">==</span> <span class="token string">'确认收货'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>text <span class="token operator">==</span> <span class="token string">'评价'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="订单详情页"><a href="#订单详情页" class="headerlink" title="订单详情页"></a>订单详情页</h3><h4 id="删除订单"><a href="#删除订单" class="headerlink" title="删除订单"></a>删除订单</h4><p><strong>在待付款组件tobepaid.vue中，有的商品过期，需要删除</strong></p>
<p><strong>准备删除接口</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 删除订单</span>
<span class="token keyword">let</span> deleorder <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">deleorder</span><span class="token template-punctuation string">`</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p> <strong>给删除按钮添加点击事件 deteOrder（_id）</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 付款 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-payment"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果过期，就显示删除订单 否则可以付款<span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"item.expire"</span> @click<span class="token operator">=</span><span class="token string">"deteOrder(item._id)"</span><span class="token operator">&gt;</span>删除订单<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>text v<span class="token operator">-</span><span class="token keyword">else</span> @click<span class="token operator">=</span>"<span class="token function">payMent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		_id<span class="token operator">:</span>item<span class="token punctuation">.</span>_id<span class="token punctuation">,</span>
		timeStamp<span class="token operator">:</span>item<span class="token punctuation">.</span>timeStamp<span class="token punctuation">,</span>
		nonceStr<span class="token operator">:</span>item<span class="token punctuation">.</span>nonceStr<span class="token punctuation">,</span>
		<span class="token keyword">package</span><span class="token operator">:</span>item<span class="token punctuation">.</span>package<span class="token punctuation">,</span>
		signType<span class="token operator">:</span>item<span class="token punctuation">.</span>signType<span class="token punctuation">,</span>
		paySign<span class="token operator">:</span>item<span class="token punctuation">.</span>paySign<span class="token punctuation">,</span>
		out_trade_no<span class="token operator">:</span>item<span class="token punctuation">.</span>out_trade_no<span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>"<span class="token operator">&gt;</span>付款<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 删除订单</span>
<span class="token keyword">async</span> <span class="token function">deteOrder</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> deleorder <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>deleorder <span class="token operator">+</span> <span class="token string">'?orderid'</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>deleorder<span class="token punctuation">,</span><span class="token string">'删除订单'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>deleorder<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//刷新页面</span>
				<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'删除成功'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>deleorder<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">"参数填写错误"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'删除失败（无商品号权限）'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">//TODO handle the exception</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="待发货和待收货"><a href="#待发货和待收货" class="headerlink" title="待发货和待收货"></a>待发货和待收货</h4><h5 id="delivered-vue待发货"><a href="#delivered-vue待发货" class="headerlink" title="**delivered.vue待发货 **"></a>**delivered.vue待发货 **</h5><p>组件中，  代码如下:</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 待发货组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-view"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in tbdelivered"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-commodity"</span> <span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-tips"</span><span class="token operator">&gt;</span>买家已付款<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(items,indexs) in item.order"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"indexs"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order"</span> @click<span class="token operator">=</span><span class="token string">"payDetail(item._id)"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 图片 <span class="token operator">--</span><span class="token operator">&gt;</span> 
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order-img"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"items.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-title"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>items<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>颜色<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>items<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>尺码<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>items<span class="token punctuation">.</span>size<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 单价、数量 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-flex"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-price"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>￥ <span class="token punctuation">{</span><span class="token punctuation">{</span>items<span class="token punctuation">.</span>price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>x<span class="token punctuation">{</span><span class="token punctuation">{</span>items<span class="token punctuation">.</span>many<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 价格 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-Price"</span><span class="token operator">&gt;</span>实付款￥<span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>total_price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 登录界面 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>loginpage ref<span class="token operator">=</span><span class="token string">"loginmen"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>loginpage<span class="token operator">&gt;</span>
	
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 没有相关订单 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>ordering ref<span class="token operator">=</span><span class="token string">"orderload"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ordering<span class="token operator">&gt;</span>
	
	
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token string">'../../../style/order.css'</span> 

<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			tbdelivered<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token keyword">async</span> <span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">try</span><span class="token punctuation">{</span>
					<span class="token keyword">let</span> tbdelivered <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tbdelivered<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tbdelivered<span class="token punctuation">,</span><span class="token string">'获取待发货数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 如果未登录 调用登录弹窗</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>tbdelivered<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loginmen<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					<span class="token comment">// 如果登录成功后</span>
					<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>tbdelivered<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token comment">// 没有待付款数据</span>
						<span class="token keyword">if</span><span class="token punctuation">(</span>tbdelivered<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token comment">// 就提示没有数据</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>orderload<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
						<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>tbdelivered <span class="token operator">=</span> tbdelivered<span class="token punctuation">.</span>data 
							
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
					
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
					
					
				<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 跳转到商品详情页</span>
		<span class="token function">payDetail</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">// 准备一个对象传入 ，不能直接从路径携带过去</span>
			<span class="token keyword">let</span> tip <span class="token operator">=</span> <span class="token punctuation">{</span>
				tips<span class="token operator">:</span><span class="token string">'买家已经付款'</span><span class="token punctuation">,</span>
				sum<span class="token operator">:</span><span class="token string">'实付款'</span><span class="token punctuation">,</span>
				show<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//是否展示付款按钮</span>
				text<span class="token operator">:</span><span class="token string">'付款'</span><span class="token punctuation">,</span>
				id<span class="token operator">:</span>id
			<span class="token punctuation">}</span>
			<span class="token comment">// 将对象数据转化成json字符串 然后传入到跳转的组件里</span>
			<span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>tip<span class="token punctuation">)</span>
			uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				url<span class="token operator">:</span><span class="token string">'../order-details/order?value='</span> <span class="token operator">+</span> value
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
			
			
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 登录成功后也要刷新数据  接收登录组件传递的值 </span>
	<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'mycart'</span><span class="token punctuation">,</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			<span class="token comment">// 当登录成功后</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>cart <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">// 调用方法刷新数据</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="received-vue-待收货"><a href="#received-vue-待收货" class="headerlink" title="**received.vue **待收货"></a>**received.vue **待收货</h5><p>组件中，  代码如下:</p>
<p><strong>ps:  由于待收货接口拿不到数据，这里使用的是待发货的接口</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 待收货组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-view"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in gtbreceived"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">'index'</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-commodity"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-tips"</span><span class="token operator">&gt;</span>卖家已发货<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(iteming, indexs) in item.order"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">'indexs'</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order"</span> @click<span class="token operator">=</span><span class="token string">"payDeatil(item._id)"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order-img"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"iteming.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-title"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>iteming<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>颜色<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>iteming<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>尺码<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>iteming<span class="token punctuation">.</span>size<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-flex"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-price"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>￥ <span class="token punctuation">{</span><span class="token punctuation">{</span>iteming<span class="token punctuation">.</span>price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>x<span class="token punctuation">{</span><span class="token punctuation">{</span>iteming<span class="token punctuation">.</span>many<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 价格 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-Price"</span><span class="token operator">&gt;</span>实付款￥<span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>total_price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 付款 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-payment"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text @click<span class="token operator">=</span><span class="token string">"conRece(item._id)"</span><span class="token operator">&gt;</span>确认收货<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 登录界面 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>loginpage ref<span class="token operator">=</span><span class="token string">"loginmen"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>loginpage<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 没有相关订单 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>ordering ref<span class="token operator">=</span><span class="token string">"orderload"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ordering<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token string">'../../../style/order.css'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			gtbreceived<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 获取待收货数据</span>
		<span class="token keyword">async</span> <span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
				<span class="token comment">// 由于待收货接口拿不到数据，这里使用的是待发货的接口</span>
				<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tbdelivered<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token string">'获取待收货数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loginmen<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>gtbreceived <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 当数据为0 时候，要清空页面数据</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>orderload<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>gtbreceived <span class="token operator">=</span> data<span class="token punctuation">.</span>data
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">//TODO handle the exception</span>
			<span class="token punctuation">}</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">,</span>    
		<span class="token comment">// 订单详情页</span>
		<span class="token function">payDeatil</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> tip <span class="token operator">=</span> <span class="token punctuation">{</span>tips<span class="token operator">:</span><span class="token string">'卖家已发货'</span><span class="token punctuation">,</span>sum<span class="token operator">:</span><span class="token string">'实付款'</span><span class="token punctuation">,</span>show<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>text<span class="token operator">:</span><span class="token string">'确认收货'</span><span class="token punctuation">,</span>id<span class="token punctuation">}</span>
			<span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>tip<span class="token punctuation">)</span>
			uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				url<span class="token operator">:</span><span class="token string">'../order-details/order?value='</span> <span class="token operator">+</span> value
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 确认收货</span>
		<span class="token keyword">async</span> <span class="token function">conRece</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
				<span class="token keyword">let</span> conreceipt <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>conreceipt <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>conreceipt<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token comment">// 刷新数据</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'确认收货成功'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">//TODO handle the exception</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	
	<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 小程序的生命周期在子组件不会执行</span>
	<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'mycart'</span><span class="token punctuation">,</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>cart <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>然后点击待收货进入商品详情组件order.vue，对右下角的确认收货作点击事件</p>
<p>是</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 右下角按钮（付款、确认收货、评价）</span>
<span class="token function">conFirm</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>text <span class="token operator">==</span> <span class="token string">'付款'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'正在下单中'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//手动 弹窗</span>
		<span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>orderdata<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">paySuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'支付成功'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
			<span class="token comment">// 支付成功跳转</span>
			uni<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				url<span class="token operator">:</span><span class="token string">'../personal/personal'</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'支付失败（无商品号权限）'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>	
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>text <span class="token operator">==</span> <span class="token string">'确认收货'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">conRece</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token comment">// 支付成功跳转</span>
			uni<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				url<span class="token operator">:</span><span class="token string">'../personal/personal'</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
			
			
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// 确认收货</span>
<span class="token keyword">async</span> <span class="token function">conRece</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> conreceipt <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>conreceipt <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>conreceipt<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">// 刷新数据</span>
				<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'确认收货成功'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">//TODO handle the exception</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="待评价"><a href="#待评价" class="headerlink" title="待评价"></a>待评价</h4><p>使用假数据</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-view"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品详情 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in tbevaluated"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">'index'</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-commodity"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"order-tips"</span><span class="token operator">&gt;</span>交易完成<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order"</span> @click<span class="token operator">=</span><span class="token string">"payDeatil(item._id)"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-order-img"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-title"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>颜色<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>尺码<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>size<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-flex"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"payment-price"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>￥ <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"text-you"</span><span class="token operator">&gt;</span>x<span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>many<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 价格<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-Price"</span><span class="token operator">&gt;</span>实付款￥<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>price <span class="token operator">*</span> item<span class="token punctuation">.</span>many<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 去评价 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"presonal-payment"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text @click<span class="token operator">=</span><span class="token string">"conRece(item._id,item.id,item.size,item.color)"</span><span class="token operator">&gt;</span>去评价<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 登录界面 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>loginpage ref<span class="token operator">=</span><span class="token string">"loginmen"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>loginpage<span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 没有相关订单 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>ordering ref<span class="token operator">=</span><span class="token string">"orderload"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ordering<span class="token operator">&gt;</span>
	
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>


<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">import</span> <span class="token string">'../../../style/order.css'</span>
	
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				<span class="token comment">// 假数据</span>
				tbevaluated<span class="token operator">:</span><span class="token punctuation">[</span>
						<span class="token punctuation">{</span>
								_id<span class="token operator">:</span><span class="token string">"5fd1ce998c16885a1972d20b"</span><span class="token punctuation">,</span> <span class="token comment">//订单号</span>
								id<span class="token operator">:</span><span class="token string">"5f8bbf2823954733542169a1"</span><span class="token punctuation">,</span>
								color<span class="token operator">:</span><span class="token string">'5526网面-天空蓝'</span><span class="token punctuation">,</span>
								image<span class="token operator">:</span><span class="token string">"http://h.thexxdd.cn/tianmao/public%5Cuploads%5C1606059327494-4142549.jpg"</span><span class="token punctuation">,</span>
								many<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
								price<span class="token operator">:</span><span class="token number">169</span><span class="token punctuation">,</span>
								size<span class="token operator">:</span><span class="token string">"37"</span><span class="token punctuation">,</span>
								title<span class="token operator">:</span><span class="token string">"耐克新款2022 女生白色皮面鞋子高级【店长推荐】"</span>
						<span class="token punctuation">}</span><span class="token punctuation">,</span>
						<span class="token punctuation">{</span>
								_id<span class="token operator">:</span><span class="token string">"5fd1ce998c16885a1972d20b"</span><span class="token punctuation">,</span> <span class="token comment">//订单号</span>
								id<span class="token operator">:</span><span class="token string">"5f8bbf2823954733542169a1"</span><span class="token punctuation">,</span>
								color<span class="token operator">:</span><span class="token string">'5526网面-渣渣灰'</span><span class="token punctuation">,</span>
								image<span class="token operator">:</span><span class="token string">"http://h.thexxdd.cn/tianmao/public%5Cuploads%5C1606059327494-4142549.jpg"</span><span class="token punctuation">,</span>
								many<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
								price<span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>
								size<span class="token operator">:</span><span class="token string">"41"</span><span class="token punctuation">,</span>
								title<span class="token operator">:</span><span class="token string">"361新款2022 男生灰色皮面鞋子【店长推荐】"</span>
						<span class="token punctuation">}</span><span class="token punctuation">,</span>

				<span class="token punctuation">]</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token comment">// 获取待评价数据</span>
			<span class="token keyword">async</span> <span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">try</span><span class="token punctuation">{</span>
					<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tbevaluated<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token string">'获取待评价数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 	由于没有商户号，待评价接口拿不到数据，这里使用的是假数据当作接口返回的数据</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode<span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token comment">// 如果没有登录 弹出登录框</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loginmen<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
							<span class="token comment">// this.tbevaluated = [] // 当数据为0 时候，要清空页面数据</span>
							<span class="token comment">// this.$refs.orderload.init() //展示没有数据的提示</span>
							console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'没有商品号，使用假数据当作接口返回的数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token comment">//TODO handle the exception</span>
				<span class="token punctuation">}</span>

			<span class="token punctuation">}</span><span class="token punctuation">,</span>     
			<span class="token comment">// 点击商品跳转到订单详情页</span>
			<span class="token function">payDeatil</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">let</span> tip <span class="token operator">=</span> <span class="token punctuation">{</span>tips<span class="token operator">:</span><span class="token string">'交易完成'</span><span class="token punctuation">,</span>sum<span class="token operator">:</span><span class="token string">'实付款'</span><span class="token punctuation">,</span>show<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>text<span class="token operator">:</span><span class="token string">'去评价'</span><span class="token punctuation">,</span>id<span class="token punctuation">,</span>evt<span class="token operator">:</span><span class="token string">'002'</span><span class="token punctuation">}</span>
				<span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>tip<span class="token punctuation">)</span>
				uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
					url<span class="token operator">:</span><span class="token string">'../order-details/order?value='</span> <span class="token operator">+</span> value
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 小程序的生命周期在子组件不会执行</span>
		<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'mycart'</span><span class="token punctuation">,</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>cart <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Tobepaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
	
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>然后对点击商品跳转到详情组件的功能实现，通过在跳转的方法payDeatil(id)中，传递的参数多加一个evt，当evt为002，就代表是待评价的组件去往详情页，</p>
<p>然后详情组件中判断evt值进行相应操作</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 请求商品数据的方法</span>
<span class="token keyword">async</span> <span class="token function">tobedetail</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>evt<span class="token operator">=</span><span class="token string">'001'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 当第二个参数是 evt为001 的时候代表的是 待付款、待发货、待收货的订单详情</span>
	<span class="token comment">// 当第二个参数是 evt为002 的时候代表的是 待评价的订单详情</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>evt <span class="token operator">==</span> <span class="token string">'001'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> tobedetail <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tobedetail <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 此处因为是没有商户号的购买数据，无法拿到相关数据</span>
	<span class="token comment">// 因此自己创建一个假数组对象当作拿到的tobedetail数据</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tobedetail<span class="token punctuation">,</span><span class="token string">'我是待付款、待发货、待收货的商品数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">let</span> tobedetails <span class="token operator">=</span> 
        <span class="token punctuation">[</span>
			<span class="token punctuation">{</span>
				consignee<span class="token operator">:</span><span class="token punctuation">{</span>
					address<span class="token operator">:</span><span class="token string">"阿里巴巴"</span><span class="token punctuation">,</span>
					city<span class="token operator">:</span><span class="token string">"四川省 成都市 高新区"</span><span class="token punctuation">,</span>
					mobile<span class="token operator">:</span><span class="token string">"15858588888"</span><span class="token punctuation">,</span>
					name<span class="token operator">:</span><span class="token string">"马云"</span><span class="token punctuation">,</span>	
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				nonceStr<span class="token operator">:</span><span class="token string">"yybvvcyP6CDZ08E4"</span><span class="token punctuation">,</span>
				order<span class="token operator">:</span>
                <span class="token punctuation">[</span>
					<span class="token punctuation">{</span>
						color<span class="token operator">:</span><span class="token string">'5526网面-天空蓝'</span><span class="token punctuation">,</span>
						image<span class="token operator">:</span><span class="token string">"http://h.thexxdd.cn/tianmao/public%5Cuploads%5C1606059327494-4142549.jpg"</span><span class="token punctuation">,</span>
						many<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
						price<span class="token operator">:</span><span class="token number">169</span><span class="token punctuation">,</span>
						size<span class="token operator">:</span><span class="token string">"37"</span><span class="token punctuation">,</span>
						title<span class="token operator">:</span><span class="token string">"耐克新款2022 女生白色皮面鞋子高级【店长推荐】"</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token punctuation">]</span><span class="token punctuation">,</span>
				order_number<span class="token operator">:</span><span class="token string">"1607585433768778712"</span><span class="token punctuation">,</span>
				out_trade_no<span class="token operator">:</span><span class="token string">"2zmCzfDZe6Zr8rKYCz43AbXEe2Kk2Pcs"</span><span class="token punctuation">,</span>
				<span class="token keyword">package</span><span class="token operator">:</span><span class="token string">"prepay_id=wx101530337150731019fc4f4e85085f0000"</span><span class="token punctuation">,</span>
				paySign<span class="token operator">:</span><span class="token string">"C0E5435D1E89E2562048740360E37201"</span><span class="token punctuation">,</span>
				signType<span class="token operator">:</span><span class="token string">"MD5"</span><span class="token punctuation">,</span>
				time<span class="token operator">:</span><span class="token string">"2022-07-15 16:46:00"</span><span class="token punctuation">,</span>
				timeStamp<span class="token operator">:</span><span class="token string">"1657874760"</span><span class="token punctuation">,</span>
				total_price<span class="token operator">:</span><span class="token number">169</span><span class="token punctuation">,</span>
				_id<span class="token operator">:</span><span class="token string">"5fd1ce998c16885a1972d20b"</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
		tobedetail<span class="token punctuation">.</span>data <span class="token operator">=</span> tobedetails
		<span class="token keyword">this</span><span class="token punctuation">.</span>orderdata <span class="token operator">=</span> tobedetail<span class="token punctuation">.</span>data
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">// 待评价组件的商品详情接口数据</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> dtpepage <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dtpepage <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 此处因为是没有商户号的购买数据，拿到是空数据</span>
			<span class="token comment">// 因此自己创建一个假数组对象当作拿到的tobedetail数据</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dtpepage<span class="token punctuation">,</span><span class="token string">'我是待评价组件的商品数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">let</span> tobedetails <span class="token operator">=</span> <span class="token punctuation">[</span>
				<span class="token punctuation">{</span>
					consignee<span class="token operator">:</span><span class="token punctuation">{</span>
						address<span class="token operator">:</span><span class="token string">"阿里巴巴"</span><span class="token punctuation">,</span>
						city<span class="token operator">:</span><span class="token string">"四川省 成都市 高新区"</span><span class="token punctuation">,</span>
						mobile<span class="token operator">:</span><span class="token string">"15858588888"</span><span class="token punctuation">,</span>
						name<span class="token operator">:</span><span class="token string">"马云"</span><span class="token punctuation">,</span>	
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
						nonceStr<span class="token operator">:</span><span class="token string">"yybvvcyP6CDZ08E4"</span><span class="token punctuation">,</span>
						order<span class="token operator">:</span>
                    	<span class="token punctuation">[</span>
							<span class="token punctuation">{</span>
								color<span class="token operator">:</span><span class="token string">'5526网面-天空蓝'</span><span class="token punctuation">,</span>
								image<span class="token operator">:</span><span class="token string">"http://h.thexxdd.cn/tianmao/public%5Cuploads%5C1606059327494-4142549.jpg"</span><span class="token punctuation">,</span>
								many<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
								price<span class="token operator">:</span><span class="token number">169</span><span class="token punctuation">,</span>
								size<span class="token operator">:</span><span class="token string">"37"</span><span class="token punctuation">,</span>
								title<span class="token operator">:</span><span class="token string">"耐克新款2022 女生白色皮面鞋子高级【店长推荐】"</span>
							<span class="token punctuation">}</span><span class="token punctuation">,</span>
						<span class="token punctuation">]</span><span class="token punctuation">,</span>
						order_number<span class="token operator">:</span><span class="token string">"1607585433768778712"</span><span class="token punctuation">,</span>
						out_trade_no<span class="token operator">:</span><span class="token string">"2zmCzfDZe6Zr8rKYCz43AbXEe2Kk2Pcs"</span><span class="token punctuation">,</span>
						<span class="token keyword">package</span><span class="token operator">:</span><span class="token string">"prepay_id=wx101530337150731019fc4f4e85085f0000"</span><span class="token punctuation">,</span>
						paySign<span class="token operator">:</span><span class="token string">"C0E5435D1E89E2562048740360E37201"</span><span class="token punctuation">,</span>
						signType<span class="token operator">:</span><span class="token string">"MD5"</span><span class="token punctuation">,</span>
						time<span class="token operator">:</span><span class="token string">"2022-07-15 16:46:00"</span><span class="token punctuation">,</span>
						timeStamp<span class="token operator">:</span><span class="token string">"1657874760"</span><span class="token punctuation">,</span>
						total_price<span class="token operator">:</span><span class="token number">169</span><span class="token punctuation">,</span>
						_id<span class="token operator">:</span><span class="token string">"5fd1ce998c16885a1972d20b"</span><span class="token punctuation">,</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">]</span>
				dtpepage<span class="token punctuation">.</span>data <span class="token operator">=</span> tobedetails
				<span class="token keyword">this</span><span class="token punctuation">.</span>orderdata <span class="token operator">=</span> dtpepage<span class="token punctuation">.</span>data
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">//TODO handle the exception</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>	
<span class="token punctuation">}</span><span class="token punctuation">,</span>		<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="商品评价（上）"><a href="#商品评价（上）" class="headerlink" title="商品评价（上）"></a>商品评价（上）</h4><p>在evaluated.vue组件中，点击评价后跳转到新的组件中，</p>
<p>在pages/order-details/<strong>新建pu-coments.vue文件</strong>，同时去page.json注册</p>
<p>静态布局：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 描述 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pu-coments-input"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>textarea  placeholder<span class="token operator">=</span><span class="token string">"宝贝满足你的期待吗？说说它的优点和美中不足的地方吧"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"tipsdata"</span> maxlength<span class="token operator">=</span><span class="token string">"200"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 上传图片 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Upload-pictures"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Upload-button"</span> <span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/uptu.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conteng"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conteng-img"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"http://h.thexxdd.cn/tianmao/public%5Cuploads%5C1606059327494-4142549.jpg"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span>  <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"uploadimg"</span> <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/guanbi.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"deleteimg"</span> @click<span class="token operator">=</span><span class="token string">"deteImg(index)"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 提交 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Su-comments"</span> @click<span class="token operator">=</span><span class="token string">"subMit()"</span><span class="token operator">&gt;</span>提交评论<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		
		
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
page<span class="token punctuation">{</span>background<span class="token operator">:</span> #eeeeee<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>pu<span class="token operator">-</span>coments<span class="token operator">-</span>input<span class="token punctuation">{</span>background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">350</span>rpx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>pu<span class="token operator">-</span>coments<span class="token operator">-</span>input textarea<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span> color<span class="token operator">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">!</span>important<span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span>
font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>rpx<span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">350</span>rpx<span class="token punctuation">;</span>
overflow<span class="token operator">-</span>y<span class="token operator">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>Upload<span class="token operator">-</span>button<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">130</span>rpx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">130</span>rpx<span class="token punctuation">;</span> 
padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span> padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">5</span>rpx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>Upload<span class="token operator">-</span>button image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">130</span>rpx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">130</span>rpx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>Upload<span class="token operator">-</span>pictures<span class="token punctuation">{</span>margin<span class="token operator">:</span> <span class="token number">15</span>rpx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token comment">/* 上传图片 */</span>
<span class="token punctuation">.</span>conteng<span class="token punctuation">{</span>display<span class="token operator">:</span> flex<span class="token punctuation">;</span>flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">.</span>conteng<span class="token operator">-</span>img<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token operator">%</span> <span class="token operator">-</span> <span class="token number">10</span>rpx<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">150</span>rpx<span class="token punctuation">;</span>
padding<span class="token operator">:</span> <span class="token number">10</span>rpx<span class="token punctuation">;</span>
position<span class="token operator">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>conteng<span class="token operator">-</span>img image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">150</span>rpx<span class="token punctuation">;</span>
border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">6</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>deleteimg<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">33</span>upx <span class="token operator">!</span>important<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">33</span>upx <span class="token operator">!</span>important<span class="token punctuation">;</span>
position<span class="token operator">:</span> absolute<span class="token punctuation">;</span>
top<span class="token operator">:</span> <span class="token number">0</span>upx<span class="token punctuation">;</span>
right<span class="token operator">:</span> <span class="token number">0</span>upx<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token comment">/* 提交评论 */</span>
<span class="token punctuation">.</span>Su<span class="token operator">-</span>comments<span class="token punctuation">{</span>background<span class="token operator">-</span>color<span class="token operator">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
color<span class="token operator">:</span> #<span class="token constant">FFFFFF</span><span class="token punctuation">;</span>
height<span class="token operator">:</span> <span class="token number">100</span>rpx<span class="token punctuation">;</span>
line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">100</span>rpx<span class="token punctuation">;</span>
position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="商品评价（下）"><a href="#商品评价（下）" class="headerlink" title="商品评价（下）"></a>商品评价（下）</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 描述 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"pu-coments-input"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>textarea  placeholder<span class="token operator">=</span><span class="token string">"宝贝满足你的期待吗？说说它的优点和美中不足的地方吧"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"tipsdata"</span> maxlength<span class="token operator">=</span><span class="token string">"200"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 上传图片 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Upload-pictures"</span><span class="token operator">&gt;</span>
														<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 使用计算属性 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Upload-button"</span> @click<span class="token operator">=</span><span class="token string">"uploadImg()"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"upbutton"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/uptu.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conteng"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in upimg"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"conteng-img"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span>item mode<span class="token operator">=</span><span class="token string">"aspectFill"</span>  <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"uploadimg"</span>  @click<span class="token operator">=</span><span class="token string">"preImage(index,upimg)"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/guanbi.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"deleteimg"</span> @click<span class="token operator">=</span><span class="token string">"deteImg(index)"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 提交 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"Su-comments"</span> @click<span class="token operator">=</span><span class="token string">"subMit()"</span><span class="token operator">&gt;</span>提交评论<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
 
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token comment">// 引入预览图片js</span>
	<span class="token keyword">const</span> <span class="token punctuation">{</span>Login<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../public/logic.js'</span><span class="token punctuation">)</span> 
	
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				<span class="token comment">// 双向绑定的input框文本</span>
				tipsdata<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				upimg<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">//准备上传的图片信息</span>
				comming<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//接收上个组件的数据</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token comment">// 上传图片 使用微信的接口</span>
			<span class="token function">uploadImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				wx<span class="token punctuation">.</span><span class="token function">chooseMedia</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				  count<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> 					<span class="token comment">//图片张数</span>
				  mediaType<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'image'</span><span class="token punctuation">,</span><span class="token string">'video'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>	<span class="token comment">//文件类型</span>
				  sizeType<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'compressed'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>     <span class="token comment">//仅对 mediaType 为 image 时有效，是否压缩所选文件</span>
				  sourceType<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'album'</span><span class="token punctuation">,</span> <span class="token string">'camera'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//图片和视频选择的来源</span>
				  maxDuration<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>				<span class="token comment">//拍摄视频最长拍摄时间，单位秒。时间范围为 3s 至 60s 之间。不限制相册。</span>
				  <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				  		<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'等待上传'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//加载提示</span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token string">'拍摄或从手机相册中选择图片或视频'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				  		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cloudImg</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>tempFiles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tempFilePath<span class="token punctuation">)</span>
				  <span class="token punctuation">}</span><span class="token punctuation">,</span>
				  <span class="token function-variable function">fail</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				  		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>  
				  <span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			
			<span class="token comment">// 微信提供 上传图片到服务器方法</span>
			<span class="token function">cloudImg</span><span class="token punctuation">(</span><span class="token parameter">image</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				wx<span class="token punctuation">.</span><span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
					url<span class="token operator">:</span><span class="token string">'https://meituan.thexxdd.cn/api/potimg'</span><span class="token punctuation">,</span>
					filePath<span class="token operator">:</span>image<span class="token punctuation">,</span> <span class="token comment">//要上传文件资源的路径 (本地路径)</span>
					name<span class="token operator">:</span><span class="token string">'file'</span><span class="token punctuation">,</span>  	<span class="token comment">//文件对应的 key，开发者在服务端可以通过这个 key 获取文件的二进制内容</span>
					<span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> 
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token string">'上传图片到服务器'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>upimg<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span>
						<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'上传成功'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// 预览图片</span>
			<span class="token function">preImage</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>upimg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>upimg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">previewImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// 删除图片</span>
			<span class="token function">deteImg</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>upimg<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// 提交评论</span>
			<span class="token keyword">async</span> <span class="token function">subMit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'正在提交'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	
				<span class="token comment">// 拿到评论接口需要的参数</span>
				<span class="token keyword">let</span> <span class="token punctuation">{</span>_id<span class="token punctuation">,</span>id<span class="token punctuation">,</span>size<span class="token punctuation">,</span>color<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>comming
				<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>orderid<span class="token operator">:</span>_id<span class="token punctuation">,</span>commid<span class="token operator">:</span>id<span class="token punctuation">,</span>size<span class="token punctuation">,</span>color<span class="token punctuation">,</span>comment<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>tipsdata<span class="token punctuation">,</span>commimage<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>upimg<span class="token punctuation">}</span>
				<span class="token keyword">try</span><span class="token punctuation">{</span>
					<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>subcomm<span class="token punctuation">,</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token string">'提交评论'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'评论成功'</span><span class="token punctuation">,</span><span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
						<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
							uni<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
								url<span class="token operator">:</span> <span class="token string">'../personal/personal'</span>
							<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
						<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>
					<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
						<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>msg<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token comment">//TODO handle the exception</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">//使用计算属性完成 当图片数量达到2时，隐藏上传入口</span>
		computed<span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token function">upbutton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>upimg<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token keyword">return</span> <span class="token boolean">false</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
					<span class="token keyword">return</span> <span class="token boolean">true</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 接收上个组件传递的数据</span>
		<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>comming <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span> 

		<span class="token punctuation">}</span>	
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>待评价页面进入商品详情页         <strong>order.vue</strong> 中的 <strong>去评价</strong> 功能</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>text <span class="token operator">==</span> <span class="token string">'去评价'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span> <span class="token punctuation">{</span>_id<span class="token punctuation">,</span>id<span class="token punctuation">,</span>size<span class="token punctuation">,</span>color<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>orderdata<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>order<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">,</span>id<span class="token punctuation">,</span>size<span class="token punctuation">,</span>color<span class="token punctuation">}</span><span class="token punctuation">)</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		url<span class="token operator">:</span><span class="token string">'../order-details/pu-coments?data='</span> <span class="token operator">+</span> data
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> 然后打开<strong>my文件夹下 my.vue</strong> 设置跳转到各个组件详情页方法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 跳转到各板块组件 --详情页</span>
<span class="token function">myIng</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		url<span class="token operator">:</span><span class="token string">'../personal/personal?index='</span> <span class="token operator">+</span> index
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="商品分类"><a href="#商品分类" class="headerlink" title="商品分类"></a>商品分类</h3><h4 id="商品一级分类"><a href="#商品一级分类" class="headerlink" title="商品一级分类"></a>商品一级分类</h4><p><strong>sort.vue组件 静态布局</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 左边 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-left"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-name"</span> <span class="token operator">&gt;</span>潮流男装<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 右边 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-right"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-name sort-title"</span><span class="token operator">&gt;</span>潮流男装<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-flex"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-goods"</span> <span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"iteming.name_image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span>图片<span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>外套<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>sort<span class="token operator">-</span>view <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sort<span class="token operator">-</span>left <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">150</span>upx<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #f8f8f8<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">100</span>vh<span class="token punctuation">;</span>
	overflow<span class="token operator">-</span>y<span class="token operator">:</span> auto<span class="token punctuation">;</span>
	position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
	left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sort<span class="token operator">-</span>right <span class="token punctuation">{</span>
	flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
	margin<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">150</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sort<span class="token operator">-</span>name <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">80</span>upx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">80</span>upx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>upx<span class="token punctuation">;</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>activesort <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* right */</span>
<span class="token punctuation">.</span>sort<span class="token operator">-</span>title <span class="token punctuation">{</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> left <span class="token operator">!</span>important<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">40</span>upx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sort<span class="token operator">-</span>flex <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sort<span class="token operator">-</span>flex image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">80</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">100</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sort<span class="token operator">-</span>goods text <span class="token punctuation">{</span>
	padding<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>sort<span class="token operator">-</span>goods <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>upx<span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">33.333</span><span class="token operator">%</span><span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">40</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>完整逻辑</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-view"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 左边 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-left"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item, index) in comclass"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 动态的背景色：条件是下标值和num相等<span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-name"</span> <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{ activesort: index == num }"</span> @click<span class="token operator">=</span><span class="token string">"sortSwitch(index,item.cid)"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>sort <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 右边 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-right"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item, index) in secondclass"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-name sort-title"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>sort <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-flex"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(iteming, indexs) in item.secon_classif"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"indexs"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sort-goods"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"iteming.name_image"</span> mode<span class="token operator">=</span><span class="token string">"aspectFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> iteming<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			comclass<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//左侧一级数据</span>
			secondclass<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//右侧二级数据</span>
			num<span class="token operator">:</span> <span class="token number">0</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token comment">// comclass</span>
		<span class="token comment">// 请求商品一级分类接口</span>
		<span class="token keyword">async</span> <span class="token function">sortRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">try</span> <span class="token punctuation">{</span>
				<span class="token keyword">let</span> comclass <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>comclass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>comclass<span class="token punctuation">,</span> <span class="token string">'商品一级接口'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>comclass <span class="token operator">=</span> comclass<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
				<span class="token comment">// 进入页面默认请求选中的分类下的商品</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">seCond</span><span class="token punctuation">(</span>comclass<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cid<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">//TODO handle the exception</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 选中左侧菜单项</span>
		<span class="token function">sortSwitch</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>cid</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> index<span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">seCond</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token comment">//每次点击左侧都会有不同的cid参数传入 二级请求方法</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">,</span>

		<span class="token comment">// 请求商品二级分类接口</span>
		<span class="token keyword">async</span> <span class="token function">seCond</span><span class="token punctuation">(</span><span class="token parameter">cid</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">try</span> <span class="token punctuation">{</span>
				<span class="token keyword">let</span> secondclass <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>secondclass <span class="token operator">+</span> <span class="token string">'?cid='</span> <span class="token operator">+</span> cid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>secondclass<span class="token punctuation">,</span> <span class="token string">'商品二级接口'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>secondclass <span class="token operator">=</span> secondclass<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sortRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="商品二级分类"><a href="#商品二级分类" class="headerlink" title="商品二级分类"></a>商品二级分类</h4><p>在pages下新建 <strong>class-goods文件夹</strong>，在其下新建<strong>goods.vue文件</strong></p>
<p><strong>静态布局如下：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 排序 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"condition-view"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>全部<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>销量<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>价格<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/jiantou.svg"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view style<span class="token operator">=</span><span class="token string">"height: 70rpx;"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Commodity <span class="token operator">:</span>commdata<span class="token operator">=</span><span class="token string">"commdata"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Commodity<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
page <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #f4f4f4<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>condition<span class="token operator">-</span>view <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>around<span class="token punctuation">;</span>
	position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
	top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>condition<span class="token operator">-</span>view image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>condition<span class="token operator">-</span>view text <span class="token punctuation">{</span>
	padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">8</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>condition<span class="token operator">-</span>view view <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">999</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>active <span class="token punctuation">{</span>
	color<span class="token operator">:</span> #dd2727 <span class="token operator">!</span>important<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>admining <span class="token punctuation">{</span>
	transform<span class="token operator">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span><span class="token number">180</span>deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>在sort.vue组件中，点击商品携带俩个参数到商品分类goods.vue组件中</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 点击商品跳转到分类详情页</span>
<span class="token function">sortIng</span><span class="token punctuation">(</span><span class="token parameter">cid<span class="token punctuation">,</span>name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>cid<span class="token punctuation">,</span>name<span class="token punctuation">}</span><span class="token punctuation">)</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		url<span class="token operator">:</span><span class="token string">'../class-goods/goods?data='</span> <span class="token operator">+</span> data 
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>goods.vue组件中，onLoad（e）接收俩参数</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 二级分类详情组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 排序 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"condition-view"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in sorting"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{active : index == num}"</span> @click<span class="token operator">=</span><span class="token string">"sortImg(index)"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text <span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">'item.image'</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view style<span class="token operator">=</span><span class="token string">"height: 70rpx;"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Card <span class="token operator">:</span>commdata<span class="token operator">=</span><span class="token string">"commdata"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Card<span class="token operator">&gt;</span>
		
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token comment">// 引入公用的组件 --懒加载卡片</span>
<span class="token keyword">import</span> Card <span class="token keyword">from</span> <span class="token string">'../commponents/card.vue'</span>
	
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	components<span class="token operator">:</span><span class="token punctuation">{</span>
		Card<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			num<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
			querydata<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//查询值</span>
			sorting<span class="token operator">:</span><span class="token punctuation">[</span>
				<span class="token punctuation">{</span>
					text<span class="token operator">:</span><span class="token string">'全部'</span><span class="token punctuation">,</span>
					image<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token punctuation">{</span>
					text<span class="token operator">:</span><span class="token string">'销量'</span><span class="token punctuation">,</span>
					image<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token punctuation">{</span>
					text<span class="token operator">:</span><span class="token string">'价格'</span><span class="token punctuation">,</span>
					image<span class="token operator">:</span><span class="token string">'/static/details/jiantou.svg'</span><span class="token punctuation">,</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">]</span><span class="token punctuation">,</span>
			commdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//二级分类下的商品数据</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token function">sortImg</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> index
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		
		<span class="token comment">// 进入页面后执行的 查询二级分类下的商品</span>
		<span class="token keyword">async</span> <span class="token function">goodsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> <span class="token punctuation">{</span>cid<span class="token punctuation">,</span>name<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>querydata
			<span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token string">'?cid='</span> <span class="token operator">+</span> cid <span class="token operator">+</span> <span class="token string">'&amp;name='</span> <span class="token operator">+</span> name
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
				<span class="token keyword">let</span> queryclass <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>queryclass <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>queryclass<span class="token punctuation">,</span><span class="token string">'二级分类下的商品'</span><span class="token punctuation">)</span>
                <span class="token comment">// 将接口拿到的数据 传递给卡片流组件</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> queryclass<span class="token punctuation">.</span>data 
			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token comment">// 接收sort组件传递进来的数据并保存到data中</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>querydata <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>querydata<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">goodsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>默认展示的是全部的商品，接下来完成排序查询</strong></p>
<h4 id="按销量、按价格查询商品"><a href="#按销量、按价格查询商品" class="headerlink" title="按销量、按价格查询商品"></a>按销量、按价格查询商品</h4><p>思路：</p>
<p>通过切换按钮时，下标不同，就触发不同的请求方法</p>
<p>下标为0 <strong>全部 按钮执行 goodsRequest( )方法</strong></p>
<p>下标为1 <strong>销量 按钮执行 goodsRequest( )方法</strong></p>
<p>下标为2 <strong>价格 按钮执行 goodsRequest( )方法</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">sortImg</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> index
	<span class="token comment">// 当下标为0 即处于全部按钮 调用全部商品接口</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">goodsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		
	<span class="token comment">// 当下标为1 即处于 销量 按钮</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 每次点击销量按钮 值都会改变  1 或者 -1  --即升序或者降序排列</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>savo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>savo <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">qsFun</span><span class="token punctuation">(</span><span class="token string">'001'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>savo<span class="token punctuation">)</span>
		
	<span class="token comment">// 当下标为2 即处于 价格 按钮 </span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>rotate <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rotate <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token operator">?</span> <span class="token boolean">false</span> <span class="token operator">:</span> <span class="token boolean">true</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>pri <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pri <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">qsFun</span><span class="token punctuation">(</span><span class="token string">'002'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>pri<span class="token punctuation">)</span>
		
	<span class="token punctuation">}</span>
	
	
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> <strong>good.vue完整代码</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 二级分类详情组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 排序 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"condition-view"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in sorting"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{active : index == num}"</span> @click<span class="token operator">=</span><span class="token string">"sortImg(index)"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>text <span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">'item.image'</span> <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"{admining : rotate}"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view style<span class="token operator">=</span><span class="token string">"height: 70rpx;"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Card <span class="token operator">:</span>commdata<span class="token operator">=</span><span class="token string">"commdata"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Card<span class="token operator">&gt;</span>
		
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token comment">// 引入公用的组件 --懒加载卡片</span>
<span class="token keyword">import</span> Card <span class="token keyword">from</span> <span class="token string">'../commponents/card.vue'</span>
<span class="token comment">// node.js 的 qs模块</span>
<span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span>

	
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	components<span class="token operator">:</span><span class="token punctuation">{</span>
		Card<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			num<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
			querydata<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//查询值</span>
			sorting<span class="token operator">:</span><span class="token punctuation">[</span>
				<span class="token punctuation">{</span>
					text<span class="token operator">:</span><span class="token string">'全部'</span><span class="token punctuation">,</span>
					image<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token punctuation">{</span>
					text<span class="token operator">:</span><span class="token string">'销量'</span><span class="token punctuation">,</span>
					image<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token punctuation">{</span>
					text<span class="token operator">:</span><span class="token string">'价格'</span><span class="token punctuation">,</span>
					image<span class="token operator">:</span><span class="token string">'/static/details/jiantou.svg'</span><span class="token punctuation">,</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">]</span><span class="token punctuation">,</span>
			commdata<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//二级分类下的商品数据</span>
			savo<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 按销量默认为1 代表升序</span>
			pri<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment">// 按价格</span>
			rotate<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//箭头默认朝下</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token function">sortImg</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> index
			<span class="token comment">// 当下标为0 即处于全部按钮 调用全部商品接口</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">goodsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				
			<span class="token comment">// 当下标为1 即处于 销量 按钮</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 每次点击销量按钮 值都会改变  1 或者 -1  --即升序或者降序排列</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>savo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>savo <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">qsFun</span><span class="token punctuation">(</span><span class="token string">'001'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>savo<span class="token punctuation">)</span>
				
			<span class="token comment">// 当下标为2 即处于 价格 按钮 </span>
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>rotate <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rotate <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token operator">?</span> <span class="token boolean">false</span> <span class="token operator">:</span> <span class="token boolean">true</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>pri <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pri <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">qsFun</span><span class="token punctuation">(</span><span class="token string">'002'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>pri<span class="token punctuation">)</span>
				
			<span class="token punctuation">}</span>
			
			
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		
		<span class="token comment">// 进入页面后执行的 查询二级分类下的商品</span>
		<span class="token keyword">async</span> <span class="token function">goodsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> <span class="token punctuation">{</span>cid<span class="token punctuation">,</span>name<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>querydata
			<span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token string">'?cid='</span> <span class="token operator">+</span> cid <span class="token operator">+</span> <span class="token string">'&amp;name='</span> <span class="token operator">+</span> name
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
				<span class="token keyword">let</span> queryclass <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>queryclass <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> queryclass<span class="token punctuation">.</span>data
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>commdata<span class="token punctuation">,</span><span class="token string">'二级分类下的商品数据'</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		
		<span class="token comment">// 查询商品（按销量、价格）</span>
		<span class="token function">qsFun</span><span class="token punctuation">(</span><span class="token parameter">spvalue<span class="token punctuation">,</span>number</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token string">'?cid='</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>querydata<span class="token punctuation">.</span>cid <span class="token operator">+</span> <span class="token string">'&amp;name='</span> <span class="token operator">+</span> <span class="token keyword">this</span>
			<span class="token comment">//  qs.stringify 把一个参数对象格式化为字符串 获得参数 param</span>
			<span class="token keyword">const</span> param <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				cid<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>querydata<span class="token punctuation">.</span>cid<span class="token punctuation">,</span>
				name<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>querydata<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
				spvalue<span class="token punctuation">,</span>spvalue<span class="token punctuation">,</span>
				number<span class="token punctuation">,</span>number<span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span><span class="token string">'查询商品（按销量、按价格）'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">queryCod</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		
		<span class="token comment">// 调用查询商品接口</span>
		<span class="token keyword">async</span> <span class="token function">queryCod</span><span class="token punctuation">(</span><span class="token parameter">param</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">try</span><span class="token punctuation">{</span>
				<span class="token keyword">let</span> querycod <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>querycod <span class="token operator">+</span> <span class="token string">'?'</span> <span class="token operator">+</span> param<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>querycod<span class="token punctuation">,</span><span class="token string">'查询商品（按销量、按价格）'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>commdata <span class="token operator">=</span> querycod<span class="token punctuation">.</span>data 
			<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>  
				<span class="token comment">//TODO handle the exception</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
		<span class="token comment">// 接收到分类组件传递来的第一级分类数据</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>querydata <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>querydata<span class="token punctuation">,</span><span class="token string">'接收到分类组件传递来的第一级分类数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">goodsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="购物车"><a href="#购物车" class="headerlink" title="购物车"></a>购物车</h3><p><strong>pages/shopping/shopping.vue组件中</strong></p>
<h4 id="静态布局"><a href="#静态布局" class="headerlink" title="静态布局"></a>静态布局</h4><p>代码如下：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-view"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"manage-tli"</span><span class="token operator">&gt;</span>完成<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view style<span class="token operator">=</span><span class="token string">"margin-bottom: 150rpx;"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-goods"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品 <span class="token operator">--</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-goods-view"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>image  src<span class="token operator">=</span><span class="token string">"/static/details/xuanzhong.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>image  src<span class="token operator">=</span><span class="token string">"/static/details/weixuan.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
						
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick-img"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">""</span> mode<span class="token operator">=</span><span class="token string">"scaleToFill"</span><span class="token operator">&gt;</span>图片<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick-gight"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick-right"</span><span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>标题<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick-sku"</span><span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>尺码<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>颜色<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/jiantou.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

							<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 价格 <span class="token operator">--</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-price"</span><span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>¥<span class="token number">100</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-price-nums"</span><span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token number">0</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 底部结算 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-view"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-img"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/weixuan.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>image v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"selectall"</span> src<span class="token operator">=</span><span class="token string">"/static/details/xuanzhong.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> @click<span class="token operator">=</span><span class="token string">"selectAll('deall')"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-tips"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"total-view"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>总价合计<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>¥ <span class="token number">100</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-money"</span><span class="token operator">&gt;</span>结算<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-money"</span><span class="token operator">&gt;</span>删除<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>

			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> sku组件<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Addtocart ref<span class="token operator">=</span><span class="token string">"addto"</span> <span class="token operator">:</span>skudata<span class="token operator">=</span><span class="token string">"skudata"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Addtocart<span class="token operator">&gt;</span>

		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 登录界面 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>loginpage ref<span class="token operator">=</span><span class="token string">"loginmen"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>loginpage<span class="token operator">&gt;</span>

		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 购物车没有数据的提示<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"empty-cart"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!emcart"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/kongcart.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>购物车竟然是空的<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			emcart<span class="token operator">:</span> <span class="token boolean">true</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
page <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #f2f2f2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>view <span class="token punctuation">{</span>
	margin<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>manage<span class="token operator">-</span>tli <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">6</span>b6b6b<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">80</span>upx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">80</span>upx<span class="token punctuation">;</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> right<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 商品 */</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>goods <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>upx<span class="token punctuation">;</span>
	<span class="token comment">/* height: 340upx; */</span>
	background<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">20</span>upx <span class="token number">10</span>upx<span class="token punctuation">;</span>
	margin<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">15</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>goods<span class="token operator">-</span>Coupon <span class="token punctuation">{</span>
	height<span class="token operator">:</span> <span class="token number">70</span>upx<span class="token punctuation">;</span>
	<span class="token comment">/* background: #4CD964; */</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> flex<span class="token operator">-</span>end<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>chick <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">45</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>chick image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">45</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">45</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>chick<span class="token operator">-</span>img <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">15</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>chick<span class="token operator">-</span>img image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">8</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>chick<span class="token operator">-</span>gight view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	display<span class="token operator">:</span> <span class="token operator">-</span>webkit<span class="token operator">-</span>box<span class="token punctuation">;</span>
	<span class="token operator">-</span>webkit<span class="token operator">-</span>box<span class="token operator">-</span>orient<span class="token operator">:</span> vertical<span class="token punctuation">;</span>
	<span class="token operator">-</span>webkit<span class="token operator">-</span>line<span class="token operator">-</span>clamp<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
	overflow<span class="token operator">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>chick<span class="token operator">-</span>right image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">8</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>chick<span class="token operator">-</span>sku <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">25</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #<span class="token number">999999</span><span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #f9f9f9<span class="token punctuation">;</span>
	display<span class="token operator">:</span> inline<span class="token operator">-</span>flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	margin<span class="token operator">:</span> <span class="token number">17</span>upx <span class="token number">0</span><span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">20</span>rpx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">5</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>price <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	<span class="token comment">/* background: #9ACD32; */</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>price view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	color<span class="token operator">:</span> #f75807<span class="token punctuation">;</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>price<span class="token operator">-</span>nums <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	border<span class="token operator">:</span> <span class="token number">1</span>px solid #f9f9f9<span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">200</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>price<span class="token operator">-</span>nums view <span class="token punctuation">{</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>price<span class="token operator">-</span>nums view<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	border<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">1</span>px solid #f9f9f9<span class="token punctuation">;</span>
	border<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token number">1</span>px solid #f9f9f9<span class="token punctuation">;</span>
	padding<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>goods<span class="token operator">-</span>view <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>shopp<span class="token operator">-</span>chick<span class="token operator">-</span>gight <span class="token punctuation">{</span>
	flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>Special<span class="token operator">-</span>rate <span class="token punctuation">{</span>
	color<span class="token operator">:</span> #ff5000<span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">50</span>upx<span class="token punctuation">;</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 结算 */</span>
<span class="token punctuation">.</span>settlement<span class="token operator">-</span>view <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">28</span>upx<span class="token punctuation">;</span>
	background<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span>
	border<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">1</span>px solid #f2f2f2<span class="token punctuation">;</span>
	position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
	bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>settlement<span class="token operator">-</span>img <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">45</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">45</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>settlement<span class="token operator">-</span>img image <span class="token punctuation">{</span>
	width<span class="token operator">:</span> <span class="token number">45</span>upx<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">45</span>upx<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">20</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>total<span class="token operator">-</span>view <span class="token punctuation">{</span>
	display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
	align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
	justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>total<span class="token operator">-</span>view text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>total<span class="token operator">-</span>view text<span class="token operator">:</span>nth<span class="token operator">-</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #ff4401<span class="token punctuation">;</span>
	padding<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">10</span>upx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>settlement<span class="token operator">-</span>money <span class="token punctuation">{</span>
	background<span class="token operator">:</span> #fe0036<span class="token punctuation">;</span>
	height<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span>
	line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">90</span>upx<span class="token punctuation">;</span>
	width<span class="token operator">:</span> <span class="token number">220</span>upx<span class="token punctuation">;</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
	font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">30</span>upx<span class="token punctuation">;</span>
	color<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>settlement<span class="token operator">-</span>tips <span class="token punctuation">{</span>
	text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="拉取购物车数据"><a href="#拉取购物车数据" class="headerlink" title="拉取购物车数据"></a>拉取购物车数据</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-view"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"emcart"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"manage-tli"</span> @click<span class="token operator">=</span><span class="token string">"adMinis()"</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>editdata<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view style<span class="token operator">=</span><span class="token string">"margin-bottom: 150rpx;"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>block v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item,index) in mycarturl"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-goods"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品 <span class="token operator">--</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-goods-view"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 选中的圆圈样式 <span class="token operator">--</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 选中图标 <span class="token operator">--</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>image  v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"item.choice"</span> src<span class="token operator">=</span><span class="token string">"/static/details/xuanzhong.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 未选中图标 <span class="token operator">--</span><span class="token operator">&gt;</span> 
							<span class="token operator">&lt;</span>image v<span class="token operator">-</span><span class="token keyword">else</span> src<span class="token operator">=</span><span class="token string">"/static/details/weixuan.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
						
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick-img"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>image <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"item.image"</span> mode<span class="token operator">=</span><span class="token string">"scaleToFill"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
						
						<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick-gight"</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick-right"</span><span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick-sku"</span><span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>size<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/jiantou.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

							<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 价格 <span class="token operator">--</span><span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-price"</span><span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>¥<span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-price-nums"</span><span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>many<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
									<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
								<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
							<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
						
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			
			<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 底部结算 <span class="token operator">--</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-view"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-img"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/weixuan.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>image v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"selectall"</span> src<span class="token operator">=</span><span class="token string">"/static/details/xuanzhong.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> @click<span class="token operator">=</span><span class="token string">"selectAll('deall')"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-tips"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"settips"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"total-view"</span><span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>总价合计<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
						<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>¥ <span class="token number">100</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-money"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"settips"</span><span class="token operator">&gt;</span>结算<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-money"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"!settips"</span><span class="token operator">&gt;</span>删除<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> sku组件<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>Addtocart ref<span class="token operator">=</span><span class="token string">"addto"</span> <span class="token operator">:</span>skudata<span class="token operator">=</span><span class="token string">"skudata"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Addtocart<span class="token operator">&gt;</span>

		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 登录界面 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>loginpage ref<span class="token operator">=</span><span class="token string">"loginmen"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>loginpage<span class="token operator">&gt;</span>
		
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 购物车没有数据的提示<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"empty-cart"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!emcart"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/kongcart.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>购物车竟然是空的<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 使用 全局引入的登录弹窗 组件<span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>showmodal ref<span class="token operator">=</span><span class="token string">"show"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>showmodal<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			emcart<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
			mycarturl<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">//购物车数据</span>
			editdata<span class="token operator">:</span><span class="token string">'管理'</span><span class="token punctuation">,</span>
			settips<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">//默认展示右下角 结算还是删除</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 获取购物车数据</span>
		<span class="token keyword">async</span> <span class="token function">ShoppingRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">let</span> mycarturl <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mycarturl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mycarturl<span class="token punctuation">,</span><span class="token string">'获取到的购物车数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mycarturl<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode <span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 401 表示没有方法权限或者没有登录  使用 全局引入的登录弹窗 组件里的方法</span>
					<span class="token comment">// 登陆这里传值过去 'coll' </span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>show<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token string">'coll'</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>mycarturl<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">// 购物车没数据的情况</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>mycarturl<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>mycarturl <span class="token operator">=</span> mycarturl<span class="token punctuation">.</span>data
					<span class="token comment">// 显示提示</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>emcart <span class="token operator">=</span> <span class="token boolean">true</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>emcart <span class="token operator">=</span> <span class="token boolean">false</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 管理、完成与删除的切换 </span>
		<span class="token function">adMinis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>editdata <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>editdata <span class="token operator">==</span> <span class="token string">'管理'</span><span class="token operator">?</span> <span class="token string">'完成'</span> <span class="token operator">:</span> <span class="token string">'管理'</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>editdata <span class="token operator">==</span> <span class="token string">'完成'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token comment">// 要不是趁年轻</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>settips <span class="token operator">=</span> <span class="token boolean">false</span>
				
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>editdata <span class="token operator">==</span> <span class="token string">'管理'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>settips <span class="token operator">=</span> <span class="token boolean">true</span>
				
			<span class="token punctuation">}</span>
			
		<span class="token punctuation">}</span>
	
	<span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ShoppingRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	
	<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 当登录成功后刷新页面 </span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'mycart'</span><span class="token punctuation">,</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token comment">// res就是收到的值 这里是来自于loain-oage.vue中的 cart: "SUCCESS"</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token string">'我是收到的data'</span><span class="token punctuation">)</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>cart <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 如果登录成功就	 获取收货地址</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ShoppingRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>scrip<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="计算已选中的合计总价"><a href="#计算已选中的合计总价" class="headerlink" title="计算已选中的合计总价"></a>计算已选中的合计总价</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 获取购物车数据</span>
<span class="token keyword">async</span> <span class="token function">ShoppingRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span> mycarturl <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mycarturl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mycarturl<span class="token punctuation">,</span><span class="token string">'获取到的购物车数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>mycarturl<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>errcode <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 401 表示没有方法权限或者没有登录  使用 全局引入的登录弹窗 组件里的方法</span>
			<span class="token comment">// 登陆这里传值过去 'coll' </span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>show<span class="token punctuation">.</span><span class="token function">showing</span><span class="token punctuation">(</span><span class="token string">'coll'</span><span class="token punctuation">)</span>
		
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>mycarturl<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		
		<span class="token comment">// 购物车有数据的情况</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>mycarturl<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>mycarturl <span class="token operator">=</span> mycarturl<span class="token punctuation">.</span>data <span class="token comment">//获取数据</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">coselect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// 计算价格</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>emcart <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment">//不展示提示</span>
		
		<span class="token comment">// 购物车没有数据的情况</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>emcart <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment">// 显示提示</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
    
<span class="token comment">// 计算单个商品总价</span>
<span class="token function">coselect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 过滤出数组中 choice为 true的对象     filter会将目标对象放到新数组中</span>
	<span class="token keyword">let</span> filselect <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mycarturl<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>choice<span class="token punctuation">)</span>
	<span class="token comment">// 	取出被选中的 数组中的的总价</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>mapselect <span class="token operator">=</span> filselect<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>total_price<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>   
    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>结算和删除按钮的功能</strong></p>
<p>通过计算属性，当勾选长度为0，没有勾选数据就返回一个disable值为false</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">computed<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token comment">//计算总价之和</span>
	<span class="token function">total</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 判断是否有勾选的数据 </span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mapselect<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>price<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>disable<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span>  <span class="token comment">//返回一个总价 值为0</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">let</span> numdata <span class="token operator">=</span> <span class="token number">0</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>mapselect<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>numdata <span class="token operator">+=</span> item<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>price<span class="token operator">:</span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token punctuation">(</span>numdata<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>disable<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token comment">//解决浮点数</span>
			
		<span class="token punctuation">}</span>
		
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-money"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"settips"</span> @click<span class="token operator">=</span><span class="token string">"total.disable &amp;&amp; semEnt()"</span><span class="token operator">&gt;</span>结算<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-money"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"!settips"</span> @click<span class="token operator">=</span><span class="token string">"total.disable &amp;&amp; deLece()"</span><span class="token operator">&gt;</span>删除<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>


<span class="token comment">// 结算</span>
<span class="token function">semEnt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'结算'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 删除</span>
<span class="token function">delece</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="单个商品选中和取消选中"><a href="#单个商品选中和取消选中" class="headerlink" title="单个商品选中和取消选中"></a>单个商品选中和取消选中</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 选中的圆圈样式 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 选中图标 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image  v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"item.choice"</span> @click<span class="token operator">=</span><span class="token string">"seLect(item._id,'unchecked')"</span> 					 	<span class="token number">1</span>						src<span class="token operator">=</span><span class="token string">"/static/details/xuanzhong.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 未选中图标 <span class="token operator">--</span><span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span>image v<span class="token operator">-</span><span class="token keyword">else</span>  @click<span class="token operator">=</span><span class="token string">"seLect(item._id,'select')"</span> src<span class="token operator">=</span><span class="token string">"/static/details/weixuan.svg"</span> 								mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>


<span class="token comment">// 单个商品选中或取消</span>
<span class="token keyword">async</span> <span class="token function">seLect</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>nums</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'请求中'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> selecting <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>selecting<span class="token punctuation">,</span><span class="token punctuation">{</span>id<span class="token operator">:</span>id<span class="token punctuation">,</span>nums<span class="token operator">:</span>nums<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>selecting<span class="token punctuation">,</span><span class="token string">'单个商品选中或取消'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			 <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ShoppingRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			uni<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">//TODO handle the exception</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="购物车加减商品数量"><a href="#购物车加减商品数量" class="headerlink" title="购物车加减商品数量"></a>购物车加减商品数量</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 价格 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-price"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>¥<span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-price-nums"</span><span class="token operator">&gt;</span>
        <span class="token comment">//当商品数量为1的时候静止点击减按钮</span>
		<span class="token operator">&lt;</span>view @click<span class="token operator">=</span><span class="token string">"item.many === 1 ? false : true &amp;&amp; reDuce(item._id,item.many,item.price)"</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>many<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>view @click<span class="token operator">=</span><span class="token string">"pLus(item._id,item.many,item.price)"</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token comment">//结算后边的数字 由 many 控制</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-money"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"settips"</span> @click<span class="token operator">=</span><span class="token string">"total.disable &amp;&amp; semEnt()"</span><span class="token operator">&gt;</span>结算<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">(</span>mapselect<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-money"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"!settips"</span> @click<span class="token operator">=</span><span class="token string">"total.disable &amp;&amp; deLece()"</span><span class="token operator">&gt;</span>删除<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
			

<span class="token comment">// 加减商品数量请求</span>
<span class="token keyword">async</span> <span class="token function">shoppingNumber</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>many<span class="token punctuation">,</span>price</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'请求中'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> pridec  <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pride<span class="token punctuation">,</span><span class="token punctuation">{</span>id<span class="token operator">:</span>id<span class="token punctuation">,</span>many<span class="token operator">:</span>many<span class="token punctuation">,</span>price<span class="token operator">:</span>price<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ShoppingRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		uni<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 减</span>
<span class="token function">reDuce</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>many<span class="token punctuation">,</span>price</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	many <span class="token operator">--</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">shoppingNumber</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>many<span class="token punctuation">,</span>price<span class="token punctuation">)</span>
			
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 加</span>
<span class="token function">pLus</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>many<span class="token punctuation">,</span>price</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	many <span class="token operator">++</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">shoppingNumber</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>many<span class="token punctuation">,</span>price<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="全选和取消全选"><a href="#全选和取消全选" class="headerlink" title="全选和取消全选"></a>全选和取消全选</h4><p><strong>思路：</strong>在计算属性中，添加一个方法：</p>
<p><strong>判断之前过滤出选的中商品的数组长度 如果等于了购物车里数据长度  就表示全选了所有商品</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 控制全选和取消全选</span>
	<span class="token function">selectall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 判断之前过滤出选中了的商品的数组的长度 如果等于了购物车里数据长度  就表示全选了所有商品</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mapselect<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mycarturl<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>将计算属性返回的方法布尔值通过v-if分别绑定给未全选和全选。</strong></p>
<p><strong>同时给按钮（圆圈）添加点击事件，在点击事件中发起请求，并刷新页面</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-img"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 未全选 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!selectall"</span> @click<span class="token operator">=</span><span class="token string">"quanxuan('seall')"</span> src<span class="token operator">=</span><span class="token string">"/static/details/weixuan.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 全选 <span class="token operator">--</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>image v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"selectall"</span> @click<span class="token operator">=</span><span class="token string">"quanxuan('deall')"</span>  src<span class="token operator">=</span><span class="token string">"/static/details/xuanzhong.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span> <span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 全选商品</span>
<span class="token keyword">async</span> <span class="token function">quanxuan</span><span class="token punctuation">(</span><span class="token parameter">idft</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'请求中'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> selectall  <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>selectall <span class="token operator">+</span> <span class="token string">'?idft='</span> <span class="token operator">+</span> idft<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>selectall<span class="token punctuation">,</span><span class="token string">'全选商品'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ShoppingRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		uni<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="删除购物车商品"><a href="#删除购物车商品" class="headerlink" title="删除购物车商品"></a>删除购物车商品</h4><p>点击删除按钮，删除选中的商品</p>
<p>由接口可知，<strong>删除请求需要携带的参数是已经勾选的商品_id</strong>，所以将已经勾选的商品数组中的  _id单独 拿出存放到新数组中</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"settlement-money"</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"!settips"</span> @click<span class="token operator">=</span><span class="token string">"total.disable &amp;&amp; deLece()"</span><span class="token operator">&gt;</span>删除				<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		emcart<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		mycarturl<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">//购物车数据</span>
		editdata<span class="token operator">:</span><span class="token string">'管理'</span><span class="token punctuation">,</span>
		settips<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">//默认展示右下角 结算还是删除</span>
		mapselect<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//存放已勾选单个商品的总价</span>
		cartdele<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//存放已经被勾选的商品 _id</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>


<span class="token comment">// 计算单个商品总价</span>
<span class="token function">coselect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 过滤出数组中 choice为 true的对象  即已经勾选的商品   filter会将目标对象放到新数组中</span>
	<span class="token keyword">let</span> filselect <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mycarturl<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>choice<span class="token punctuation">)</span>
	<span class="token comment">// 	取出被选中的 数组中的的总价</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>mapselect <span class="token operator">=</span> filselect<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>total_price<span class="token punctuation">)</span>
	<span class="token comment">// 将已经被勾选的商品, 购物车_id 单独存放出来</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>cartdele <span class="token operator">=</span> filselect<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>_id<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// 删除</span>
<span class="token keyword">async</span> <span class="token function">deLece</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'请求中'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> cartdelete  <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cartdelete<span class="token punctuation">,</span><span class="token punctuation">{</span>arrid<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>cartdele<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cartdelete<span class="token punctuation">,</span><span class="token string">'购物车删除商品'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ShoppingRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		uni<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
				
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="购物车重选sku颜色尺码（上）"><a href="#购物车重选sku颜色尺码（上）" class="headerlink" title="购物车重选sku颜色尺码（上）"></a>购物车重选sku颜色尺码（上）</h4><p>思路：公共组件addtocart.vue，就是之前写好的sku组件，因此要引用到shopping.vue组件中，然后展示到页面中使用</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> sku组件<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 为什么是skudata 因为 sku组件中 props接收父组件的 键值对k名称就是skudata <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Addtocart ref<span class="token operator">=</span><span class="token string">"addto"</span> <span class="token operator">:</span>skudata<span class="token operator">=</span><span class="token string">"skudata"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Addtocart<span class="token operator">&gt;</span>

<span class="token comment">// sku组件    引用到shopping.vue组件中</span>
<span class="token keyword">import</span> Addtocart <span class="token keyword">from</span> <span class="token string">'../commponents/addtocart.vue'</span>


<span class="token comment">// 弹出sku组件 直接弹出组件是没数据的因此要调用 相关接口</span>
<span class="token function">normsFun</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> mycarturl <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mycarturl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>然后给相应的位置添加点击事件，同时携带商品id传入请求方法中，同时通过ref控制sku组件中的showCou（）方法，将001传入，001代表的是</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 弹出sku组件 直接弹出组件是没数据的因此要调用 相关接口</span>
<span class="token keyword">async</span> <span class="token function">normsFun</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> cartsku <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cartsku <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cartsku<span class="token punctuation">,</span><span class="token string">'弹出sku组件'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>skudata <span class="token operator">=</span> cartsku<span class="token punctuation">.</span>data
		<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>addto<span class="token punctuation">.</span><span class="token function">showCou</span><span class="token punctuation">(</span><span class="token string">'001'</span><span class="token punctuation">)</span>   <span class="token comment">// 显示组件</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>在<strong>sku组件</strong>中，001表示调用001表示购物车重选</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 确定按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
													<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 利用计算属性 如果两个未选中静止使用确定按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"determine coup-anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"mean == '001'"</span> @click<span class="token operator">=</span><span class="token string">"skumen.ban &amp;&amp; detErmine()"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"determine coup-anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"mean == '002'"</span> @click<span class="token operator">=</span><span class="token string">"skumen.ban &amp;&amp; detErmine()"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"determine coup-anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"mean == '003'"</span> @click<span class="token operator">=</span><span class="token string">"skumen.ban &amp;&amp; purChase()"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>


<span class="token comment">// 被其他组件调用显示sku组件  mean 等于 002代表加入购物车    003代表直接购买  	001表示购物车重选</span>
<span class="token function">showCou</span><span class="token punctuation">(</span><span class="token parameter">mean</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>mean <span class="token operator">=</span> mean
	<span class="token keyword">this</span><span class="token punctuation">.</span>couponif <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>难点1</strong>：<strong>当在购物车组件中点击sku时候，展示的效果应该和购物车所选好的尺码颜色等信息相同</strong></p>
<p>思路：<strong>点击事件携带的参数，再加上从购物车获取到的本条商品的一些信息传递到sku组件</strong></p>
<p>在购物车组件中，点击normsFun方法，携带相关参数，使用id发起请求，将请求结果cartsku.data  和normsFun点击事件拿到的商品_id  尺码 颜色 商品数量一起传递到 sku组件addtocart中。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 点击调出sku组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"shopp-chick-sku"</span> @click<span class="token operator">=</span><span class="token string">"normsFun(item.id,item.id,item.size,item.color,item.many)"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>size<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/details/jiantou.svg"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>


<span class="token comment">// 弹出sku组件 直接弹出组件是没数据的因此要调用 相关接口</span>
<span class="token keyword">async</span> <span class="token function">normsFun</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>_id<span class="token punctuation">,</span>size<span class="token punctuation">,</span>color<span class="token punctuation">,</span>many</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token comment">// 购物车页面重选sku接口</span>
		<span class="token keyword">let</span> cartsku <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cartsku <span class="token operator">+</span> <span class="token string">'?id='</span> <span class="token operator">+</span> id <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modeget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cartsku<span class="token punctuation">,</span><span class="token string">'购物车弹出的sku组件'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>skudata <span class="token operator">=</span> cartsku<span class="token punctuation">.</span>data  	<span class="token comment">//得到商品sku展示的所以商品尺码 颜色等信息</span>
		<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>sku<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>skudata<span class="token punctuation">,</span>size<span class="token punctuation">,</span>color<span class="token punctuation">,</span>_id<span class="token punctuation">,</span>many<span class="token punctuation">}</span>  <span class="token comment">// 这里重新组合一个对象，传递到sku组件中用于修改弹出的商品信息</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>addto<span class="token punctuation">.</span><span class="token function">showCou</span><span class="token punctuation">(</span><span class="token string">'001'</span><span class="token punctuation">,</span>obj<span class="token punctuation">)</span>   <span class="token comment">// 显示组件同时传递 obj对象</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>sku组件addtocart，showCou方法的第二个参数，接收了数据，解构数据后进行了如下操作</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">
<span class="token comment">// 被其他组件调用显示sku组件  mean 等于 002代表加入购物车    003代表直接购买  001表示购物车重选</span>
<span class="token function">showCou</span><span class="token punctuation">(</span><span class="token parameter">mean<span class="token punctuation">,</span>obj<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>mean <span class="token operator">=</span> mean
	<span class="token keyword">if</span><span class="token punctuation">(</span>mean <span class="token operator">==</span> <span class="token string">'001'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 解构接收到的值</span>
		<span class="token keyword">let</span> <span class="token punctuation">{</span>sku<span class="token punctuation">,</span>size<span class="token punctuation">,</span>color<span class="token punctuation">,</span>_id<span class="token punctuation">,</span>many<span class="token punctuation">}</span> <span class="token operator">=</span> obj
		<span class="token comment">// 将这些值 替代sku组件中的值</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>_id <span class="token operator">=</span> _id 			<span class="token comment">// 购物车选中的商品 _id</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>momany <span class="token operator">=</span> many		<span class="token comment">// 购物车选中的商品数量</span>
		<span class="token comment">// 使用findIndex 方法，对购物车弹出的sku所展示的第0项商品信息进行遍历，找出尺码和购物车点击的尺码一样的下标</span>
		<span class="token comment">// findIndex() 方法对数组中存在的每个元素执行一次函数，返回该符合数组元素的索引 否则返回 -1</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>sizenum <span class="token operator">=</span> sku<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item <span class="token operator">==</span> size<span class="token punctuation">)</span>	<span class="token comment">// 获取在购物车页面点击商品尺码哪里，已经展示的尺码对应的下标 并赋值给sku页面 所展示已经选中的尺码</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>colornum <span class="token operator">=</span> sku<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>color <span class="token operator">==</span> color<span class="token punctuation">)</span> <span class="token comment">// 获取在购物车页面点击商品尺码哪里，已经展示的颜色对应的下标 并赋值给sku页面 所展示已经选中的颜色</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue <span class="token operator">=</span> color	<span class="token comment">//这里是值下方的监听方法，监听到colorvalue值改变后进行改变颜色</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue <span class="token operator">=</span> size	<span class="token comment">//同上监听方法</span>
	<span class="token punctuation">}</span>
				
	<span class="token keyword">this</span><span class="token punctuation">.</span>couponif <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="购物车重选sku颜色尺码（下）"><a href="#购物车重选sku颜色尺码（下）" class="headerlink" title="购物车重选sku颜色尺码（下）"></a>购物车重选sku颜色尺码（下）</h4><p><strong>难点</strong>：当用户从购物车点进sku组件时，重新选择了商品尺码和颜色后，</p>
<p>点击事件命名为 <strong>modifySku</strong></p>
<p>传入修改sku请求接口需要的参数 data 发起请求</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 确定按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
													<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 利用计算属性 如果两个未选中静止使用确定按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"determine coup-anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"mean == '001'"</span> @click<span class="token operator">=</span><span class="token string">"skumen.ban &amp;&amp; modifySku()"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"determine coup-anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"mean == '002'"</span> @click<span class="token operator">=</span><span class="token string">"skumen.ban &amp;&amp; detErmine()"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"determine coup-anim"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"mean == '003'"</span> @click<span class="token operator">=</span><span class="token string">"skumen.ban &amp;&amp; purChase()"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>



<span class="token comment">// 购物车修改sku</span>
<span class="token keyword">async</span> <span class="token function">modifySku</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> <span class="token punctuation">{</span>image<span class="token punctuation">,</span>price<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>attribute
	<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
		id<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>_id<span class="token punctuation">,</span>
		skuid<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span>
		size<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizevalue<span class="token punctuation">,</span>
		color<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>colorvalue<span class="token punctuation">,</span>
		image<span class="token punctuation">,</span>
		price<span class="token punctuation">,</span>
		many<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>momany<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
		<span class="token comment">// 购物车修改sku接口  </span>
		<span class="token keyword">let</span> skubase <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skubase<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>skubase<span class="token punctuation">,</span><span class="token string">'购物车修改sku接口'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>skubase<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">'SUCCESS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hideCou</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//隐藏sku组件</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'mycart'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>cart<span class="token operator">:</span>skubase<span class="token punctuation">.</span>msg<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">// 刷新购物车</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//TODO handle the exception</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="购物车结算"><a href="#购物车结算" class="headerlink" title="购物车结算"></a>购物车结算</h4><p><strong>思路：</strong>在购物车组件 <strong>shopping.vue</strong> 中，需要勾选了商品才能结算</p>
<p>提前在计算总价方法中存储已经勾选的商品数据，将其传递到付款组件中，注意因为JSON.parse识别不到某些特殊字符，因此使用 encodeURIComponent、decodeURIComponent方式</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 计算单个商品总价 (已经勾选的商品 filselect )</span>
<span class="token function">coselect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 过滤出数组中 choice 为 true的对象  即已经勾选的商品    filter会将目标对象放到新数组中</span>
	<span class="token keyword">let</span> filselect <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mycarturl<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>choice<span class="token punctuation">)</span>
	<span class="token comment">// 	取出被选中的 数组中的的总价</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>mapselect <span class="token operator">=</span> filselect<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>total_price<span class="token punctuation">)</span>
	<span class="token comment">// 将已经被勾选的商品, 购物车_id 单独存放出来</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>cartdele <span class="token operator">=</span> filselect<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>_id<span class="token punctuation">)</span>
	
	<span class="token comment">// 存储已经勾选的商品数据</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>settlement <span class="token operator">=</span> filselect
<span class="token punctuation">}</span><span class="token punctuation">,</span>


<span class="token comment">// 结算</span>
<span class="token function">semEnt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'结算'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 数组，对象转换成字符串才能携带值</span>
	<span class="token keyword">let</span> cartdata <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>settlement<span class="token punctuation">)</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cartdata<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 跳转到下单页面</span>
	uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		url<span class="token operator">:</span><span class="token string">'../payment-page/payment?cartdata='</span> <span class="token operator">+</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>cartdata<span class="token punctuation">)</span><span class="token punctuation">,</span>
		
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>在付款组件，payment.vue中</strong>接收值</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// e就是路径上携带的值 来自于addtocart组件 purChase方法</span>
<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> cartdataing <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cartdata<span class="token punctuation">)</span>
						<span class="token comment">// 将JSON字符串转化为js对象</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>comminfo <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>cartdataing<span class="token punctuation">)</span>
		<span class="token comment">// 合计支付总价计算 numdata默认为0，使用forEach遍历</span>
		<span class="token keyword">let</span> numdata <span class="token operator">=</span> <span class="token number">0</span>
		<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>cartdataing<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			numdata <span class="token operator">+=</span> item<span class="token punctuation">.</span>total_price
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token comment">// 合计总价 小数点两位数</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>Totalprice <span class="token operator">=</span> <span class="token function">Price</span><span class="token punctuation">(</span>numdata<span class="token punctuation">)</span> <span class="token comment">// 将需补0的数据传入方法</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>  由于支付接口要求：如果是购物车商品结算，需要把购物车中每个商品的_id作为一个数组字符串存储起来，否则填写空数组</p>
<p>如果支付成功后，购物车里就删除这个商品id的商品</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// e就是路径上携带的值 来自于addtocart组件 purChase方法</span>
<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> cartdataing <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>cartdata<span class="token punctuation">)</span>  <span class="token comment">//接收json字符串</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>comminfo <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>cartdataing<span class="token punctuation">)</span>  <span class="token comment">// 将JSON字符串转化为js对象</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>comminfo <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">let</span> numdata <span class="token operator">=</span> <span class="token number">0</span>   			<span class="token comment">// 合计支付总价计算 numdata默认为0，使用forEach遍历</span>
		<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>cartdataing<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			numdata <span class="token operator">+=</span> item<span class="token punctuation">.</span>total_price
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token comment">// 合计总价 小数点两位数</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>Totalprice <span class="token operator">=</span> <span class="token function">Price</span><span class="token punctuation">(</span>numdata<span class="token punctuation">)</span> <span class="token comment">// 将需补0的数据传入方法</span>
		
		<span class="token comment">// 存储购物车来的数据的商品_id</span>
		<span class="token comment">// _id 都在数组 this.comminfo 里边 有可能不止一个商品 因此要 筛选取出</span>
		<span class="token keyword">let</span> _id <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>cartdataing<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>_id<span class="token punctuation">)</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>idcard <span class="token operator">=</span> _id<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>_id<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>同时，当提交订单支付成功后，应该跳到待发货界面， 2-3步，因为没有商品号，所以注释掉，使用的虚拟支付接口</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 提交订单</span>
<span class="token keyword">async</span> <span class="token function">placeOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 触发下单按钮后的提示</span>
	<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span><span class="token string">'正在下单中'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showloading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//手动 弹窗</span>
	
	<span class="token comment">// 商品数据 通过对comminfo数据进行map方法遍历，会返回一个新的数组对象</span>
	<span class="token keyword">let</span> codata <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>comminfo<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> data <span class="token operator">=</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span>item<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
			image<span class="token operator">:</span>item<span class="token punctuation">.</span>image<span class="token punctuation">,</span>
			title<span class="token operator">:</span>item<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
			size<span class="token operator">:</span>item<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
			color<span class="token operator">:</span>item<span class="token punctuation">.</span>color<span class="token punctuation">,</span>
			price<span class="token operator">:</span>item<span class="token punctuation">.</span>price<span class="token punctuation">,</span>
			many<span class="token operator">:</span>item<span class="token punctuation">.</span>many<span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> data
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">// 准备一个对象 将请求需要的参数放入</span>
	<span class="token keyword">let</span> dataobj <span class="token operator">=</span> <span class="token punctuation">{</span>
		consignee<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>orderdata<span class="token punctuation">,</span> 		<span class="token comment">// 收货地址相关数据</span>
		commodity<span class="token operator">:</span>codata<span class="token punctuation">,</span>				<span class="token comment">// 商品相关数据</span>
		total_price<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>Totalprice<span class="token punctuation">,</span>	<span class="token comment">// 支付总价数据</span>
		idcard<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>idcard<span class="token punctuation">,</span>				<span class="token comment">// 购物车内所有商品的id相关数据</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 1.请求统一下单接口   </span>
	<span class="token keyword">try</span><span class="token punctuation">{</span>
						<span class="token comment">// 微信支付: 统一下单接口</span>
		<span class="token comment">// var wxpay = await new this.Request(this.Urls.m().wxpay,dataobj).modepost();</span>
						<span class="token comment">// 因为个人没有认证微信商户号，这里使用的是虚拟支付接口 返回结果是"SUCCESS"</span>
		<span class="token keyword">let</span> fictpay <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>Request</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Urls<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fictpayurl<span class="token punctuation">,</span>dataobj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modepost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>fictpay<span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">"SUCCESS"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 存储商户订单号和订单id</span>
				<span class="token comment">// this.outno = wxpayurl.data.out_trade_no</span>
				<span class="token comment">// this.ide = wxpayurl.data.id</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>fictpay<span class="token punctuation">.</span>data<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
				<span class="token comment">// 关闭当前下单页面，跳转到代发货页面</span>
				uni<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
						url<span class="token operator">:</span><span class="token string">'../personal/personal?index='</span> <span class="token operator">+</span> <span class="token number">1</span>
					<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// e就是throw 捕获的错误 </span>
		<span class="token comment">// throw 用来捕获一个错误  </span>
		<span class="token comment">//如果catch 中出现throw关键词，此时try catch 后边的代码将不会执行 即不会调用下边的微信接口</span>
		<span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span></span><span class="token function">$Toast</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">showtoast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//反馈 弹窗</span>
		<span class="token keyword">throw</span> e 	
	<span class="token punctuation">}</span>
				
	<span class="token comment">// 2.调用微信支付接口</span>
				
	<span class="token comment">// try{</span>
	<span class="token comment">// package：属于源码里的关键词</span>
	<span class="token comment">// 从真正的微信支付接口中拿到返回结果，这五个数据用于调用微信支付接口时作为参数，</span>
	<span class="token comment">// let { nonceStr,paySign,signType,timeStamp } = wxpay.data</span>
	<span class="token comment">// 使用下方调用支付的方法</span>
	<span class="token comment">// await this.wxPay({ nonceStr,paySign,signType,timeStamp,package:wxpay.data.package })</span>
<span class="token comment">// }catch(e){</span>
		<span class="token comment">// new this.$Toast('支付失败','none').showtoast() //反馈 弹窗</span>
		<span class="token comment">// uni.redirectTo({</span>
		<span class="token comment">// 	url:'../personal/personal?index=' + 0</span>
		<span class="token comment">// })</span>
		<span class="token comment">// throw e</span>
<span class="token comment">// }	</span>
				
	<span class="token comment">// 3.查询订单是否支付成功 （去微信那边查询是否成功）		</span>
	<span class="token comment">// try{</span>
		<span class="token comment">// 	let dataobj = {outno:this.outno,id:this.ide}</span>
		<span class="token comment">// 	let queryorderurl = await new this.Request(this.Urls.m().queryorderurl,dataobj).modepost()</span>
			<span class="token comment">// 	if(queryorderurl.data.msg == 'SUCCESS') {</span>
			<span class="token comment">// 		new this.$Toast('支付成功').showtoast() //反馈 弹窗</span>
			<span class="token comment">// 		uni.redirectTo({</span>
			<span class="token comment">// 			url:'../personal/personal?index=' + 1</span>
			<span class="token comment">// 		})</span>
			<span class="token comment">// 	}</span>
	<span class="token comment">// }catch(e){</span>
		<span class="token comment">// 		new this.$Toast(e,'none').showtoast() //反馈 弹窗</span>
		<span class="token comment">// }</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="项目优化"><a href="#项目优化" class="headerlink" title="项目优化"></a>项目优化</h3><p>在首页，点击商品后，应该出现一个正在加载的图标</p>
<p>在pages下新建 full-loading.vue 组件，</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"full-loading"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"Loading"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">"/static/loading/loadtmall.gif"</span> mode<span class="token operator">=</span><span class="token string">"widthFix"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
              

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			Loading<span class="token operator">:</span> <span class="token boolean">true</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	methods<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">value <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>Loading <span class="token operator">=</span> value
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>full<span class="token operator">-</span>loading<span class="token punctuation">{</span>
position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
background<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">999</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>full<span class="token operator">-</span>loading image<span class="token punctuation">{</span>width<span class="token operator">:</span> <span class="token number">100</span>rpx<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">100</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>再取main.js中引入</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 页面加载loading</span>
<span class="token keyword">import</span> loading <span class="token keyword">from</span> <span class="token string">'pages/commponents/full-loading.vue'</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'full-loading'</span><span class="token punctuation">,</span>loading<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>最后在想要加上加载效果的页面上如下添加</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 页面加载 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>full<span class="token operator">-</span>loading ref<span class="token operator">=</span><span class="token string">"fullload"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>full<span class="token operator">-</span>loading<span class="token operator">&gt;</span>

<span class="token comment">// 取消loading组件的加载效果</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>fullload<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>THE END</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%A1%B9%E7%9B%AE/">项目</a><a class="post-meta__tags" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">小程序</a></div><div class="post_share"><div class="social-share" data-image="https://images8.alphacoders.com/120/1206602.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://s1.ax1x.com/2022/04/13/LQAktI.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s1.ax1x.com/2022/04/13/LQAktI.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://s1.ax1x.com/2022/04/13/LQA1Nn.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s1.ax1x.com/2022/04/13/LQA1Nn.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/18.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://images.alphacoders.com/746/746111.jpg" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">git基本操作</div></div></a></div><div class="next-post pull-right"><a href="/posts/16.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://images8.alphacoders.com/120/1206602.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Axios新版学习大纲</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NjA5Ni8zMjU1OQ=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s1.ax1x.com/2022/04/13/LQEmP1.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Zimo</div><div class="author-info__description">人要接受自己的有限性，人的逻辑、理性、阅读都是有限的，整个人就是在偏见之中。人这一生就是在走出偏见。</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">21</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">16</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div><a class="button--animated" id="card-info-btn" href="https://wuzimo233.github.io"><i class="fa-solid fa-house-chimney"></i><span>个人主页</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/wuzimo233" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://space.bilibili.com/17723284" target="_blank" title="bilibili"><i class="fa-brands fa-bilibili"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">叶上初阳干宿雨，水面清圆，一一风荷举</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87"><span class="toc-number">1.</span> <span class="toc-text">准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E7%AF%87"><span class="toc-number">1.1.</span> <span class="toc-text">工具篇</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.2.</span> <span class="toc-text">前言</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.</span> <span class="toc-text">搭建项目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E7%95%8C%E9%9D%A2%E9%85%8D%E7%BD%AE"><span class="toc-number">2.1.</span> <span class="toc-text">主界面配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A6%96%E9%A1%B5%E7%BB%84%E4%BB%B6%E6%8B%86%E5%88%86"><span class="toc-number">2.2.</span> <span class="toc-text">首页组件拆分</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%8C%E6%88%90%E6%90%9C%E7%B4%A2%E7%BB%84%E4%BB%B6%E5%B1%95%E7%A4%BA"><span class="toc-number">2.2.1.</span> <span class="toc-text">完成搜索组件展示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AE%E6%92%AD%E5%B1%95%E7%A4%BA%E4%B8%8E%E8%AF%B7%E6%B1%82%E8%BD%AE%E6%92%AD%E6%95%B0%E6%8D%AE"><span class="toc-number">2.2.2.</span> <span class="toc-text">自定义轮播展示与请求轮播数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#class%E5%B0%81%E8%A3%85request%E8%AF%B7%E6%B1%82"><span class="toc-number">2.2.3.</span> <span class="toc-text">class封装request请求</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E8%AF%B7%E6%B1%82%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.2.3.1.</span> <span class="toc-text">封装请求接口</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F"><span class="toc-number">2.2.3.2.</span> <span class="toc-text">封装请求方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E8%AF%B7%E6%B1%82%E6%8E%A5%E5%8F%A3%E5%88%B0%E7%88%B6%E7%BB%84%E4%BB%B6"><span class="toc-number">2.2.3.3.</span> <span class="toc-text">统一请求接口到父组件</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%8C%E6%88%90%E6%8E%A8%E8%8D%90%E6%8A%A2%E8%B4%AD%E5%95%86%E5%93%81%E7%BB%84%E4%BB%B6%E6%95%B0%E6%8D%AE"><span class="toc-number">2.2.4.</span> <span class="toc-text">完成推荐抢购商品组件数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%8C%E6%88%90%E5%A4%A9%E7%8C%AB%E6%A6%9C%E5%8D%95%E7%BB%84%E4%BB%B6%E6%95%B0%E6%8D%AE"><span class="toc-number">2.2.5.</span> <span class="toc-text">完成天猫榜单组件数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E5%B9%B6%E8%AF%B7%E6%B1%82%E5%8D%A1%E7%89%87%E6%B5%81%E5%95%86%E5%93%81%E7%BB%84%E4%BB%B6"><span class="toc-number">2.2.6.</span> <span class="toc-text">封装并请求卡片流商品组件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%8C%E6%88%90%E4%B8%8A%E6%8B%89%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.2.6.1.</span> <span class="toc-text">完成上拉加载</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E4%B8%8A%E6%8B%89%E6%8F%90%E7%A4%BA"><span class="toc-number">2.2.6.2.</span> <span class="toc-text">封装上拉提示</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%95%86%E5%93%81%E6%90%9C%E7%B4%A2%E9%A1%B5%E9%9D%A2"><span class="toc-number">2.2.7.</span> <span class="toc-text">商品搜索页面</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8E%86%E5%8F%B2%E6%90%9C%E7%B4%A2%E7%9A%84%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.2.7.1.</span> <span class="toc-text">历史搜索的功能实现</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%95%86%E5%93%81%E6%90%9C%E7%B4%A2%E8%AF%B7%E6%B1%82%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.2.7.2.</span> <span class="toc-text">商品搜索请求接口</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E9%A1%B5"><span class="toc-number">2.3.</span> <span class="toc-text">商品详情页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A1%B6%E9%83%A8%E5%AF%BC%E8%88%AA%E6%A0%8F"><span class="toc-number">2.3.1.</span> <span class="toc-text">自定义顶部导航栏</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BB%9A%E5%8A%A8%E7%9B%91%E5%90%AC%E6%98%BE%E7%A4%BA%E9%9A%90%E8%97%8F%E5%AF%BC%E8%88%AA%E6%A0%8F"><span class="toc-number">2.3.2.</span> <span class="toc-text">滚动监听显示隐藏导航栏</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%A6%E8%A7%86%E9%A2%91%E5%92%8C%E5%9B%BE%E7%89%87%E7%9A%84%E8%BD%AE%E6%92%AD%E7%BB%84%E4%BB%B6"><span class="toc-number">2.3.3.</span> <span class="toc-text">带视频和图片的轮播组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E6%93%8D%E4%BD%9C%E7%9A%84%E4%B8%80%E4%BA%9B%E6%96%B9%E6%B3%95"><span class="toc-number">2.3.4.</span> <span class="toc-text">视频操作的一些方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82banner%E6%A0%8F%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.5.</span> <span class="toc-text">请求banner栏的数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E9%A2%84%E8%A7%88%E5%9B%BE%E7%89%87"><span class="toc-number">2.3.6.</span> <span class="toc-text">封装预览图片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%95%86%E5%93%81%E6%A0%87%E9%A2%98%E4%BB%B7%E6%A0%BC%E7%AD%89%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.7.</span> <span class="toc-text">获取商品标题价格等数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%84%E5%BC%9F%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC%E8%AF%B7%E6%B1%82%E4%BA%A7%E5%93%81%E5%8F%82%E6%95%B0%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.8.</span> <span class="toc-text">兄弟组件传值请求产品参数数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%95%86%E5%93%81%E8%AF%84%E4%BB%B7%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.9.</span> <span class="toc-text">获取商品评价数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E5%9B%BE%E7%89%87%E4%BB%8B%E7%BB%8D%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.10.</span> <span class="toc-text">请求商品详情图片介绍数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%95%86%E5%93%81%E6%89%80%E6%9C%89%E7%9A%84%E8%AF%84%E4%BB%B7"><span class="toc-number">2.3.11.</span> <span class="toc-text">商品所有的评价</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%8C%E6%88%90%E5%95%86%E5%93%81%E5%88%86%E7%B1%BB%E6%9F%A5%E8%AF%A2%E8%AF%84%E4%BB%B7"><span class="toc-number">2.3.12.</span> <span class="toc-text">完成商品分类查询评价</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%94%9A%E7%82%B9%E9%93%BE%E6%8E%A5%E5%B0%86%E9%A1%B5%E9%9D%A2%E6%BB%9A%E5%8A%A8%E5%88%B0%E7%9B%AE%E6%A0%87%E4%BD%8D%E7%BD%AE"><span class="toc-number">2.3.13.</span> <span class="toc-text">锚点链接将页面滚动到目标位置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E9%A1%B5%E4%B8%8B%E6%96%B9%E7%9A%84%E5%8A%9F%E8%83%BD%E7%BB%84%E4%BB%B6"><span class="toc-number">2.3.14.</span> <span class="toc-text">商品详情页下方的功能组件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%94%B6%E8%97%8F%E5%92%8C%E5%8F%96%E6%B6%88%E6%94%B6%E8%97%8F%E5%8A%9F%E8%83%BD"><span class="toc-number">2.3.14.1.</span> <span class="toc-text">收藏和取消收藏功能</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E5%BC%B9%E7%AA%97%E4%BB%A5%E5%8F%8A%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%99%BB%E5%BD%95"><span class="toc-number">2.3.14.2.</span> <span class="toc-text">登录弹窗以及微信小程序登录</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E5%BC%B9%E7%AA%97"><span class="toc-number">2.3.14.2.1.</span> <span class="toc-text">登录弹窗</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E9%80%BB%E8%BE%91"><span class="toc-number">2.3.14.2.2.</span> <span class="toc-text">登录逻辑</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%94%B6%E8%97%8F%E6%8C%89%E9%92%AE%E9%80%BB%E8%BE%91"><span class="toc-number">2.3.14.2.3.</span> <span class="toc-text">收藏按钮逻辑</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E6%B6%88%E6%81%AF%E6%8F%90%E7%A4%BA%E6%A1%86"><span class="toc-number">2.3.14.3.</span> <span class="toc-text">封装消息提示框</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%90%BA%E5%B8%A6token%E4%BB%A4%E7%89%8C%E7%99%BB%E5%BD%95%E5%B0%8F%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.3.14.4.</span> <span class="toc-text">携带token令牌登录小程序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%AF%A5%E5%95%86%E5%93%81%E6%98%AF%E5%90%A6%E5%B7%B2%E7%BB%8F%E6%94%B6%E8%97%8F"><span class="toc-number">2.3.14.5.</span> <span class="toc-text">获取该商品是否已经收藏</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%B4%AD%E7%89%A9%E8%BD%A6%E5%95%86%E5%93%81%E4%BB%B6%E6%95%B0"><span class="toc-number">2.3.14.6.</span> <span class="toc-text">获取购物车商品件数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E5%95%86%E5%93%81sku%E9%80%89%E6%8B%A9%E7%BB%84%E4%BB%B6"><span class="toc-number">2.3.14.7.</span> <span class="toc-text">封装商品sku选择组件</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%98%BE%E7%A4%BA%E7%BB%84%E4%BB%B6%E6%80%9D%E8%B7%AF"><span class="toc-number">2.3.14.7.1.</span> <span class="toc-text">显示组件思路:</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%9A%90%E8%97%8F%E7%BB%84%E4%BB%B6%E6%80%9D%E8%B7%AF%EF%BC%9A"><span class="toc-number">2.3.14.7.2.</span> <span class="toc-text">隐藏组件思路：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#sku%E7%BB%84%E4%BB%B6%E7%9A%84%E7%A1%AE%E5%AE%9A%E5%8A%9F%E8%83%BD"><span class="toc-number">2.3.14.7.3.</span> <span class="toc-text">sku组件的确定功能</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%95%86%E5%93%81sku%E7%BB%84%E4%BB%B6%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.14.8.</span> <span class="toc-text">请求商品sku组件的数据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7%E5%A4%84%E7%90%86%E9%80%89%E4%B8%AD%E6%9F%90%E4%B8%AAsku"><span class="toc-number">2.3.14.9.</span> <span class="toc-text">计算属性处理选中某个sku</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E6%AF%8F%E4%B8%AAsku%E7%9A%84%E5%BA%93%E5%AD%98%E3%80%81%E4%BB%B7%E6%A0%BC"><span class="toc-number">2.3.14.10.</span> <span class="toc-text">请求每个sku的库存、价格</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%95%86%E5%93%81%E8%B4%AD%E4%B9%B0%E6%95%B0%E9%87%8F%E5%8A%A0%E5%87%8F"><span class="toc-number">2.3.14.11.</span> <span class="toc-text">商品购买数量加减</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A0%E5%85%A5%E6%89%80%E9%80%89%E5%95%86%E5%93%81%E5%88%B0%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="toc-number">2.3.14.12.</span> <span class="toc-text">加入所选商品到购物车</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#vuex%E4%BC%A0%E5%80%BC%E5%88%B0%E8%B4%AD%E7%89%A9%E8%BD%A6%E7%9A%84%E5%95%86%E5%93%81%E6%95%B0%E9%87%8F"><span class="toc-number">2.3.14.13.</span> <span class="toc-text">vuex传值到购物车的商品数量</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%95%86%E5%93%81%E8%AE%A2%E5%8D%95%E9%A1%B5"><span class="toc-number">2.4.</span> <span class="toc-text">商品订单页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E4%B8%8B%E5%8D%95%E8%8E%B7%E5%8F%96%E5%BE%85%E4%BB%98%E6%AC%BE%E5%95%86%E5%93%81%E6%95%B0%E6%8D%AE"><span class="toc-number">2.4.1.</span> <span class="toc-text">直接下单获取待付款商品数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E5%B1%82%E5%B1%95%E7%A4%BA%E5%BE%85%E4%BB%98%E6%AC%BE%E7%9A%84%E5%95%86%E5%93%81"><span class="toc-number">2.4.2.</span> <span class="toc-text">视图层展示待付款的商品</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%88%91%E7%9A%84%E6%94%B6%E8%B4%A7%E5%9C%B0%E5%9D%80%E9%A1%B5%E9%9D%A2"><span class="toc-number">2.4.3.</span> <span class="toc-text">我的收货地址页面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%88%91%E7%9A%84%E6%94%B6%E8%B4%A7%E5%9C%B0%E5%9D%80%E6%95%B0%E6%8D%AE"><span class="toc-number">2.4.4.</span> <span class="toc-text">获取我的收货地址数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E6%94%B6%E8%B4%A7%E5%9C%B0%E5%9D%80"><span class="toc-number">2.4.5.</span> <span class="toc-text">新增收货地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%88%A0%E9%99%A4%E6%94%B6%E8%B4%A7%E5%9C%B0%E5%9D%80"><span class="toc-number">2.4.6.</span> <span class="toc-text">更改删除收货地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%95%86%E5%93%81%E8%AE%A2%E5%8D%95%E9%A1%B5%E9%80%89%E6%8B%A9%E6%94%B6%E8%B4%A7%E5%9C%B0%E5%9D%80"><span class="toc-number">2.4.7.</span> <span class="toc-text">商品订单页选择收货地址</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98"><span class="toc-number">2.5.</span> <span class="toc-text">微信支付</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%94%AF%E4%BB%98%E6%89%80%E9%9C%80%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%BB%A5%E5%8F%8Atry-catch-%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">2.5.1.</span> <span class="toc-text">获取支付所需数据，以及try{}catch{}的应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#wx-requestpayment-%E8%B0%83%E8%B5%B7%E5%BE%AE%E4%BF%A1%E4%BB%98%E6%AC%BE"><span class="toc-number">2.5.2.</span> <span class="toc-text">wx.requestpayment()调起微信付款</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%AE%A2%E5%8D%95%E6%98%AF%E5%90%A6%E6%94%AF%E4%BB%98%E6%88%90%E5%8A%9F"><span class="toc-number">2.5.3.</span> <span class="toc-text">查询订单是否支付成功</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E8%B7%B3%E8%BD%AC%E8%AF%A6%E6%83%85%E9%A1%B5"><span class="toc-number">2.5.4.</span> <span class="toc-text">动态路由跳转详情页</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83%E9%A1%B5%E9%9D%A2"><span class="toc-number">2.6.</span> <span class="toc-text">个人中心页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E4%B8%AD%E5%BF%83%E9%A1%B5%E9%9D%A2"><span class="toc-number">2.7.</span> <span class="toc-text">订单中心页面</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BE%85%E4%BB%98%E6%AC%BE%E8%AE%A2%E5%8D%95"><span class="toc-number">2.7.1.</span> <span class="toc-text">获取待付款订单</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E7%9A%84%E8%AF%A6%E6%83%85%E9%A1%B5"><span class="toc-number">2.7.2.</span> <span class="toc-text">订单的详情页</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%85%E4%BB%98%E6%AC%BE%E5%86%8D%E6%AC%A1%E4%BB%98%E6%AC%BE%EF%BC%88%E4%B8%8A%EF%BC%89"><span class="toc-number">2.7.3.</span> <span class="toc-text">待付款再次付款（上）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%85%E4%BB%98%E6%AC%BE%E5%86%8D%E6%AC%A1%E4%BB%98%E6%AC%BE%EF%BC%88%E4%B8%8B%EF%BC%89"><span class="toc-number">2.7.4.</span> <span class="toc-text">待付款再次付款（下）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E8%AF%A6%E6%83%85%E9%A1%B5"><span class="toc-number">2.8.</span> <span class="toc-text">订单详情页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%AE%A2%E5%8D%95"><span class="toc-number">2.8.1.</span> <span class="toc-text">删除订单</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%85%E5%8F%91%E8%B4%A7%E5%92%8C%E5%BE%85%E6%94%B6%E8%B4%A7"><span class="toc-number">2.8.2.</span> <span class="toc-text">待发货和待收货</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#delivered-vue%E5%BE%85%E5%8F%91%E8%B4%A7"><span class="toc-number">2.8.2.1.</span> <span class="toc-text">**delivered.vue待发货 **</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#received-vue-%E5%BE%85%E6%94%B6%E8%B4%A7"><span class="toc-number">2.8.2.2.</span> <span class="toc-text">**received.vue **待收货</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%85%E8%AF%84%E4%BB%B7"><span class="toc-number">2.8.3.</span> <span class="toc-text">待评价</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%95%86%E5%93%81%E8%AF%84%E4%BB%B7%EF%BC%88%E4%B8%8A%EF%BC%89"><span class="toc-number">2.8.4.</span> <span class="toc-text">商品评价（上）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%95%86%E5%93%81%E8%AF%84%E4%BB%B7%EF%BC%88%E4%B8%8B%EF%BC%89"><span class="toc-number">2.8.5.</span> <span class="toc-text">商品评价（下）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%95%86%E5%93%81%E5%88%86%E7%B1%BB"><span class="toc-number">2.9.</span> <span class="toc-text">商品分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%95%86%E5%93%81%E4%B8%80%E7%BA%A7%E5%88%86%E7%B1%BB"><span class="toc-number">2.9.1.</span> <span class="toc-text">商品一级分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%95%86%E5%93%81%E4%BA%8C%E7%BA%A7%E5%88%86%E7%B1%BB"><span class="toc-number">2.9.2.</span> <span class="toc-text">商品二级分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E9%94%80%E9%87%8F%E3%80%81%E6%8C%89%E4%BB%B7%E6%A0%BC%E6%9F%A5%E8%AF%A2%E5%95%86%E5%93%81"><span class="toc-number">2.9.3.</span> <span class="toc-text">按销量、按价格查询商品</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="toc-number">2.10.</span> <span class="toc-text">购物车</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E5%B8%83%E5%B1%80"><span class="toc-number">2.10.1.</span> <span class="toc-text">静态布局</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%89%E5%8F%96%E8%B4%AD%E7%89%A9%E8%BD%A6%E6%95%B0%E6%8D%AE"><span class="toc-number">2.10.2.</span> <span class="toc-text">拉取购物车数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B7%B2%E9%80%89%E4%B8%AD%E7%9A%84%E5%90%88%E8%AE%A1%E6%80%BB%E4%BB%B7"><span class="toc-number">2.10.3.</span> <span class="toc-text">计算已选中的合计总价</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E4%B8%AA%E5%95%86%E5%93%81%E9%80%89%E4%B8%AD%E5%92%8C%E5%8F%96%E6%B6%88%E9%80%89%E4%B8%AD"><span class="toc-number">2.10.4.</span> <span class="toc-text">单个商品选中和取消选中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E5%8A%A0%E5%87%8F%E5%95%86%E5%93%81%E6%95%B0%E9%87%8F"><span class="toc-number">2.10.5.</span> <span class="toc-text">购物车加减商品数量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E9%80%89%E5%92%8C%E5%8F%96%E6%B6%88%E5%85%A8%E9%80%89"><span class="toc-number">2.10.6.</span> <span class="toc-text">全选和取消全选</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%B4%AD%E7%89%A9%E8%BD%A6%E5%95%86%E5%93%81"><span class="toc-number">2.10.7.</span> <span class="toc-text">删除购物车商品</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E9%87%8D%E9%80%89sku%E9%A2%9C%E8%89%B2%E5%B0%BA%E7%A0%81%EF%BC%88%E4%B8%8A%EF%BC%89"><span class="toc-number">2.10.8.</span> <span class="toc-text">购物车重选sku颜色尺码（上）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E9%87%8D%E9%80%89sku%E9%A2%9C%E8%89%B2%E5%B0%BA%E7%A0%81%EF%BC%88%E4%B8%8B%EF%BC%89"><span class="toc-number">2.10.9.</span> <span class="toc-text">购物车重选sku颜色尺码（下）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E7%BB%93%E7%AE%97"><span class="toc-number">2.10.10.</span> <span class="toc-text">购物车结算</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%BC%98%E5%8C%96"><span class="toc-number">2.11.</span> <span class="toc-text">项目优化</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/21.html" title="Mysql初级"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://images8.alphacoders.com/126/1265747.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="Mysql初级"/></a><div class="content"><a class="title" href="/posts/21.html" title="Mysql初级">Mysql初级</a><time datetime="2022-10-09T16:50:00.000Z" title="发表于 2022-10-10 00:50:00">2022-10-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/20.html" title="Linux初级"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://images5.alphacoders.com/126/1264881.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="Linux初级"/></a><div class="content"><a class="title" href="/posts/20.html" title="Linux初级">Linux初级</a><time datetime="2022-10-09T16:30:25.000Z" title="发表于 2022-10-10 00:30:25">2022-10-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/19.html" title="软件测试基础"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://w.wallhaven.cc/full/9m/wallhaven-9mjoy1.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="软件测试基础"/></a><div class="content"><a class="title" href="/posts/19.html" title="软件测试基础">软件测试基础</a><time datetime="2022-10-09T15:25:31.000Z" title="发表于 2022-10-09 23:25:31">2022-10-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/18.html" title="git基本操作"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://images.alphacoders.com/746/746111.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="git基本操作"/></a><div class="content"><a class="title" href="/posts/18.html" title="git基本操作">git基本操作</a><time datetime="2022-09-25T03:44:15.000Z" title="发表于 2022-09-25 11:44:15">2022-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/17.html" title="微信小程序商城项目"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://images8.alphacoders.com/120/1206602.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="微信小程序商城项目"/></a><div class="content"><a class="title" href="/posts/17.html" title="微信小程序商城项目">微信小程序商城项目</a><time datetime="2022-07-25T07:30:00.000Z" title="发表于 2022-07-25 15:30:00">2022-07-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022  <i id="heartbeat" class="fa fas fa-heartbeat"></i> Zimo</div><div class="footer_custom_text">欢迎同志 😗!</div></div><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></head></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><script defer id="dsq-count-scr" src="//xianqi.disqus.com/count.js" async></script><script defer type="text/javascript" src="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/js/sakura.js"></script><script defer type="text/javascript" src="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/js/animate.js"></script><div class="aplayer no-destroy" data-id="3201959152" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="auto" data-autoplay="true" muted></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><script>window.$crisp = [];
window.CRISP_WEBSITE_ID = "d28f1c32-e935-40a1-947a-46a1b6a04654";
(function () {
  d = document;
  s = d.createElement("script");
  s.src = "https://client.crisp.chat/l.js";
  s.async = 1;
  d.getElementsByTagName("head")[0].appendChild(s);
})();
$crisp.push(["safe", true])

if (true) {
  $crisp.push(["do", "chat:hide"])
  $crisp.push(["on", "chat:closed", function() {
    $crisp.push(["do", "chat:hide"])
  }])
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      $crisp.push(["do", "chat:show"])
      $crisp.push(["do", "chat:open"])

    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      $crisp.push(["do", "chat:hide"])
    }
    function chatBtnShow () {
      $crisp.push(["do", "chat:show"])
    }
  }
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (true) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":180,"height":360},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>